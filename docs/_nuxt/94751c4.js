(window.webpackJsonp=window.webpackJsonp||[]).push([[13,4],{124:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return h}));n(28),n(29),n(11),n(82),n(126),n(476);var r=n(14),c=(n(511),n(121)),_=n(122),l=(n(15),n(125)),f=n(479),h=function(){function e(t){var n,o;if(Object(c.a)(this,e),"string"==typeof t){var _=this.__parse_from_string(t),l=Object(r.a)(_,2);n=l[0],o=l[1]}else{var f=Object(r.a)(t,2);n=f[0],o=f[1]}var h=[n,o];this._x=h[0],this._y=h[1]}return Object(_.a)(e,null,[{key:"fetch",value:function(t){return t instanceof this?t:Object.freeze(new e(t))}},{key:"xy_valid_p",value:function(e,t){return 0<=e&&e<l.a.dimension&&0<=t&&t<l.a.dimension}},{key:"xy_invalid_p",value:function(e,t){return!this.xy_valid_p(e,t)}}]),Object(_.a)(e,[{key:"flop_if",value:function(e){return e?this.flop:this}},{key:"sp_flip_if_white",value:function(e){return"white"===e.key?this.flip_all:this}},{key:"rotate_add",value:function(t,n){var o=this.__new_pos(this._x,t),r=this.__new_pos(this._y,n);return e.fetch([o,r])}},{key:"__new_pos",value:function(e,t){return Math.trunc((e+t+l.a.dimension)%l.a.dimension)}},{key:"__parse_from_string",value:function(s){var t=s.split("").map((function(t){var n;return Number(null!==(n=e.ANY_TO_NUMBER_REPLACE_TABLE[t])&&void 0!==n?n:t)})),n=Object(r.a)(t,2),o=n[0],c=n[1];return[l.a.dimension-o,c-1]}},{key:"key",get:function(){return[this._x,this._y].toString()}},{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"to_a",get:function(){return[this.x,this.y]}},{key:"to_h",get:function(){return{x:this.x,y:this.y}}},{key:"human_x",get:function(){return l.a.dimension-this._x}},{key:"kanji_human_x",get:function(){return e.TO_KANJI_REPLACE_TABLE_X[this.human_x]}},{key:"kanji_human_y",get:function(){return e.TO_KANJI_REPLACE_TABLE_Y[this.human_y]}},{key:"yomiage_x",get:function(){return f.a.fetch(this.human_x.toString()).yomiage}},{key:"yomiage_y",get:function(){return f.a.fetch(this.human_y.toString()).yomiage}},{key:"human_y",get:function(){return this._y+1}},{key:"flip_all",get:function(){return e.fetch([l.a.dimension-1-this._x,l.a.dimension-1-this._y])}},{key:"flop",get:function(){return e.fetch([l.a.dimension-1-this._x,this._y])}},{key:"to_sfen",get:function(){return[l.a.dimension-this._x,e.TO_SFEN_REPLACE_TABLE_Y[this._y]].join("")}},{key:"css_place_key",get:function(){return["place",this.human_x,this.human_y].join("_")}},{key:"human_xy_ary",get:function(){return[this.human_x,this.human_y]}},{key:"kanji_human",get:function(){return[this.kanji_human_x,this.kanji_human_y].join("")}},{key:"digit_human",get:function(){return[this.human_x,this.human_y].join("")}}]),e}();h.ANY_TO_NUMBER_REPLACE_TABLE={"１":1,"２":2,"３":3,"４":4,"５":5,"６":6,"７":7,"８":8,"９":9,"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9,a:1,b:2,c:3,d:4,e:5,f:6,g:7,h:8,i:9},h.TO_KANJI_REPLACE_TABLE_X={1:"１",2:"２",3:"３",4:"４",5:"５",6:"６",7:"７",8:"８",9:"９"},h.TO_KANJI_REPLACE_TABLE_Y={1:"一",2:"二",3:"三",4:"四",5:"五",6:"六",7:"七",8:"八",9:"九"},h.TO_SFEN_REPLACE_TABLE_Y=["a","b","c","d","e","f","g","h","i"],e.argv[1]===o&&(console.log(h.fetch("6a").key),console.log(h.fetch([1,2]).key))}).call(this,n(123),"/index.js")},125:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return v}));n(41),n(24),n(37),n(22),n(11),n(475);var r=n(16),c=(n(510),n(121)),_=n(122),l=n(15),f=n.n(l),h=n(3),d=n(460),m=n(124);function y(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}var v=function(){function e(){Object(c.a)(this,e),this._surface={}}return Object(_.a)(e,null,[{key:"vector_flip",value:function(e,t){return[this.dimension-e-1,this.dimension-t-1]}},{key:"dimension",get:function(){return 9}},{key:"danger_zone_size",get:function(){return 3}}]),Object(_.a)(e,[{key:"delete_at",value:function(e){h.a.delete(this._surface,e.key)}},{key:"place_on",value:function(e){this.delete_at(e.place),h.a.set(this._surface,e.place.key,e)}},{key:"move_m1",value:function(e,t){this.delete_at(e.place),this.place_on(t)}},{key:"move_m2",value:function(e,t){this.move_m1(e,e.clone_with_attrs({place:t}))}},{key:"lookup",value:function(e){return this._surface[e.key]}},{key:"clear",value:function(){this._surface={}}},{key:"pawn_exist_by_x",value:function(t,n){for(var o=!1,r=0;r<e.dimension;r++){var c=m.a.fetch([t,r]),_=this.lookup(c);if(_&&_.location.key===n.key&&"P"===_.piece.key&&!_.promoted){o=!0;break}}return o}},{key:"reach_p",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.once_reach(e,t)||this.repeat_reach(e,t,n)}},{key:"once_reach",value:function(e,t){var n=this,o=!1,r=e.once_vectors;return r&&(o=r.some((function(o){if(o)return n.once_reach_vec(e,t,o)}))),o}},{key:"once_reach_vec",value:function(e,t,n){var o=n[0],r=n[1]*e.location.value_sign,c=e.place.x+o,_=e.place.y+r;return c===t.x&&_===t.y}},{key:"repeat_reach",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!1,c=e.repeat_vectors;return c&&(r=c.some((function(r){if(r)return n.repeat_reach_vec(e,t,r,o)}))),r}},{key:"repeat_reach_vec",value:function(e,t,n){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=e.place.x,c=e.place.y,_=n[0],l=n[1]*e.location.value_sign,f=r+_,h=c+l,d=!1;!m.a.xy_invalid_p(f,h);){if(f===t.x&&h===t.y){d=!0;break}if("non_stop"==o.mode);else{var y=m.a.fetch([f,h]),v=this.lookup(y);if(v)break}f+=_,h+=l}return d}},{key:"move_then_king_capture_p",value:function(e,t){var n=this.shallow_clone;return n.move_m2(e,t),n.king_capture_p(e.location)}},{key:"king_capture_p",value:function(e){var t=this,n=this.king_find_by_location(e);if(n)return this.soldiers_by_location(e.flip).some((function(e){return t.reach_p(e,n.place)}))}},{key:"king_find_by_location",value:function(e){return this.soldiers.find((function(t){return"K"==t.piece.key&&t.location.key==e.key}))}},{key:"soldiers_by_location",value:function(e){var t=e.key;return this.soldiers.filter((function(e){return e.location.key==t}))}},{key:"slide_xy",value:function(t,n){var o=new e;return f.a.forEach(this._surface,(function(e,r){var c=new d.a(Object.assign({},e.attributes,{location:e.location,place:e.place.rotate_add(t,n)}));o.place_on(c)})),o}},{key:"shuffle_apply",value:function(t){if(!(t*t<this.soldiers.length)){var n=this.all_places(t),o=f.a.shuffle(n),r=new e,i=0;return f.a.forEach(this._surface,(function(e,t){var n=new d.a(Object.assign({},e.attributes,{location:e.location,place:o[i]}));r.place_on(n),i+=1})),r}}},{key:"all_places",value:function(t){for(var n=e.dimension-t,o=[],r=0;r<t;r++)for(var c=0;c<t;c++){var _=m.a.fetch([n+c,0+r]);o.push(_)}return o}},{key:"shallow_clone",get:function(){var t=new e;return t._surface=function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?y(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):y(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},this._surface),t}},{key:"soldiers",get:function(){return Object.values(this._surface)}},{key:"piece_counts_hash",get:function(){var e={};return f.a.forEach(this.soldiers,(function(t){e[t.piece.key]=(e[t.piece.key]||0)+1})),e}},{key:"flip_all",get:function(){var t=new e;return f.a.forEach(this._surface,(function(e,n){var o=new d.a(Object.assign({},e.attributes,{location:e.location.flip,place:e.place.flip_all}));t.place_on(o)})),t}},{key:"flop",get:function(){var t=new e;return f.a.forEach(this._surface,(function(e,n){var o=new d.a(Object.assign({},e.attributes,{location:e.location,place:e.place.flop}));t.place_on(o)})),t}},{key:"to_sfen",get:function(){var t=this,n=[];return f.a.times(e.dimension,(function(o){var r="",c=0;f.a.times(e.dimension,(function(e){var n=m.a.fetch([e,o]),_=t.lookup(n);if(f.a.isNil(_))c++;else{c>=1&&(r+=c,c=0),_.promoted&&(r+="+");var l=_.piece.key;"white"===_.location.key&&(l=l.toLowerCase()),r+=l}})),c>=1&&(r+=c),n.push(r)})),n.join("/")}}]),e}();e.argv[1]===o&&console.log(v.dimension)}).call(this,n(123),"/index.js")},2:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var o={mixins:[n(244).a],props:{base:{type:Object,required:!1}}}},243:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return L}));n(28),n(29),n(11),n(456),n(82),n(126),n(70);var r=n(121),c=n(122),_=n(468),l=n(457),f=n(458),h=n(455),d=n(463),m=n.n(d),y=n(3),v=n(15),k=n.n(v),j=n(125),O=n(470),w=n(461),P=n(124),x=n(460),R=n(69),S=n(488);n(83);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(h.a)(e);if(t){var r=Object(h.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(f.a)(this,n)}}var N,L=function(e){Object(l.a)(n,e);var t=E(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"reset",value:function(){Object(_.a)(Object(h.a)(n.prototype),"reset",this).call(this),this.attributes={}}},{key:"parse",value:function(){this.raw_body=this.raw_body.replace(/startpos/,"sfen lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b - 1");var e=m()("sfen\\s+(?<board>\\S+)\\s+(?<b_or_w>\\S+)\\s+(?<hold_pieces>\\S+)\\s+(?<turn_counter_next>\\d+)(\\s+moves\\s+(?<moves>.*))?");this.attributes=m.a.exec(this.raw_body,e)}},{key:"__location_by_upper_or_lower_case",value:function(e){var t=null;return t=/[A-Z]/.test(e)?"black":"white",R.a.fetch(t)}},{key:"board",get:function(){var e=this,t=new j.a;return this.attributes.board.split("/").forEach((function(n,o){var r=0;m.a.forEach(n,m()("(?<promoted>\\+?)(?<piece>\\S)"),(function(n,i){if(/\d+/.test(n.piece))r+=Number(n.piece);else{var c=new x.a({place:new P.a([r,o]),piece:w.a.fetch(n.piece),promoted:"+"===n.promoted,location:e.__location_by_upper_or_lower_case(n.piece)});t.place_on(c),r++}}))})),t}},{key:"base_location",get:function(){var e=null;return e="b"===this.attributes.b_or_w?"black":"white",R.a.fetch(e)}},{key:"hold_pieces",get:function(){var e=this,t=this.hold_pieces_empty_hash();return"-"!==this.attributes.hold_pieces&&m.a.forEach(this.attributes.hold_pieces,m()("(?<count>\\d+)?(?<piece_char>\\S)"),(function(n,i){var o=w.a.fetch(n.piece_char),r=Number(n.count||1),c=e.__location_by_upper_or_lower_case(n.piece_char);r+=t[c.key][o.key]||0,y.a.set(t[c.key],o.key,r)})),t}},{key:"turn_base",get:function(){return Number(this.attributes.turn_counter_next)-1}},{key:"move_infos",get:function(){var e=this,t=[];return k.a.forEach(this.moves,(function(n,i){var o=S.a.parse(n);if(!o)return!1;o.location=e.location_by_offset(i),t.push(o)})),t}},{key:"moves",get:function(){return this.moves_exist_p?this.attributes.moves.split(/\s+/):[]}},{key:"moves_exist_p",get:function(){return""!==(this.attributes.moves||"")}},{key:"init_sfen_from_one",get:function(){var e=[];return e.push("position"),e.push("sfen"),e.push(this.attributes.board),e.push(this.attributes.b_or_w),e.push(this.attributes.hold_pieces),e.push(1),e.join(" ")}},{key:"init_sfen",get:function(){var e=[];return e.push("position"),e.push("sfen"),e.push(this.init_sfen_strip),e.join(" ")}},{key:"init_sfen_strip",get:function(){var e=[];return e.push(this.attributes.board),e.push(this.attributes.b_or_w),e.push(this.attributes.hold_pieces),e.push(this.attributes.turn_counter_next),e.join(" ")}},{key:"to_sfen",get:function(){var e=[];return e.push("position"),e.push("sfen"),e.push(this.attributes.board),e.push(this.attributes.b_or_w),e.push(this.attributes.hold_pieces),e.push(this.attributes.turn_counter_next),this.moves_exist_p&&(e.push("moves"),e.push(this.attributes.moves)),e.join(" ")}}],[{key:"sfen_flop",value:function(e){var source=this.parse(e);return source.attributes.board=source.board.flop.to_sfen,source.attributes.moves=source.move_infos.map((function(e){return e.to_flop_sfen})).join(" "),source.to_sfen}}]),n}(O.a);e.argv[1]===o&&(N=L.parse("position sfen +lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b S2s 1 moves 7i6h S*2d"),console.log(N),N=L.parse("position sfen +lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b S2s 1 moves 7i6h S*2d"),console.log(N))}).call(this,n(123),"/index.js")},244:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var o={data:function(){return{}}}},248:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return B}));n(28),n(29),n(456),n(82),n(70),n(127),n(126);var r=n(121),c=n(122),_=n(468),l=n(457),f=n(458),h=n(455),d=(n(22),n(11),n(475),n(463)),m=n.n(d),y=n(520),v=n.n(y),k=n(470),j=n(125),O=n(461),w=n(124),P=n(69),x=n(243),R=n(465),S=n(460),E=n(490);function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(h.a)(e);if(t){var r=Object(h.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(f.a)(this,n)}}var L=m()(Object.values({header:"(?<key>.*)：s*(?<value>.*)",board:"\\|(?<board>.*)\\|",direct_location:"(?<direct_location>^[上下先後]手番)",latest_triangle:"^手数＝.*(?<latest_triangle>[▲△])",comment:"^\\*(?<comment>.*)",hand:"^\\s*(?<number>\\d+)\\s+                                # 1    ; 手数\n         (?<to>[１-９1-9一二三四五六七八九]+)?                   # 76   ; 移動先\n         (?<same>同)?\\s*                                        # 同   ; 座標を書いてくれ\n         (?<piece>成[銀桂香]|[王玉金銀全桂圭香杏角馬飛龍竜歩と]) # 歩   ; 駒\n         (?<suffix>[左右直]?[寄引上]?)                           # 上   ; KI2っぽい表記は読み捨てる\n         (?<motion>不?成|打|合|生)?                              # 打   ; 成や打\n         (\\((?<origin_place>\\d+)\\))?                          # (77) ; 移動元"}).join("|"),"x"),B=function(e){Object(l.a)(n,e);var t=N(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"reset",value:function(){Object(_.a)(Object(h.a)(n.prototype),"reset",this).call(this),this.move_infos=[],this.comments_pack={},this.board_lines=[],this.direct_location=null,this.hold_pieces=this.hold_pieces_empty_hash()}},{key:"parse",value:function(){var e=this,t=null;this.raw_body.split(/\n/).forEach((function(line){var n=m.a.exec(line,L);if(n)if(n.key){var o=n.value.trim();if(e.header[n.key]=o,n.key.match(/手の持駒/))if("なし"===o);else{var s=E.a.kanji_to_number_string(o);s=s.replace(/\s+/g,""),m.a.forEach(s,m()("(?<piece_char>\\D)(?<count>\\d*)"),(function(t,o){var r=O.a.lookup_by_name(t.piece_char),c=Number(t.count||1),_=n.key.match(/[上後]/)?"white":"black";c+=e.hold_pieces[_][r.key]||0,e.hold_pieces[_][r.key]=c}))}}else if(n.comment){var i=e.move_infos.length;e.comments_pack[i]=e.comments_pack[i]||[],e.comments_pack[i].push(n.comment)}else if(n.board)e.board_lines.push(n.board);else if(n.direct_location)e.direct_location=P.a.fetch(n.direct_location.match(/[上後]/)?"white":"black");else if(n.latest_triangle)e.direct_location=P.a.fetch("▲"===n.latest_triangle?"white":"black");else if(n.number){var r={};r.location=e.location_by_offset(Number(n.number)-1),n.origin_place&&(r.origin_place=w.a.fetch(n.origin_place)),v()(n.to||n.same),n.to?(r.place=w.a.fetch(n.to),t=r.place):(v()(n.same),v()(t),r.place=t),"成"===n.motion&&(r.promoted_trigger=!0),"打"===n.motion&&(r.drop_piece=O.a.lookup_by_name(n.piece)),e.move_infos.push(r)}}))}},{key:"board_setup_from_board_lines",value:function(){v()(this.board_lines.length>=1);var e=new j.a;return this.board_lines.forEach((function(t,n){m.a.forEach(t,m()("(?<arrow>.)(?<piece>\\S)"),(function(t,o){if("・"===t.piece);else{var r="v"===t.arrow?"white":"black",c=O.a.lookup_by_name(t.piece),_=!1;c||(c=O.a.lookup_by_promoted_name(t.piece),v()(c),_=!0);var l=new S.a({place:new w.a([o,n]),piece:c,promoted:_,location:P.a.fetch(r)});e.place_on(l)}}))})),e}},{key:"board",get:function(){if(this.board_lines.length>=1)return this.board_setup_from_board_lines();var e=new x.a;return e.raw_body=this.preset_info.sfen,e.parse(),e.board}},{key:"preset_key",get:function(){var e=this.header["手合割"];return"その他"===e?null:e||"平手"}},{key:"preset_info",get:function(){return R.a.lookup(this.preset_key)}},{key:"base_location",get:function(){return this.direct_location?this.direct_location:this.preset_key?P.a.fetch(this.preset_info.first_location_key):P.a.fetch("black")}},{key:"move_infos",set:function(e){this._move_infos=e},get:function(){return this._move_infos}},{key:"comments_pack",set:function(e){this._comments_pack=e},get:function(){return this._comments_pack}}]),n}(k.a);if(e.argv[1]===o){var D=new B;D.raw_body="\n   1 ２六歩(27)   ( 0:16/00:00:16)\n   2 ３四歩(33)   ( 0:22/00:00:22)\n   3 ７六歩(77)   ( 0:06/00:00:22)\n   4 ８四歩(83)   ( 0:13/00:00:35)\n   5 ２五歩(26)   ( 0:09/00:00:31)\n   6 ８五歩(84)   ( 0:16/00:00:51)\n   7 ７八金(69)   ( 0:04/00:00:35)\n   8 ３二金(41)   ( 0:09/00:01:00)\n   9 ２四歩(25)   ( 0:04/00:00:39)\n  10 同 歩(23)    ( 0:10/00:01:10)\n",D.parse(),console.log(D.move_infos),console.log(D.comments_pack),console.log(void 0===D.init_sfen)}}).call(this,n(123),"/index.js")},249:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));n(84),n(85),n(245),n(82);var o=n(15),r=n.n(o),c=n(69),_={props:{sp_summary:{type:String,default:"is_summary_on"},sp_slider:{type:String,default:"is_slider_off"},sp_setting:{type:String,default:"is_setting_off"},sp_controller:{type:String,default:"is_controller_off"},sp_viewpoint:{type:String,default:"black"},sp_turn_slider_focus:{type:String,default:"is_turn_slider_focus_on"},sp_op_disabled:{type:Boolean,default:!1},sp_hidden_if_piece_stand_blank:{type:Boolean,default:!1},sp_flip_if_white:{type:Boolean,default:!1},sp_key_event_capture_enabled:{type:Boolean,default:!1},sp_shift_key_mag:{type:Number,default:10},sp_system_key_mag:{type:Number,default:50}},data:function(){return{new_viewpoint:null}},mounted:function(){"is_turn_slider_focus_on"===this.sp_turn_slider_focus&&this.turn_slider_focus(),window.addEventListener("keydown",this.keydown_hook,!1)},beforeDestroy:function(){window.removeEventListener("keydown",this.keydown_hook)},created:function(){this.new_viewpoint=this.sp_viewpoint},watch:{sp_viewpoint:function(e){this.new_viewpoint=e},new_viewpoint:function(e){this.$emit("update:sp_viewpoint",e)}},methods:{keydown_hook:function(e){if(this.debug_p,!this.sp_op_disabled&&!this.focus_on_input_tag_p()&&!this.shortcut_hook(e)&&this.sp_key_event_capture_enabled&&(this.view_p||this.play_p)){var t=document.activeElement;if(this.$NavigateBlock){var n=[this.$NavigateBlock.$refs.first,this.$NavigateBlock.$refs.previous,this.$NavigateBlock.$refs.next,this.$NavigateBlock.$refs.last];if(void 0!==t&&"BODY"!==t.tagName&&!r.a.includes(n,t))return}"Backspace"!==e.code&&"ArrowUp"!==e.code&&"ArrowLeft"!==e.code&&"k"!==e.key&&"p"!==e.key&&"b"!==e.key||(this.relative_move(-1,e),e.preventDefault()),"Space"!==e.code&&"Enter"!==e.code&&"ArrowDown"!==e.code&&"ArrowRight"!==e.code&&"j"!==e.key&&"n"!==e.key&&"f"!==e.key||(this.relative_move(1,e),e.preventDefault())}},focus_on_input_tag_p:function(){var e=document.activeElement;if("TEXTAREA"===e.tagName||"INPUT"===e.tagName)return!0},navi_relative_move:function(e,t){this.relative_move(e,t)},relative_move:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t&&(t.shiftKey&&this.sp_shift_key_mag&&(e*=this.sp_shift_key_mag),(t.ctrlKey||t.altKey||t.metaKey)&&this.sp_system_key_mag&&(e*=this.sp_system_key_mag)),this.current_turn_add(e,t),this.turn_slider_focus()||(e>0?this.nav_focus_to("next"):this.nav_focus_to("previous"))},move_to_first:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.current_turn_set(this.turn_offset_min,e),this.turn_slider_focus()||this.nav_focus_to("first")},move_to_last:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.current_turn_set(this.turn_offset_max,e),this.turn_slider_focus()||this.nav_focus_to("last")},current_turn_add:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.current_turn_set(this.mediator.turn_offset+e,t)},current_turn_set:function(e,t){var n=this.mediator.turn_clamp(e);this.turn_offset!==n&&(this.state_reset(),this.view_p&&this.view_mode_mediator_update(n),this.play_p&&this.play_mode_mediator_seek_to(n),this.sound_play("piece_put"),this.$emit("update:sp_turn",this.turn_offset),t&&(this.log("局面を人が故意に変更"),this.$emit("one_way:sp_turn_user_changed",this.turn_offset)))},current_turn_set_by_slider:function(e,t){t?this.log("スライダーをユーザーが動かした : ".concat(e)):this.log("スライダーは勝手に動いた : ".concat(e)),this.current_turn_set(e,t)},nav_focus_to:function(e){var t=this.navigate_block_element_refs(e);return!!t&&(t.focus(),!0)},turn_slider_focus:function(){var e=this.navigate_block_element_refs("TurnSliderBlock");return!!e&&e.focus_to_self()},navigate_block_element_refs:function(e){if(this.base.$NavigateBlock)return this.base.$NavigateBlock.$refs[e]},board_flip_toggle:function(){this.new_viewpoint=c.a.fetch(this.new_viewpoint).flip.key,this.sound_play("flip_sound"),this.turn_slider_focus()}},computed:{fliped:function(){return"white"===this.new_viewpoint},inside_controller_p:function(){return"is_setting_on"===this.sp_setting||"is_controller_on"===this.sp_controller&&(this.view_p||this.play_p)},inside_slider_p:function(){return"is_slider_on"===this.sp_slider&&(this.view_p||this.play_p)},inside_navigate_p:function(){return this.inside_controller_p||this.inside_slider_p}}}},250:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));n(42),n(24),n(44),n(43),n(23),n(28),n(29),n(22),n(11);var o=n(462),r=n(69),c=n(124),_=n(438);function l(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,_=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return c=e.done,e},e:function(e){_=!0,r=e},f:function(){try{c||null==n.return||n.return()}finally{if(_)throw r}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var h={data:function(){return{mouseover_info:null,shuffle_mode_p:!1}},methods:{shortcut_hook:function(e){if(!this.play_p&&!this.edit_p)return!0;var t,n=l(r.a.values);try{for(n.s();!(t=n.n()).done;){var _=t.value;if(e.key.toLowerCase()===_.char_key&&(this.soldier_hold_unless_lifted_p(e),this.membership_click_handle(_,e)))return e.preventDefault(),!0}}catch(e){n.e(e)}finally{n.f()}if(this.edit_p&&("Backspace"===e.code||"Delete"===e.code||!this.meta_p(e)&&"t"===e.key)&&(this.soldier_hold_unless_lifted_p(e),this.piece_box_other_click(e)))return e.preventDefault(),!0;if("Escape"===e.code&&this.hold_cancel(e))return e.preventDefault(),!0;if("q"===e.key){if(this.lifted_p&&this.hold_cancel(e))return e.preventDefault(),!0;if(this.mouseover_info&&"board"===this.mouseover_info.type){var f=c.a.fetch(this.mouseover_info.xy),h=this.mediator.board.lookup(f);if(h)return this.piece_stand_piece_click(h.location,h.piece,h.promoted,null),e.preventDefault(),!0}}if(!this.meta_p(e)&&("v"===e.key||"r"===e.key||"Space"===e.code)&&this.mouseover_info&&"board"===this.mouseover_info.type)return this.board_cell_right_click(this.mouseover_info.xy,e),e.preventDefault(),!0;if(this.edit_p&&"?"===e.key)return this.shortcut_modal_toggle_handle(),e.preventDefault(),!0;if(this.edit_p&&this.meta_p(e)){var d,m=this.arrow_vector_table[e.key];if(m)return(d=this.mediator).slide_xy.apply(d,Object(o.a)(m)),e.preventDefault(),!0}return!(!this.edit_p||("!"===e.key&&(this.shuffle_mode_p=!this.shuffle_mode_p,this.shuffle_mode_p?this.$buefy.toast.open({message:"盤面シャッフルモード: ON (TAP: 1-9)",position:"is-bottom",queue:!1,duration:2e3,type:"is-primary"}):this.$buefy.toast.open({message:"盤面シャッフルモード: OFF",position:"is-bottom",queue:!1,duration:500})),!this.shuffle_mode_p||"1"!==e.key&&"2"!==e.key&&"3"!==e.key&&"4"!==e.key&&"5"!==e.key&&"6"!==e.key&&"7"!==e.key&&"8"!==e.key&&"9"!==e.key))&&(this.shuffle_run(e.key),e.preventDefault(),!0)},board_mouseover_handle:function(e,t){this.mouseover_info={type:"board",xy:e}},piece_stand_mouseover_handle:function(e,t,n){this.mouseover_info={type:"MembershipStand",location:e,piece:t}},piece_box_mouseover_handle:function(e,t){this.mouseover_info={type:"PieceBox",piece:e}},mouseleave_handle:function(){this.mouseover_info=null},soldier_hold_unless_lifted_p:function(e){this.mouseover_info&&(this.lifted_p||("board"===this.mouseover_info.type&&this.board_cell_left_click(this.mouseover_info.xy,e),"MembershipStand"===this.mouseover_info.type&&this.piece_stand_piece_click(this.mouseover_info.location,this.mouseover_info.piece,!1,e),"PieceBox"===this.mouseover_info.type&&this.piece_box_piece_click(this.mouseover_info.piece,e)))},shortcut_modal_toggle_handle:function(){this.shortcut_modal_active_p()?this.shortcut_modal_close_handle():this.shortcut_modal_show_handle()},shortcut_modal_show_handle:function(){var e=this;this.shortcut_modal_close_handle(),this.$shortcut_modal&&alert("this.$shortcut_modal"),this.$shortcut_modal=this.$buefy.modal.open({parent:this,hasModalCard:!0,props:{},animation:"",onCancel:function(){e.shortcut_modal_close_handle()},canCancel:["escape","outside"],component:_.a})},shortcut_modal_close_handle:function(){this.$shortcut_modal&&(this.$shortcut_modal.close(),this.$shortcut_modal=null)},shortcut_modal_active_p:function(){return!!this.$shortcut_modal}},computed:{arrow_vector_table:function(){return{ArrowRight:[1,0],ArrowLeft:[-1,0],ArrowUp:[0,-1],ArrowDown:[0,1]}}}}},251:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(124);var o={methods:{}}},252:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var o=n(462),r=n(15),c=n.n(r),_=n(83),l=n(69),f=n(86),h=n(471),d={props:{sp_human_side:{type:String,default:"both"},play_mode_advanced_snapshot_sfen_emit:{type:Boolean,default:!1}},data:function(){return{moves:[],init_sfen:null,init_location_key:"black"}},created:function(){var e=this;this.$watch((function(){return[e.mediator,e.init_location_key]}),(function(){e.emit_update_edit_mode_snapshot_sfen()}),{deep:!0})},mounted:function(){},watch:{edit_mode_snapshot_sfen2:function(e){this.$emit("update:edit_mode_snapshot_sfen2",e)},mediator:{handler:function(e){this.$emit("update:mediator_snapshot_sfen",e.to_position_sfen)},deep:!0},turn_offset:function(e){this.$emit("update:turn_offset",e)},moves_take_turn_offset:function(e){this.$emit("update:moves_take_turn_offset",e)}},methods:{play_mode_setup_from:function(e){this.log("play_mode_setup_from"),void 0!==this.mediator.data_source.init_sfen?("view_mode"===e&&(this.init_sfen=this.mediator.data_source.init_sfen,this.moves=this.mediator.data_source.moves),"edit_mode"===e&&this.init_sfen_set()):("view_mode"===e&&(this.init_location_key=this.mediator.current_location.key),this.init_sfen_set()),this.play_mode_mediator_seek_to(this.turn_offset)},init_sfen_set:function(){this.init_sfen=this.edit_mode_snapshot_sfen(),this.moves=[]},play_mode_mediator_seek_to:function(e){this.mediator=new _.a,this.mediator.data_source=this.data_source_by(this.play_mode_full_moves_sfen),this.mediator.current_turn=e,this.mediator.run(),this.flip_if_white_run()},moves_set:function(){this.moves=[].concat(Object(o.a)(this.moves_take_turn_offset),[this.last_move_info.to_sfen])},turn_next:function(){var e=this;this.play_p&&(this.sp_play_effect_type&&this.$data._last_clicked_cell&&h.a.fetch(this.sp_play_effect_type).run({from_el:this.$data._last_clicked_cell}),this.mediator=new _.a,this.mediator.data_source=this.data_source_by(this.play_mode_full_moves_sfen),this.mediator.current_turn=-1,this.mediator.run(),this.$nextTick((function(){return e.sound_play("piece_put")})),this.$emit("update:play_mode_advanced_full_moves_sfen",{sfen:this.play_mode_full_moves_sfen,last_move_info:this.last_move_info}),this.$emit("update:play_mode_advanced_moves",this.moves),this.play_mode_advanced_snapshot_sfen_emit&&this.$emit("update:play_mode_advanced_snapshot_sfen",this.mediator.to_position_sfen),this.turn_slider_focus())},edit_mode_snapshot_sfen:function(){if(this.mediator){var e=this.mediator.sfen_serializer;return["position sfen",e.to_board_sfen,this.init_location.key[0],e.to_hold_pieces,1].join(" ")}},emit_update_edit_mode_snapshot_sfen:function(){this.edit_p&&this.$emit("update:edit_mode_snapshot_sfen",this.edit_mode_snapshot_sfen())}},computed:{play_mode_full_moves_sfen:function(){if(this.init_sfen)return this.init_sfen+" moves "+this.moves.join(" ")},init_location:function(){return l.a.fetch(this.init_location_key)},human_locations:function(){return f.a.fetch(this.sp_human_side).locations},moves_take_turn_offset:function(){return c.a.take(this.moves,this.turn_offset)},edit_mode_snapshot_sfen2:function(){return this.edit_mode_snapshot_sfen()}}}},253:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var o={data:function(){return{_ShogiPlayerRenderCount:0,_MainBoardRenderCount:0}},beforeUpdate:function(){this.$data._ShogiPlayerRenderCount+=1}}},254:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n(22),n(11);var o=n(83),r=n(465),c={props:{sp_preset_key:{type:String,default:null}},data:function(){return{new_preset_key:this.sp_preset_key}},watch:{preset_key:function(e){this.new_preset_key=e},new_preset_key:function(e){this.mediator_setup_by_preset(e)}},methods:{mediator_setup_by_preset:function(e){e=r.a.fetch(e),this.mediator=new o.a,e.sfen&&(this.mediator.data_source=this.data_source_by(e.sfen)),this.mediator.run(),this.mediator.piece_box_piece_counts_adjust(),this.init_location_key=this.mediator.current_location.key}},computed:{preset_info_values:function(){return r.a.values},init_preset_sfen:function(){if(this.sp_preset_key)return r.a.fetch(this.sp_preset_key).sfen}}}},255:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(460),r=n(83),c={methods:{api_random_puton:function(){var e=o.a.random();return this.mediator.board.clear(),this.mediator.board.place_on(e),e},api_place_on:function(e){this.mediator.board.place_on(e)},api_board_clear:function(){this.mediator.board.clear()},api_board_turn_set:function(e){this.mediator_setup(e)},api_play_mode_mediator_seek_to:function(e){this.play_mode_mediator_seek_to(e)},api_flip_set:function(e){this.base.new_viewpoint=e?"white":"black"},api_viewpoint_set:function(e){this.base.new_viewpoint=e},api_flip_toggle:function(){this.base.board_flip_toggle()},api_retract_a_move:function(){var e=this.turn_offset-2;e<0&&(e=0),this.api_board_turn_set(e)},api_sfen_or_kif_set:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.mediator=new r.a,this.mediator.data_source=this.data_source_by(e),this.mediator.current_turn=t.turn||0,this.mediator.run()},api_turn_slider_focus:function(){this.turn_slider_focus()}}}},256:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var o={methods:{place_to_cell_info:function(e){var t=e.css_place_key,n=this.$el.querySelector("."+t).getBoundingClientRect(),o=n.width,r=n.height,c=o/2,_=r/2;return{center:{x:n.left+c,y:n.top+_},rect:{x:o,y:r},radius:{x:c,y:_}}},element_vector_set:function(e,t){e.style.left="".concat(t.x,"px"),e.style.top="".concat(t.y,"px")}}}},257:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var o={methods:{vector_one:function(){return{x:1,y:1}},vector_scale:function(e,t){return{x:e.x*t,y:e.y*t}},vector_add:function(e,t){return{x:e.x+t.x,y:e.y+t.y}}}}},259:function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));n(41),n(24),n(37),n(84),n(85);var o=n(462),r=(n(22),n(11),n(16)),c=(n(82),n(15)),_=n.n(c),l=n(491),f=n(124),h=(n(125),n(460)),d=n(69),m=(n(471),n(28),n(29),n(456),n(121)),y=n(122),v=n(457),k=n(458),j=n(455),O=n(459),w=n.n(O);function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(j.a)(e);if(t){var r=Object(j.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(k.a)(this,n)}}var x=function(e){Object(v.a)(n,e);var t=P(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,null,[{key:"define",get:function(){return[{key:"is_move_cancel_standard",name:"無効な場所をタップで駒を離す",smooth_cancel:!0},{key:"is_move_cancel_reality",name:"移動元をタップしたときに駒を離す",smooth_cancel:!1},{key:"is_move_cancel_rehold",name:"移動元をタップしたときに駒を離して持つ",smooth_cancel:!0}]}}]),n}(w.a);function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(j.a)(e);if(t){var r=Object(j.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(k.a)(this,n)}}var S=function(e){Object(v.a)(n,e);var t=R(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,null,[{key:"define",get:function(){return[{key:"is_position_north",name:"北",sign:-1},{key:"is_position_south",name:"南",sign:1}]}}]),n}(w.a);function E(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function N(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?E(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):E(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var L={props:{sp_play_mode_legal_move_only:{type:Boolean,default:!0},sp_play_mode_piece_warp_disabled:{type:Boolean,default:!0},sp_play_mode_death_king_disabled:{type:Boolean,default:!0},sp_play_mode_two_pawn_disabled:{type:Boolean,default:!0},sp_play_mode_auto_promote:{type:Boolean,default:!0},sp_play_mode_not_put_if_death_soldier:{type:Boolean,default:!0},sp_play_mode_only_own_piece_to_move:{type:Boolean,default:!0},sp_play_mode_can_not_kill_same_team_soldier:{type:Boolean,default:!0},sp_edit_mode_double_click_time_ms:{type:Number,default:350},sp_play_effect_type:{type:String,default:null},sp_move_cancel:{type:String,default:"is_move_cancel_standard"},sp_view_mode_soldier_movable:{type:Boolean,default:!0}},data:function(){return{place_from:null,have_piece:null,have_piece_location:null,have_piece_promoted:null,me_running_p:!1,_me_last_event:null,_CursorObject:null,mouse_stick:!1,dialog_soldier:null,_last_clicked_cell:null,_double_tap_time:null,last_move_info:null,killed_soldier:null}},watch:{new_run_mode:function(){this.state_reset()}},beforeDestroy:function(){this.virtual_piece_destroy()},methods:{board_cell_pointerdown_handle:function(e,t){var n=this.sp_board_cell_pointerdown_user_handle;!n||n(f.a.fetch(e),t)},board_cell_left_click:function(e,t){this.log("board_cell_left_click"),this.log("shiftKey: ".concat(t.shiftKey)),this.$data._last_clicked_cell=t.target;var n=f.a.fetch(e),o=this.sp_board_cell_left_click_user_handle;if(!(o&&(this.log("ユーザー指定のクリックハンドル実行: ".concat(n.css_place_key)),o(n,t))||this.break_if_view_mode)){this.killed_soldier=this.mediator.board.lookup(n);var r=null,c=null;if(this.origin_soldier1&&(c=(r=this.origin_soldier1.clone_with_attrs({place:n})).promotable_p||this.origin_soldier1.promotable_p),this.cpu_location_p)return this.log("片方の手番だけを操作できるようにする sp_human_side の指定があってCPU側なので無効とする"),void this.$emit("operation_invalid1");if(this.sp_play_mode_only_own_piece_to_move&&this.play_p&&!this.lifted_p&&this.killed_soldier&&this.killed_soldier.location!==this.mediator.current_location)return this.log("自分の手番で相手の駒を持ち上げようとしたので無効とする"),void this.$emit("operation_invalid2");if(this.play_p&&this.have_piece&&this.killed_soldier)return this.log("駒台や駒箱から持ち上げた駒を盤上の駒の上に置こうとしたので無効とする"),void this.if_standard_then_unhold();if(this.sp_play_mode_not_put_if_death_soldier&&this.play_p&&this.have_piece&&!this.killed_soldier){var l=this.soldier_create_from_stand_or_box_on(n),h=l.piece.piece_vector.force_promote_length;if(null!=h&&l.top_spaces<=h)return void this.log("駒台や駒箱から持ち上げた駒を置こうとしたけど死に駒なので無効とする")}if(this.lifted_p||this.killed_soldier){if(this.play_p&&this.sp_play_mode_can_not_kill_same_team_soldier&&this.put_on_my_soldier_p(this.killed_soldier))return this.log("自分の駒の上に駒を重ねようとしたので無効とする(盤上の移動元の駒を含まない)"),"is_move_cancel_rehold"===this.move_cancel_info.key?(this.log("盤上の駒を持って別の盤上の駒に持ち直した"),void this.soldier_hold(n,t)):void this.if_standard_then_unhold();if(this.edit_p){var m=this.$data._double_tap_time;if(this.$data._double_tap_time=Date.now(),this.killed_soldier&&_.a.isEqual(this.place_from,n)&&m){var y=this.$data._double_tap_time-m,v=y<this.sp_edit_mode_double_click_time_ms;if(this.log("ダブルクリック判定: (".concat(y," ms < ").concat(this.sp_edit_mode_double_click_time_ms,") -> ").concat(v)),v)return this.log("操作モードで盤上の駒を持って同じ位置に戻したときに盤上の駒を裏返す"),this.mediator.board.place_on(this.killed_soldier.transform_clone),void this.piece_hold_and_put_for_bug(n,t)}}if(_.a.isEqual(this.place_from,n))return this.log("盤上の駒を持って同じ位置に戻したので状況キャンセル"),void this.state_reset();if(this.edit_p&&(this.log("lifted_from_p: ".concat(this.lifted_p)),this.meta_p(t)&&!this.lifted_p&&this.killed_soldier))return this.log("盤上の駒を裏返す"),this.mediator.board.place_on(this.killed_soldier.transform_clone),void this.piece_hold_and_put_for_bug(n,t);if(!this.lifted_p)return this.log("盤上の駒を持ちあげる"),void this.soldier_hold(n,t);if(this.sp_play_mode_legal_move_only&&this.play_p&&this.place_from){var k=!1;if(k||(k=this.mediator.board.once_reach(this.origin_soldier1,n)),!k)if(this.mediator.board.repeat_reach(this.origin_soldier1,n,{mode:"non_stop"}))if(this.log("障害物を素通りすれば目的地に行ける"),this.sp_play_mode_piece_warp_disabled){if(!this.mediator.board.repeat_reach(this.origin_soldier1,n))return this.log("駒ワープ"),void this.$emit("foul_piece_warp",this.origin_soldier1);this.log("障害物なく目的地に行ける"),k=!0}else k=!0;else this.log("目的地に対して効きがずれている");if(!k)return this.log("操作モードで盤上の駒を動かし中だが動けないセルをタップしたので無効"),void this.if_standard_then_unhold();if(this.sp_play_mode_death_king_disabled&&this.mediator.board.move_then_king_capture_p(this.origin_soldier1,n))return this.log("王手放置"),void this.$emit("foul_death_king")}if(!this.place_from){if(this.have_piece){if(this.log("持駒を置く"),this.sp_play_mode_two_pawn_disabled&&this.play_p&&"P"===this.have_piece.key&&this.have_piece_location&&this.mediator.board.pawn_exist_by_x(n.x,this.have_piece_location))return this.log("二歩"),void this.$emit("foul_two_pawn");this.killed_soldier&&(this.have_piece_location?this.mediator.hold_pieces_add(this.have_piece_location,this.killed_soldier.piece):this.mediator.hold_pieces_add(d.a.fetch("black"),this.killed_soldier.piece));var j=this.soldier_create_from_stand_or_box_on(n);return this.piece_decriment(),this.mediator.board.place_on(j),this.move_info_create({type:"put",to:j}),this.moves_set(),this.state_reset(),void this.turn_next()}throw new Error("must not happen")}if(this.log("盤上から移動"),this.killed_soldier&&this.mediator.hold_pieces_add(this.origin_soldier1.location,this.killed_soldier.piece),(this.view_p||this.play_p)&&c){var O=!0;if(this.sp_play_mode_auto_promote){var w=r.piece.piece_vector.force_promote_length;null!=w&&r.top_spaces<=w&&(this.promotable_piece_moved(r,!0),O=!1)}O&&(this.mouse_stick=!1,this.dialog_soldier=r,this.virtual_piece_destroy())}else this.play_p&&(this.move_info_create({type:"move",from:this.origin_soldier1,to:r,killed_soldier:this.killed_soldier}),this.moves_set()),this.mediator.board.place_on(r),this.mediator.board.delete_at(this.place_from),this.state_reset(),this.turn_next()}else this.log("持たずに何もないところをクリックしたので無効とする")}},promotable_piece_moved2:function(e){this.promotable_piece_moved(this.dialog_soldier,e)},promotable_piece_moved:function(e,t){e=e.clone_with_attrs({promoted:t}),this.move_info_create({type:"promotable",from:this.origin_soldier1,to:e}),this.moves_set(),this.mediator.board.place_on(e),this.mediator.board.delete_at(this.place_from),this.state_reset(),this.turn_next()},move_info_create:function(e){this.last_move_info=new l.a(N(N({},e),{},{next_turn_offset:this.turn_offset+1,player_location:this.mediator.current_location,killed_soldier:this.killed_soldier}))},board_cell_right_click:function(e,t){if(this.log("盤のセルを右クリック"),!this.break_if_view_mode){var n=f.a.fetch(e),o=this.mediator.board.lookup(n);this.hold_cancel(t)||this.edit_p&&!this.lifted_p&&o&&(this.log("盤上の駒を裏返す"),this.mediator.board.place_on(o.transform_clone),this.piece_hold_and_put_for_bug(n,t))}},membership_click_handle:function(e,t){if(!this.break_if_view_mode)return this.have_piece&&this.have_piece_location===e?(this.log("自分の駒台から駒を持ち上げているならキャンセル"),this.state_reset(),!0):this.edit_p&&this.have_piece?(this.hold_pieces_move_to_my_hold_pieces(t,e),!0):this.play_p&&this.origin_soldier1?(this.log("play_mode では盤上の駒を駒台に置くことはできない"),this.if_standard_then_unhold(),!0):!!this.origin_soldier1&&(this.log("盤上の駒を駒台に置く"),this.board_soldir_to_hold_pieces(e),!0)},piece_stand_piece_click:function(e,t,n,o){if(this.log("駒台の駒をクリック"),!this.break_if_view_mode)if(this.mediator.hold_pieces_count(e,t)<=0)this.log("クリックしたけど持駒がない");else if(this.sp_play_mode_only_own_piece_to_move&&this.play_p&&e!==this.mediator.current_location)this.log("相手の持駒を持とうとしたときは無効");else{if(this.cpu_location_p)return this.log("片方の手番だけを操作できるようにする sp_human_side の指定があってCPU側なので無効とする"),void this.$emit("operation_invalid1");this.log("駒台の駒を持つ"),this.have_piece=t,this.have_piece_location=e,this.have_piece_promoted=n,this.virtual_piece_create(o,this.origin_soldier2)}},piece_box_have_p:function(e){return _.a.isNil(this.have_piece_location)&&this.have_piece===e},piece_box_other_click:function(e){if(this.log("piece_box_other_click:駒箱クリック"),_.a.isNil(this.have_piece_location)&&this.have_piece)return this.log("持っているならキャンセル"),this.state_reset(),!0;if(this.have_piece_location&&this.have_piece){this.log("駒台から駒箱に移動");var t=this.hold_piece_source_cut(e);return this.mediator.piece_box_add(this.have_piece,t),this.state_reset(),!0}return!!this.origin_soldier1&&(this.log("盤上の駒を駒箱に移動"),this.mediator.piece_box_add(this.origin_soldier1.piece),this.mediator.board.delete_at(this.origin_soldier1.place),this.state_reset(),!0)},piece_box_piece_click:function(e,t){this.piece_box_other_click(t)||(this.log("piece_box_piece_click:駒箱の駒を持つ"),this.have_piece=e,this.have_piece_location=null,this.have_piece_promoted=!1,this.virtual_piece_create(t,this.origin_soldier2))},hold_cancel:function(e){return!(this.dialog_soldier||!this.lifted_p)&&(this.log("持ち上げた駒を元に戻す"),this.state_reset(),!0)},board_soldir_to_hold_pieces:function(e){this.mediator.hold_pieces_add(e,this.origin_soldier1.piece),this.mediator.board.delete_at(this.origin_soldier1.place),this.state_reset()},hold_pieces_move_to_my_hold_pieces:function(e,t){this.log("相手の持駒を自分の駒台に移動");var n=this.hold_piece_source_cut(e);this.mediator.hold_pieces_add(t,this.have_piece,n),this.state_reset()},hold_piece_source_cut:function(e){var t=1;return this.have_piece_location?(this.log("相手の駒箱から移動"),this.meta_p(e)&&(this.log("シフトが押されていたので全部移動"),t=this.mediator.hold_pieces_count(this.have_piece_location,this.have_piece)),t=this.mediator.hold_pieces_can_be_reduced_count(this.have_piece_location,this.have_piece,t),this.mediator.hold_pieces_add(this.have_piece_location,this.have_piece,-t)):(this.log("駒箱から移動"),this.meta_p(e)&&(this.log("シフトが押されていたので全部移動"),t=this.mediator.piece_box_count(this.have_piece)),t=this.mediator.piece_box_can_be_reduced_count(this.have_piece,t),this.mediator.piece_box_add(this.have_piece,-t)),t},piece_decriment:function(){this.have_piece_location?this.mediator.hold_pieces_add(this.have_piece_location,this.have_piece,-1):this.mediator.piece_box_add(this.have_piece,-1)},put_on_my_soldier_p:function(e){if(this.lifted_p&&e&&e.location===this.mediator.current_location&&!_.a.isEqual(this.place_from,e.place))return!0},soldier_hold:function(e,t){this.place_from=e,this.virtual_piece_create(t,this.origin_soldier1)},state_reset:function(){this.log("state_reset"),this.dialog_soldier=null,this.place_from=null,this.have_piece=null,this.have_piece_location=null,this.have_piece_promoted=null,this.killed_soldier=null,this.virtual_piece_destroy()},if_standard_then_unhold:function(){this.move_cancel_info.smooth_cancel&&(this.log("持った状態で自分の非合法セルタップでキャンセル"),this.state_reset())},piece_hold_and_put_for_bug:function(e,t){this.state_reset()},fn_flip_all:function(){var e=this;this.mediator.board=this.mediator.board.flip_all,this.mediator.hold_pieces=_.a.reduce(d.a.values,(function(a,t){return a[t.key]=e.mediator.hold_pieces[t.flip.key],a}),{})},fn_flop:function(){this.mediator.board=this.mediator.board.flop},init_location_toggle:function(){this.init_location_key=this.init_location.flip.key},soldier_create_from_stand_or_box_on:function(e){return new h.a({piece:this.have_piece,place:e,promoted:this.have_piece_promoted||!1,location:this.have_piece_location||d.a.fetch("black")})},mousemove_hook:function(e){var t=this;this.$data._me_last_event=e,this.me_running_p||(this.me_running_p=!0,window.requestAnimationFrame((function(){t.cursor_object_xy_update(),t.me_running_p=!1})))},click_hook:function(e){1!==e.which&&this.state_reset()},cursor_object_xy_update:function(){if(this.$data._CursorObject&&this.$data._me_last_event&&this.mouse_stick){var e=this.$data._me_last_event.clientX,t=this.$data._me_last_event.clientY;this.element_vector_set(this.$data._CursorObject,{x:e,y:t})}},virtual_piece_create:function(e,t){this.virtual_piece_destroy(),this.virtual_piece_dom_create(t),this.mouse_stick=!0,e&&(this.$data._me_last_event=e,this.cursor_object_xy_update()),this.$el.addEventListener("mousemove",this.mousemove_hook),this.$el.addEventListener("click",this.click_hook)},virtual_piece_dom_create:function(e){this.$data._CursorObject=this.el_create(["CursorObject"]);var t=this.el_create(["PieceTap"]),n=this.el_create(["PieceTexture"]),r=this.el_create(["PieceTextureSelf"].concat(Object(o.a)(e.css_class_list)));t.classList.add(e.location.flip_if(this.base.fliped).position_key),n.appendChild(r),t.appendChild(n),this.$data._CursorObject.appendChild(t);var c=e.location.flip_if(this.fliped).position_key,_=S.fetch(c);if(e.place){var l=this.place_to_cell_info(e.place),f=this.vector_scale(l.radius,this.devise_info.gap*_.sign*-1),h=this.vector_add(l.center,f);this.element_vector_set(this.$data._CursorObject,h)}else this.$data._CursorObject.style.left="-50%",this.$data._CursorObject.style.top="-50%";this.$refs.ShogiPlayerGround.$el.appendChild(this.$data._CursorObject)},el_create:function(e){var t,n=document.createElement("div");return(t=n.classList).add.apply(t,Object(o.a)(e)),n},virtual_piece_destroy:function(){this.$data._CursorObject&&(this.$refs.ShogiPlayerGround.$el.removeChild(this.$data._CursorObject),this.$data._CursorObject=null,this.mouse_stick=!1,this.$el.removeEventListener("mousemove",this.mousemove_hook),this.$el.removeEventListener("click",this.click_hook))},meta_p:function(e){return e.shiftKey|e.ctrlKey|e.altKey|e.metaKey}},computed:{MoveCancelInfo:function(){return x},move_cancel_info:function(){return this.MoveCancelInfo.fetch(this.sp_move_cancel)},origin_soldier1:function(){if(this.place_from)return this.mediator.board.lookup(this.place_from)},origin_soldier2:function(){if(this.have_piece){return this.soldier_create_from_stand_or_box_on(null)}},soldier_or_stand_p:function(){return this.place_from||this.have_piece_location},lifted_p:function(){return!_.a.isNil(this.place_from)||!_.a.isNil(this.have_piece)},cpu_location_p:function(){if(this.play_p)return!_.a.includes(this.human_locations,this.mediator.current_location)},break_if_view_mode:function(){if(this.view_p&&!this.sp_view_mode_soldier_movable)return!0}}}},260:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));n(41),n(24),n(22),n(11),n(37);var o=n(16),r=(n(82),n(28),n(29),n(456),n(121)),c=n(122),_=n(457),l=n(458),f=n(455),h=n(459);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(l.a)(this,n)}}var m=function(e){Object(_.a)(o,e);var t=d(o);function o(){return Object(r.a)(this,o),t.apply(this,arguments)}return Object(c.a)(o,null,[{key:"define",get:function(){return[{key:"piece_put",source:n(492),volume:.5},{key:"flip_sound",source:n(493),volume:1}]}}]),o}(n.n(h).a);function y(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function v(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?y(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):y(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var k={props:{sp_sound_enabled:{type:Boolean,default:!1},sp_sound_body_changed:{type:Boolean,default:!0},sp_sound_volume:{type:Number,default:.5}},methods:{sound_play:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.$emit("sound_play",e),this.sp_sound_enabled){var n=m.fetch(e),o=v({src:n.source,volume:n.volume*this.sp_sound_volume,autoplay:!0},t);if("undefined"!=typeof Howl)return new Howl(o)}},sp_sound_resume_all:function(){if("undefined"!=typeof Howler)return Howler.unload()},sp_Howler:function(){if("undefined"!=typeof Howler)return Howler}}}},261:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));n(28),n(29),n(11),n(456);var o=n(121),r=n(122),c=n(457),_=n(458),l=n(455),f=n(459),h=n.n(f),d=n(69);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(_.a)(this,n)}}var y=function(e){Object(c.a)(n,e);var t=m(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,null,[{key:"define",get:function(){return[{key:"☖の持駒を駒箱へ",func:function(e){e.mediator.hold_pieces_to_piece_box(d.a.fetch("white"))}},{key:"駒箱から☖の持駒へ",func:function(e){e.mediator.piece_box_to_hold_pieces(d.a.fetch("white"))}},{key:"駒箱を正規化",func:function(e){e.mediator.piece_box_piece_counts_adjust()}},{key:"駒箱に駒を一式生成",func:function(e){e.mediator.piece_box_reset_by_preset("全部駒箱")}},{key:"駒箱の駒をクリア",func:function(e){e.mediator.piece_box_clear()}},{key:"指将棋用玉配置",func:function(e){e.mediator.king_formation_auto_set()}},{key:"指将棋用玉回収",func:function(e){e.mediator.king_formation_auto_unset()}},{key:"視点切り替え",func:function(e){e.base.api_flip_toggle()}},{key:"盤面シャッフル",func:function(e){e.shuffle_dialog_open()}},{key:"上ローテイト",func:function(e){e.mediator.slide_xy(0,-1)}},{key:"下ローテイト",func:function(e){e.mediator.slide_xy(0,1)}},{key:"左ローテイト",func:function(e){e.mediator.slide_xy(-1,0)}},{key:"右ローテイト",func:function(e){e.mediator.slide_xy(1,0)}}]}}]),n}(h.a),v=n(125),k={data:function(){return{any_func_key:null}},methods:{any_func_click_handle:function(e){e.func(this)},shuffle_dialog_open:function(){var e=this;this.shuffle_mode_p=!1,this.$buefy.dialog.prompt({message:"寸法の一辺のサイズを指定してください",confirmText:"実行",cancelText:"キャンセル",inputAttrs:{type:"number",value:4,min:1,max:v.a.dimension},trapFocus:!0,onConfirm:function(t){return e.shuffle_run(t)}})},shuffle_run:function(e){e=parseInt(e),this.mediator.shuffle_apply(e)||this.$buefy.toast.open({message:"".concat(e," x ").concat(e," が盤上の駒の数より少ないため何もしませんでした"),position:"is-bottom",queue:!1,duration:2e3,type:"is-warning"})}},computed:{AnyFuncInfo:function(){return y}}}},262:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));n(28),n(29),n(11),n(456);var o=n(121),r=n(122),c=n(457),_=n(458),l=n(455),f=n(459);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(_.a)(this,n)}}var d=function(e){Object(c.a)(n,e);var t=h(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,null,[{key:"define",get:function(){return[{key:"is_device_desktop",name:"マウス操作",gap:0,description:"タップも可能な端末であっても先にマウス操作したらマウス"},{key:"is_device_touch",name:"タップ南",gap:0,description:"基本的にスマホはこちら"}]}}]),n}(n.n(f).a),m={props:{sp_device:{type:String,default:null}},data:function(){return{default_device:null}},beforeMount:function(){this.device_detect_create()},beforeDestroy:function(){this.device_detect_destroy()},methods:{device_detect_create:function(){document.addEventListener("touchstart",this.device_detect_hook),document.addEventListener("mousemove",this.device_detect_hook)},device_detect_destroy:function(){document.removeEventListener("touchstart",this.device_detect_hook),document.removeEventListener("mousemove",this.device_detect_hook)},device_detect_hook:function(e){this.default_device="changedTouches"in e?"is_device_touch":"is_device_desktop",this.device_detect_destroy()}},computed:{new_devise_key:function(){return this.sp_device||this.default_device||"is_device_desktop"},devise_info:function(){return d.fetch(this.new_devise_key)}}}},460:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return O}));n(41),n(24),n(37),n(23);var r=n(16),c=(n(22),n(11),n(121)),_=n(122),l=n(3),f=n(15),h=n.n(f),d=n(125),m=n(124),y=n(461),v=n(69);function k(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function j(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?k(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):k(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var O=function(){function e(t){Object(c.a)(this,e),this.attributes=Object.assign({},t)}return Object(_.a)(e,null,[{key:"random",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.place;if(!t){var n=h.a.random(0,d.a.dimension-1),o=h.a.random(0,d.a.dimension-1);t=m.a.fetch([n,o])}var r=y.a.fetch(h.a.random(0,y.a.values.length-1)),c=r.promotable_p&&0===h.a.random(0,1),_=v.a.fetch(h.a.random(0,v.a.values.length-1));return new this({piece:r,place:t,promoted:c,location:_})}}]),Object(_.a)(e,[{key:"clone_with_attrs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new e(j(j({},this.attributes),t))}},{key:"piece",get:function(){return this.attributes.piece}},{key:"place",set:function(e){l.a.set(this.attributes,"place",e)},get:function(){return this.attributes.place}},{key:"location",get:function(){return this.attributes.location}},{key:"promoted",get:function(){return!!this.attributes.promoted},set:function(e){l.a.set(this.attributes,"promoted",e)}},{key:"name",get:function(){return this.promoted?this.piece.promoted_name:this.piece.name}},{key:"yomiage_name",get:function(){return this.piece.piece_yomiage.yomiage(this.promoted)}},{key:"transform_clone",get:function(){var e=null;return e=this.piece.promotable_p?this.promoted?{location:this.location.flip,promoted:!this.promoted}:{promoted:!this.promoted}:{location:this.location.flip},this.clone_with_attrs(e)}},{key:"promotable_p",get:function(){if(this.piece.promotable_p&&!this.promoted)return this.danger_zone_p}},{key:"danger_zone_p",get:function(){return"black"===this.location.key?this.place.y<d.a.danger_zone_size:this.place.y>=d.a.dimension-d.a.danger_zone_size}},{key:"css_class_list",get:function(){var e=[];return e.push("location_".concat(this.location.key)),e.push("promoted_".concat(this.promoted)),e=h.a.concat(e,this.piece.css_class_list)}},{key:"bottom_spaces",get:function(){return d.a.dimension-1-this.top_spaces}},{key:"top_spaces",get:function(){return this.place.sp_flip_if_white(this.location).y}},{key:"once_vectors",get:function(){return this.piece.once_vectors(this.promoted)}},{key:"repeat_vectors",get:function(){return this.piece.repeat_vectors(this.promoted)}}]),e}();if(e.argv[1]===o){var w=new O({place:new m.a([1,7]),piece:y.a.fetch("P"),promoted:!0,location:v.a.fetch("white")});console.log(w.name),console.log(w.top_spaces)}}).call(this,n(123),"/index.js")},461:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return j}));n(28),n(29),n(456),n(22),n(11);var r=n(121),c=n(122),_=n(468),l=n(457),f=n(458),h=n(455),d=n(459),m=n.n(d),y=n(480),v=n(481);function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(h.a)(e);if(t){var r=Object(h.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(f.a)(this,n)}}var j=function(e){Object(l.a)(n,e);var t=k(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"once_vectors",value:function(e){return this.piece_vector.once_vectors(e)}},{key:"repeat_vectors",value:function(e){return this.piece_vector.repeat_vectors(e)}},{key:"css_class_list",get:function(){return["piece_name","piece_".concat(this.key)]}},{key:"promotable_p",get:function(){return!!this.promoted_name}},{key:"piece_vector",get:function(){return y.a.fetch(this.key)}},{key:"piece_yomiage",get:function(){return v.a.fetch(this.key)}}],[{key:"lookup",value:function(e){return"string"==typeof e&&(e=e.toUpperCase()),Object(_.a)(Object(h.a)(n),"lookup",this).call(this,e)}},{key:"lookup_by_name",value:function(e){return null==this._lookup_by_name&&(this._lookup_by_name=this.memory_record_create_index_or(["name","alias_name"])),this._lookup_by_name[e]}},{key:"lookup_by_promoted_name",value:function(e){return null==this._lookup_by_promoted_name&&(this._lookup_by_promoted_name=this.memory_record_create_index_or(["promoted_name","promoted_alias_name"])),this._lookup_by_promoted_name[e]}},{key:"define",get:function(){return[{key:"K",name:"玉",alias_name:"王",promoted_name:null,promoted_alias_name:null},{key:"R",name:"飛",alias_name:null,promoted_name:"龍",promoted_alias_name:"竜"},{key:"B",name:"角",alias_name:null,promoted_name:"馬",promoted_alias_name:null},{key:"G",name:"金",alias_name:null,promoted_name:null,promoted_alias_name:null},{key:"S",name:"銀",alias_name:null,promoted_name:"全",promoted_alias_name:null},{key:"N",name:"桂",alias_name:null,promoted_name:"圭",promoted_alias_name:null},{key:"L",name:"香",alias_name:null,promoted_name:"杏",promoted_alias_name:null},{key:"P",name:"歩",alias_name:null,promoted_name:"と",promoted_alias_name:null}]}}]),n}(m.a);e.argv[1]===o&&(console.log(j.fetch("K")),console.log(j.fetch("K")),console.log(j.lookup("")),console.log(j.values),console.log(j.values_map.get("K")),console.log(j.fetch("K").key))}).call(this,n(123),"/index.js")},465:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return m}));n(28),n(29),n(11),n(456);var r=n(121),c=n(122),_=n(457),l=n(458),f=n(455),h=n(459);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(l.a)(this,n)}}var m=function(e){Object(_.a)(n,e);var t=d(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,null,[{key:"define",get:function(){return[{key:"詰将棋",sfen:"position sfen 4k4/9/9/9/9/9/9/9/9 b 2r2b4g4s4n4l18p 1",first_location_key:"black",piece_box:[["K",1]]},{key:"詰将棋 - 美濃",sfen:"position sfen ln1g5/1ks6/1ppp5/p8/9/9/9/9/9 b BGSNL2rb2g2s2n2l14p 1",first_location_key:"black",piece_box:[["K",1]]},{key:"詰将棋 - 矢倉",sfen:"position sfen 7nl/6gk1/5gspp/5pp2/9/9/9/9/9 b BGSNL2rbg2s2n2l14p 1",first_location_key:"black",piece_box:[["K",1]]},{key:"戦型 右四間 vs 四間飛車",sfen:"position sfen ln1g1g1nl/1ks2r3/1pppp1bpp/p3spp2/9/P1P1SP1PP/1P1PP1P2/1BK1GR3/LNSG3NL b - 25",first_location_key:"black",piece_box:[]},{key:"全部駒箱",sfen:"position sfen 9/9/9/9/9/9/9/9/9 b - 1",first_location_key:"black",piece_box:[["B",2],["R",2],["L",4],["N",4],["S",4],["G",4],["P",18],["K",2]]},{key:"平手",sfen:"position sfen lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b - 1",first_location_key:"black",piece_box:[]},{key:"香落ち",sfen:"position sfen lnsgkgsn1/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1",first_location_key:"white",piece_box:[["L",1]]},{key:"右香落ち",sfen:"position sfen 1nsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1",first_location_key:"white",piece_box:[["L",1]]},{key:"角落ち",sfen:"position sfen lnsgkgsnl/1r7/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1",first_location_key:"white",piece_box:[["B",1]]},{key:"飛車落ち",sfen:"position sfen lnsgkgsnl/7b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1",first_location_key:"white",piece_box:[["R",1]]},{key:"飛香落ち",sfen:"position sfen lnsgkgsn1/7b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1",first_location_key:"white",piece_box:[["R",1],["L",1]]},{key:"二枚落ち",sfen:"position sfen lnsgkgsnl/9/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1",first_location_key:"white",piece_box:[["B",1],["R",1]]},{key:"三枚落ち",sfen:"position sfen lnsgkgsn1/9/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1",first_location_key:"white",piece_box:[["B",1],["R",1],["L",1]]},{key:"四枚落ち",sfen:"position sfen 1nsgkgsn1/9/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1",first_location_key:"white",piece_box:[["B",1],["R",1],["L",2]]},{key:"六枚落ち",sfen:"position sfen 2sgkgs2/9/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1",first_location_key:"white",piece_box:[["B",1],["R",1],["L",2],["N",2]]},{key:"八枚落ち",sfen:"position sfen 3gkg3/9/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1",first_location_key:"white",piece_box:[["B",1],["R",1],["L",2],["N",2],["S",2]]},{key:"十枚落ち",sfen:"position sfen 4k4/9/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1",first_location_key:"white",piece_box:[["B",1],["R",1],["L",2],["N",2],["S",2],["G",2]]},{key:"十九枚落ち",sfen:"position sfen 4k4/9/9/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1",first_location_key:"white",piece_box:[["B",1],["R",1],["L",2],["N",2],["S",2],["G",2],["P",9]]},{key:"二十枚落ち",sfen:"position sfen 9/9/9/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1",first_location_key:"white",piece_box:[["B",1],["R",1],["L",2],["N",2],["S",2],["G",2],["P",9],["K",1]]},{key:"青空将棋",sfen:"position sfen lnsgkgsnl/1r5b1/9/9/9/9/9/1B5R1/LNSGKGSNL b - 1",first_location_key:"black",piece_box:[]}]}}]),n}(n.n(h).a);e.argv[1]===o&&(console.log(m.fetch("平手")),console.log(m.fetch("香落ち").first_location_key))}).call(this,n(123),"/index.js")},470:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return h}));n(22),n(11);var r=n(121),c=n(122),_=n(15),l=n.n(_),f=n(69),h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(r.a)(this,e),this.reset(),this.raw_body=t}return Object(c.a)(e,null,[{key:"parse",value:function(e){var t=new this(e);return t.parse(),t}}]),Object(c.a)(e,[{key:"reset",value:function(){this.raw_body="",this.header={}}},{key:"parse",value:function(){}},{key:"hold_pieces_empty_hash",value:function(){return l.a.reduce(f.a.values,(function(a,e){return a[e.key]={},a}),{})}},{key:"location_by_offset",value:function(e){return this.base_location.advance(e)}},{key:"board",get:function(){console.warn("not implemented")}},{key:"turn_offset_min",get:function(){return 0}},{key:"turn_offset_max",get:function(){return this.move_infos.length}},{key:"turn_base",get:function(){return 0}},{key:"last_location",get:function(){return this.location_by_offset(this.turn_offset_max-1)}},{key:"next_location",get:function(){return this.location_by_offset(this.turn_offset_max)}},{key:"move_infos",get:function(){console.warn("not implemented")}},{key:"comments_pack",get:function(){return null}}]),e}();e.argv[1]}).call(this,n(123),"/index.js")},471:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));n(28),n(29),n(456),n(41),n(24),n(22),n(11),n(37);var o=n(457),r=n(458),c=n(455),_=n(462),l=n(16),f=n(121),h=n(122),d=n(459),m=n.n(d),y={rand:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Math.random()*e},range:function(a,b){return this.rand(b-a)+a},int_range_include:function(a,b){return this.rand(b-a+1)+a}};function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(c.a)(e);if(t){var _=Object(c.a)(this).constructor;n=Reflect.construct(o,arguments,_)}else n=o.apply(this,arguments);return Object(r.a)(this,n)}}function k(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function j(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?k(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):k(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var O=function(){function e(base,t){Object(f.a)(this,e),this.base=base,this.params=j({},t)}return Object(h.a)(e,null,[{key:"run",value:function(base){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},object=new this(base,e);object.run()}}]),Object(h.a)(e,[{key:"run",value:function(){var e=this;this.current=document.createElement("div"),this.current.classList.add("fireball",this.params.css_class),this.current.style.transitionDuration="".concat(this.params.duration,"ms"),this.base.body_el.appendChild(this.current);var t=this.base.from_rc,n=t.left+t.width/2,o=t.top+t.height/2,r=this.current.getBoundingClientRect(),c=n-r.width/2,_=o-r.height/2;this.current.style.position="absolute",this.current.style.left="".concat(c,"px"),this.current.style.top="".concat(_,"px");var a=2*Math.PI*this.params.angle,l=Math.cos(a)*this.params.radius,f=Math.sin(a)*this.params.radius;this.current.style.transform="translate(".concat(l,"px, ").concat(f,"px)"),setTimeout((function(){return e.current_destroy()}),this.params.duration+this.params.destroy_gap)}},{key:"current_destroy",value:function(){this.base.body_el.removeChild(this.current)}}]),e}(),w=function(e){Object(o.a)(n,e);var t=v(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"run",value:function(){var e=this;this.effect_info.params_list.forEach((function(t){e.circle_create(t)}))}}]),n}(function(){function e(t,n){Object(f.a)(this,e),this.effect_info=t,this.params=n}return Object(h.a)(e,null,[{key:"run",value:function(e,t){new this(e,t).run_around()}}]),Object(h.a)(e,[{key:"run_around",value:function(){this.before_run(),this.run()}},{key:"before_run",value:function(){var e=this.params.from_el||document.querySelector(this.params.from_selector);this.from_rc=e.getBoundingClientRect(),this.body_el=document.querySelector("body")}},{key:"circle_create",value:function(e){e=j(j({},this.params),e);for(var t=y.rand(),n=0;n<e.total;n++){var o=j({},e);o.radius_range&&(o.radius=y.range.apply(y,Object(_.a)(o.radius_range))),o.duration_range&&(o.duration=y.range.apply(y,Object(_.a)(o.duration_range))),o.destroy_gap_range&&(o.destroy_gap=y.range.apply(y,Object(_.a)(o.destroy_gap_range))),o.angle_rand?o.angle=y.rand():o.angle=t+1/e.total*n,this.fireball_create(o)}}},{key:"fireball_create",value:function(e){O.run(this,e)}}]),e}()),P=function(e){Object(o.a)(n,e);var t=v(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"run",value:function(e){this.factory.run(this,e)}}],[{key:"define",get:function(){return[{key:"fw_type_1",factory:w,params_list:[{total:16,angle_rand:!1,radius:null,radius_range:[32,512],duration:null,duration_range:[300,600],destroy_gap:null,destroy_gap_range:[-100,100],css_class:"fireball_s1"},{total:16,angle_rand:!1,radius:200,radius_range:null,duration:300,duration_range:null,destroy_gap:0,destroy_gap_range:null,css_class:"fireball_s1"}]},{key:"fw_type_2",factory:w,params_list:[{total:16,angle_rand:!1,radius:200,radius_range:null,duration:300,duration_range:null,destroy_gap:0,destroy_gap_range:null,css_class:"fireball_s1"}]},{key:"fw_type_3",factory:w,params_list:[{total:12,angle_rand:!1,radius:128,radius_range:null,duration:750,duration_range:null,destroy_gap:0,destroy_gap_range:null,css_class:"fireball_s1"}]}]}}]),n}(m.a)},479:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));n(28),n(29),n(11),n(456);var o=n(121),r=n(122),c=n(457),_=n(458),l=n(455),f=n(459);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(_.a)(this,n)}}var d=function(e){Object(c.a)(n,e);var t=h(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,null,[{key:"define",get:function(){return[{key:"1",yomiage:"1"},{key:"2",yomiage:"にー"},{key:"3",yomiage:"さん"},{key:"4",yomiage:"よん"},{key:"5",yomiage:"ごー"},{key:"6",yomiage:"6"},{key:"7",yomiage:"なな"},{key:"8",yomiage:"8"},{key:"9",yomiage:"きゅー"}]}}]),n}(n.n(f).a)},480:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return m}));n(28),n(29),n(11),n(456);var r=n(121),c=n(122),_=n(457),l=n(458),f=n(455),h=n(459);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(l.a)(this,n)}}var m=function(e){Object(_.a)(n,e);var t=d(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"once_vectors",value:function(e){var t=null;return t=e?this.promoted_once_vectors:this.basic_once_vectors,this.constructor[t]}},{key:"repeat_vectors",value:function(e){var t=null;return t=e?this.promoted_repeat_vectors:this.basic_repeat_vectors,this.constructor[t]}}],[{key:"define",get:function(){return[{key:"K",basic_once_vectors:"pattern_king",basic_repeat_vectors:null,promoted_once_vectors:null,promoted_repeat_vectors:null,force_promote_length:null},{key:"R",basic_once_vectors:null,basic_repeat_vectors:"pattern_plus",promoted_once_vectors:"pattern_x",promoted_repeat_vectors:"pattern_plus",force_promote_length:null},{key:"B",basic_once_vectors:null,basic_repeat_vectors:"pattern_x",promoted_once_vectors:"pattern_plus",promoted_repeat_vectors:"pattern_x",force_promote_length:null},{key:"G",basic_once_vectors:"pattern_gold",basic_repeat_vectors:null,promoted_once_vectors:null,promoted_repeat_vectors:null,force_promote_length:null},{key:"S",basic_once_vectors:"pattern_silver",basic_repeat_vectors:null,promoted_once_vectors:"pattern_gold",promoted_repeat_vectors:null,force_promote_length:null},{key:"N",basic_once_vectors:"pattern_knight",basic_repeat_vectors:null,promoted_once_vectors:"pattern_gold",promoted_repeat_vectors:null,force_promote_length:1},{key:"L",basic_once_vectors:null,basic_repeat_vectors:"pattern_pawn",promoted_once_vectors:"pattern_gold",promoted_repeat_vectors:null,force_promote_length:0},{key:"P",basic_once_vectors:"pattern_pawn",basic_repeat_vectors:null,promoted_once_vectors:"pattern_gold",promoted_repeat_vectors:null,force_promote_length:0}]}},{key:"pattern_plus",get:function(){return[null,[0,-1],null,[-1,0],[1,0],null,[0,1],null]}},{key:"pattern_x",get:function(){return[[-1,-1],null,[1,-1],null,null,null,[-1,1],null,[1,1]]}},{key:"pattern_silver",get:function(){return[[-1,-1],[0,-1],[1,-1],null,null,null,[-1,1],null,[1,1]]}},{key:"pattern_gold",get:function(){return[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],null,[0,1],null]}},{key:"pattern_king",get:function(){return[[-1,-1],[0,-1],[1,-1],[-1,0],null,[1,0],[-1,1],[0,1],[1,1]]}},{key:"pattern_knight",get:function(){return[[-1,-2],[1,-2]]}},{key:"pattern_pawn",get:function(){return[[0,-1]]}}]),n}(n.n(h).a);e.argv[1]}).call(this,n(123),"/index.js")},481:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));n(28),n(29),n(11),n(456),n(23);var o=n(121),r=n(122),c=n(457),_=n(458),l=n(455),f=n(459);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(_.a)(this,n)}}var d=function(e){Object(c.a)(n,e);var t=h(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"yomiage",value:function(e){return e?this.promoted_name:this.name}}],[{key:"define",get:function(){return[{key:"K",prefix_name:"ぎょく",name:"ぎょくっ！",promoted_name:null},{key:"R",prefix_name:"ひしゃ",name:"ひしゃっ！",promoted_name:"りゅー！"},{key:"B",prefix_name:"かく",name:"かくっ！",promoted_name:"うまっ！"},{key:"G",prefix_name:"きん",name:"きんっ！",promoted_name:null},{key:"S",prefix_name:"ぎん",name:"ぎんっ！",promoted_name:"なりぎんっ！"},{key:"N",prefix_name:"けい",name:"けいっ！",promoted_name:"なりけいっ！"},{key:"L",prefix_name:"きょー",name:"きょー！",promoted_name:"なりきょー！"},{key:"P",prefix_name:"ふ",name:"ふーっ！",promoted_name:"ときんっ！"}]}}]),n}(n.n(f).a)},488:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));n(126);var o=n(121),r=n(122),c=n(463),_=n.n(c),l=n(461),f=n(124),h=function(){function e(t){Object(o.a)(this,e),this.promoted_trigger="+"===t.promoted,"*"===t.origin_y?this.drop_piece=l.a.fetch(t.origin_x):this.origin_place=f.a.fetch("".concat(t.origin_x).concat(t.origin_y)),this.place=f.a.fetch("".concat(t.pos_x).concat(t.pos_y))}return Object(r.a)(e,null,[{key:"line_flop",value:function(e){return this.parse_line(e).map((function(e){return e.to_flop_sfen})).join(" ")}},{key:"str_flop",value:function(e){var t=this.parse(e);if(t)return t.to_flop_sfen}},{key:"parse_line",value:function(line){var e=this,s=line||"";return""===s?[]:s.split(/\s+/).map((function(t){return e.parse(t)}))}},{key:"parse",value:function(e){var t=_.a.exec(e,_()("(?<origin_x>\\S)(?<origin_y>\\S)(?<pos_x>\\S)(?<pos_y>\\S)(?<promoted>\\+?)?"));return t?new this(t):null}}]),Object(r.a)(e,[{key:"to_custom_sfen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=[];return this.drop_piece?(a.push(this.drop_piece.key),a.push("*")):a.push(this.origin_place.flop_if(e.flop).to_sfen),a.push(this.place.flop_if(e.flop).to_sfen),this.promoted_trigger&&a.push("+"),a.join("")}},{key:"to_sfen",get:function(){return this.to_custom_sfen()}},{key:"to_flop_sfen",get:function(){return this.to_custom_sfen({flop:!0})}}]),e}()},489:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return m}));n(22),n(11);var r=n(121),c=n(122),_=n(15),l=n.n(_),f=n(461),h=(n(124),n(83)),d=n(69),m=(n(125),function(){function e(t){Object(r.a)(this,e),this.mediator=t}return Object(c.a)(e,[{key:"to_s",get:function(){var e=this.__base_parts;return e.push(this.mediator.display_turn+1),e.join(" ")}},{key:"to_s_without_turn",get:function(){return this.__base_parts.join(" ")}},{key:"to_board_sfen",get:function(){return this.mediator.board.to_sfen}},{key:"to_hold_pieces",get:function(){var e=this,t=d.a.values.map((function(t){var n=e.mediator.hold_pieces[t.key],o=f.a.values.map((function(e){var o=n[e.key]||0,r="";if(0===o)return null;o>=2&&(r+=o);var c=e.key;return r+=c="white"===t.key?c.toLowerCase():c.toUpperCase()}));return l.a.compact(o).join("")})).join("");return l.a.isEmpty(t)&&(t="-"),t}},{key:"__base_parts",get:function(){var e=[];return e.push(this.to_board_sfen),e.push(this.mediator.current_location.key[0]),e.push(this.to_hold_pieces),e}}]),e}());if(e.argv[1]===o){var y=new h.a;y.source="position sfen +lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b S2s 1 moves 7i6h S*2d",y.current_turn=1,y.run();var v=new m(y);console.log(v.to_s)}}).call(this,n(123),"/index.js")},490:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));n(41),n(24),n(22),n(11),n(37);var o=n(16),r=n(462),c=(n(476),n(82),n(246),n(70),n(121)),_=n(122),l=n(463),f=n.n(l);function h(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?h(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):h(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m=function(){function e(){Object(c.a)(this,e)}return Object(_.a)(e,null,[{key:"kanji_to_number_string",value:function(s){var e=this;s=s.replace(new RegExp("[".concat(this.KANJI_TABLE,"]"),"g"),(function(t){return e.TRANSRATE_TABLE[t]}));for(var t=function(i){var t=f()("(?<number>\\d+)?(?<unit>[".concat(e.UNIT_TABLE.charAt(i),"])(?<rest>\\d+)?"),"g");s=f.a.replace(s,t,(function(e){var t,n;return Number(null!==(t=e.number)&&void 0!==t?t:1)*Math.pow(10,i+1)+Number(null!==(n=e.rest)&&void 0!==n?n:0)}))},i=0;i<this.unit_size;i++)t(i);return s}},{key:"number_to_kanji",value:function(e){for(var t=[],n=this.unit_size;n>=1;n--){var s=this.UNIT_TABLE.charAt(n-1),o=Math.pow(10,n),q=Math.trunc(e/o),r=Math.trunc(e%o);1===q?n>=this.one_number_insert_level?t.push(this.KANJI_TABLE.charAt(q)+s):t.push(s):q>=2&&t.push(this.KANJI_TABLE.charAt(q)+s),e=r}return(0===e&&0===t.length||e>=1)&&t.push(this.KANJI_TABLE.charAt(e)),t.join("")}},{key:"extract",value:function(s){var e=[];return f.a.forEach(s,this.regexp,(function(t){e.push(t[0])})),e}},{key:"regexp",get:function(){return f()("[".concat(this.KANJI_TABLE).concat(this.UNIT_TABLE,"]+"))}}]),e}();m.unit_size=6,m.one_number_insert_level=4,m.KANJI_TABLE="〇一二三四五六七八九",m.UNIT_TABLE="十百千万憶兆",m.NUMBER_TABLE="0123456789",m.TRANSRATE_TABLE=Object(r.a)(m.KANJI_TABLE).reduce((function(a,e,i){return d(d({},a),{},Object(o.a)({},e,m.NUMBER_TABLE.charAt(i)))}),{})},491:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return h}));n(41),n(24),n(22),n(11),n(37),n(23);var r=n(16),c=n(121),_=n(122);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function f(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(r.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var h=function(){function e(t){Object(c.a)(this,e),Object.assign(this,t)}return Object(_.a)(e,[{key:"to_custom_kif",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=f({location:!0,from:!0},e);var t=null,n="";if("move"===this.type)t=this.from.name,e.from&&(n=this.__from_xy);else if("promotable"===this.type)t=this.from.name+(this.to.promoted?"成":"不成"),e.from&&(n=this.__from_xy);else{if("put"!==this.type)throw new Error("must not happen");t=this.to.name+"打"}return[e.location?this.to.location.name:"",this.__to_xy,t,n].join("")}},{key:"to_sfen",get:function(){var e=null;if("move"===this.type)e=this.from.place.to_sfen+this.to.place.to_sfen;else if("promotable"===this.type)e=this.from.place.to_sfen+this.to.place.to_sfen+(this.to.promoted?"+":"");else{if("put"!==this.type)throw new Error("must not happen");e=this.to.piece.key+"*"+this.to.place.to_sfen}return e}},{key:"to_kif",get:function(){return this.to_custom_kif()}},{key:"to_kif_without_from",get:function(){return this.to_custom_kif({from:!1})}},{key:"to_yomiage",get:function(){var e=null;if("move"===this.type)e=this.from.yomiage_name;else if("promotable"===this.type)e=this.from.piece.piece_yomiage.prefix_name+"、"+(this.to.promoted?"なりっ！":"ならずっ！");else{if("put"!==this.type)throw new Error("must not happen");e=this.to.piece.piece_yomiage.prefix_name+"、うつ！"}return[this.to.place.yomiage_x,this.to.place.yomiage_y,e].join(" ")}},{key:"effect_key",get:function(){if(this.killed_soldier)return"kill_attack";if("move"===this.type)return"move_or_appear";if("promotable"===this.type)return this.to.promoted,"move_or_appear";if("put"===this.type)return"move_or_appear";throw new Error("must not happen")}},{key:"__from_xy",get:function(){return["(",this.from.place.digit_human,")"].join("")}},{key:"__to_xy",get:function(){return[this.to.place.human_x,this.to.place.kanji_human_y].join("")}}]),e}();e.argv[1]}).call(this,n(123),"/index.js")},492:function(e,t,n){e.exports=n.p+"assets/Universal_Sound_FX/TABLE_TENNIS_Racket_Ball_Hit_07_Hard_mono.wav"},493:function(e,t,n){e.exports=n.p+"assets/Universal_Sound_FX/RELOAD_Rechamber_Leaver_Action_stereo.wav"},50:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return m}));n(28),n(29),n(11),n(456),n(23);var r=n(121),c=n(122),_=n(457),l=n(458),f=n(455),h=n(459);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(l.a)(this,n)}}var m=function(e){Object(_.a)(n,e);var t=d(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,null,[{key:"define",get:function(){return[{key:"view_mode",name:"再生"},{key:"play_mode",name:"操作"},{key:"edit_mode",name:"編集"}]}}]),n}(n.n(h).a);e.argv[1]===o&&(console.log(m.fetch("simple").key),console.log(m.fetch("simple").name))}).call(this,n(123),"/index.js")},51:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return m}));n(28),n(29),n(11),n(456),n(23);var r=n(121),c=n(122),_=n(457),l=n(458),f=n(455),h=n(459);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(l.a)(this,n)}}var m=function(e){Object(_.a)(n,e);var t=d(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,null,[{key:"define",get:function(){return[{key:"is_bg_variant_none",name:"none"},{key:"is_bg_variant_a",name:"木1"},{key:"is_bg_variant_b",name:"木2"},{key:"is_bg_variant_c",name:"木3"},{key:"is_bg_variant_d",name:"木4"},{key:"is_bg_variant_e",name:"木5"},{key:"is_bg_variant_f",name:"木6"},{key:"is_bg_variant_g",name:"木7"}]}}]),n}(n.n(h).a);e.argv[1]===o&&(console.log(m.fetch("is_bg_variant_a").key),console.log(m.fetch("is_bg_variant_a").name))}).call(this,n(123),"/index.js")},52:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return m}));n(28),n(29),n(11),n(456),n(23);var r=n(121),c=n(122),_=n(457),l=n(458),f=n(455),h=n(459);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(l.a)(this,n)}}var m=function(e){Object(_.a)(n,e);var t=d(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,null,[{key:"define",get:function(){return[{key:"is_pi_variant_none",name:"none"},{key:"is_pi_variant_a1by",name:"ゴシック(1文字)"},{key:"is_pi_variant_a2by",name:"ゴシック(2文字)"},{key:"is_pi_variant_b",name:"紙面風"},{key:"is_pi_variant_c",name:"図案駒(画像)"},{key:"is_pi_variant_d",name:"orangain/shogi-piece-images"},{key:"is_pi_variant_e",name:"プチッチ(画像・暗め)"}]}}]),n}(n.n(h).a);e.argv[1]===o&&(console.log(m.fetch("is_pi_variant_a1by").key),console.log(m.fetch("is_pi_variant_a1by").name))}).call(this,n(123),"/index.js")},69:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return m}));n(28),n(29),n(456),n(22),n(11);var r=n(121),c=n(122),_=n(457),l=n(458),f=n(455),h=n(459);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(l.a)(this,n)}}var m=function(e){Object(_.a)(n,e);var t=d(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"any_long_name",value:function(e){return e?this.handicap_long_name:this.long_name}},{key:"advance",value:function(e){return n.cycle_lookup(this.code+e)}},{key:"flip_if",value:function(e){return this.advance(e?1:0)}},{key:"flip",get:function(){return n.cycle_lookup(this.code+1)}}],[{key:"cycle_lookup",value:function(e){return"number"!=typeof e&&alert("ArgumentError: ".concat(e)),n.lookup(Math.abs(e)%n.values.length)}},{key:"define",get:function(){return[{key:"black",name:"☗",char_key:"b",value_sign:1,position_key:"is_position_south",long_name:"先手",handicap_long_name:"下手"},{key:"white",name:"☖",char_key:"w",value_sign:-1,position_key:"is_position_north",long_name:"後手",handicap_long_name:"上手"}]}}]),n}(n.n(h).a);e.argv[1]===o&&(console.log(m.cycle_lookup(-1)),console.log(m.fetch("black")),m.values.map((function(e){console.log(e)})),console.log(m.fetch("black").flip),console.log(m.fetch("white").flip))}).call(this,n(123),"/index.js")},83:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var o=n(14),r=(n(22),n(11),n(247),n(82),n(23),n(121)),c=n(122),_=n(15),l=n.n(_),f=n(3),h=n(125),d=n(124),m=n(461),y=n(460),v=n(243),k=n(489),j=n(465),O=n(69),w=function(){function e(){Object(r.a)(this,e);var t=new v.a;t.raw_body="position startpos",t.parse(),this.data_source=t,this.current_turn=0,this.board=null,this.hold_pieces=null,this.last_hand=null,this.piece_box={},this.env="production"}return Object(c.a)(e,[{key:"run",value:function(){var e=this;this.board=this.data_source.board,this.hold_pieces=this.data_source.hold_pieces,this.last_hand=null;var t=this.data_source.move_infos,n=this.turn_offset-this.turn_offset_min;l()(n).times((function(i){e.execute_one(t[i])}))}},{key:"execute_one",value:function(e){if(this.last_hand=e,e.drop_piece){var t=new y.a({piece:e.drop_piece,place:e.place,promoted:e.promoted,location:e.location});this.hold_pieces_add(e.location,t.piece,-1),this.board.place_on(t)}else{var n=this.board.lookup(e.place);n&&this.hold_pieces_add(e.location,n.piece,1);var o=this.board.lookup(e.origin_place);e.promoted_trigger&&(o.promoted=!0),o.place=e.place,this.board.delete_at(e.origin_place),this.board.place_on(o)}}},{key:"hold_pieces_count",value:function(e,t){return this.hold_pieces[e.key][t.key]||0}},{key:"hold_pieces_add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=this.hold_pieces_count(e,t)+n,r=this.hold_pieces[e.key];f.a.delete(r,t.key),o>=1&&f.a.set(r,t.key,o)}},{key:"hold_pieces_can_be_reduced_count",value:function(e,t,n){var o=this.hold_pieces_count(e,t);return n>o&&(n=o),n}},{key:"board_safe_delete_on",value:function(e){this.board.delete_at(e)}},{key:"board_piece_fore_class",value:function(e){var t=d.a.fetch(e),n=this.board.lookup(t);return n?n.css_class_list:[]}},{key:"cell_piece_class",value:function(e){var t=d.a.fetch(e),n=this.board.lookup(t),o=[];return n&&o.push("location_".concat(n.location.key)),o}},{key:"cell_view",value:function(e){var t=d.a.fetch(e),n=this.board.lookup(t),o="";return n&&(o=n.name),o}},{key:"turn_clamp",value:function(e){return l.a.clamp(Number(e),this.turn_offset_min,this.turn_offset_max)}},{key:"realized_hold_pieces_of",value:function(e){var t=Object.entries(this.hold_pieces[e]);return l()(t).filter((function(e){var t=Object(o.a)(e,2);t[0];return t[1]>=1})).map((function(e){var t=Object(o.a)(e,2),n=t[0],r=t[1];return[m.a.fetch(n),r]})).sortBy((function(e){var t=Object(o.a)(e,2),n=t[0];t[1];return n.code})).value()}},{key:"piece_box_count",value:function(e){return this.piece_box[e.key]||0}},{key:"piece_box_add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.piece_box_count(e)+t;f.a.delete(this.piece_box,e.key),n>=1&&f.a.set(this.piece_box,e.key,n)}},{key:"piece_box_can_be_reduced_count",value:function(e,t){var n=this.piece_box_count(e);return t>n&&(t=n),t}},{key:"piece_box_realize",value:function(){var e=Object.entries(this.piece_box);return l()(e).filter((function(e){var t=Object(o.a)(e,2);t[0];return t[1]>=1})).map((function(e){var t=Object(o.a)(e,2),n=t[0],r=t[1];return[m.a.fetch(n),r]})).sortBy((function(e){var t=Object(o.a)(e,2),n=t[0];t[1];return n.code})).value()}},{key:"hold_pieces_to_piece_box",value:function(e){var t=this;l.a.forIn(this.hold_pieces[e.key],(function(n,o){var r=m.a.fetch(o);t.hold_pieces_add(e,r,-n),t.piece_box_add(r,n)}))}},{key:"piece_box_to_hold_pieces",value:function(e){var t=this;l.a.forIn(this.piece_box,(function(n,o){var r=m.a.fetch(o);t.piece_box_add(r,-n),t.hold_pieces_add(e,r,n)}))}},{key:"piece_box_reset_by_preset",value:function(e){var t=this;this.piece_box_clear(),j.a.fetch(e).piece_box.forEach((function(e){var n=Object(o.a)(e,2),r=n[0],c=n[1];t.piece_box_add(m.a.fetch(r),c)}))}},{key:"piece_box_piece_counts_adjust",value:function(){var e=this;this.piece_box_clear();var t=this.hold_piece_all_counts_hash,n=this.board.piece_counts_hash;j.a.fetch("全部駒箱").piece_box.forEach((function(r){var c=Object(o.a)(r,2),_=c[0],l=c[1],f=m.a.fetch(_),h=l-((t[f.key]||0)+(n[f.key]||0));e.piece_box_add(f,h)}))}},{key:"piece_box_clear",value:function(){this.piece_box={}}},{key:"king_formation_auto_set_on_off",value:function(e){return e?this.king_formation_auto_set():this.king_formation_auto_unset()}},{key:"king_formation_auto_set",value:function(){var e=!1;return e||(e=this.king_formation_set("bottom_left")),e||(e=this.king_formation_set("bottom_right")),e}},{key:"king_formation_auto_unset",value:function(){var e=!1;return e||(e=this.king_formation_unset("bottom_left")),e||(e=this.king_formation_unset("bottom_right")),e}},{key:"king_formation_set",value:function(e){var t=this,n=this.king_formation_soldiers(e);if(!n.some((function(e){return t.board.lookup(e.place)})))return n.forEach((function(e){return t.piece_search_and_place_on(e)})),!0}},{key:"king_formation_unset",value:function(e){var t=this,n=this.king_formation_soldiers(e);if(!n.some((function(e){return!t.board.lookup(e.place)})))return n.forEach((function(e){var n=t.board.lookup(e.place);if(n){var o=n.piece;t.board.delete_at(n.place),"K"===o.key?t.piece_box_add(o):t.hold_pieces_add(O.a.fetch("white"),o)}})),!0}},{key:"piece_search_and_place_on",value:function(e){if(!this.board.lookup(e.place)){if("K"===e.piece.key)this.piece_search_and_decrement(e.piece);else if(!this.piece_search_and_decrement(e.piece))return;this.board.place_on(e)}}},{key:"piece_search_and_decrement",value:function(e){var t=!1;return t||(t=this.piece_search_on_hold_pieces_and_decrement("white",e)),t||this.piece_box_count(e)>=1&&(this.piece_box_add(e,-1),t=!0),t}},{key:"piece_search_on_hold_pieces_and_decrement",value:function(e,t){var n=O.a.fetch(e);if(this.hold_pieces_count(n,t)>=1)return this.hold_pieces_add(n,t,-1),!0}},{key:"king_formation_soldiers",value:function(e){var t=null,n=null,o=null,r=null;return"bottom_left"===e&&(t=0,n=1,o=h.a.dimension-1,r=-1),"bottom_right"===e&&(t=h.a.dimension-1,n=-1,o=h.a.dimension-1,r=-1),[{piece:"K",promoted:!1,location:"black",place:[t,o]},{piece:"P",promoted:!0,location:"white",place:[t,o+r+r]},{piece:"P",promoted:!0,location:"white",place:[t+n,o+r+r]},{piece:"P",promoted:!0,location:"white",place:[t+n+n,o+r+r]},{piece:"P",promoted:!0,location:"white",place:[t+n+n,o+r]},{piece:"P",promoted:!0,location:"white",place:[t+n+n,o]}].map((function(e){return new y.a({piece:m.a.fetch(e.piece),promoted:e.promoted,location:O.a.fetch(e.location),place:d.a.fetch(e.place)})}))}},{key:"slide_xy",value:function(e,t){this.board=this.board.slide_xy(e,t)}},{key:"shuffle_apply",value:function(e){var t=this.board.shuffle_apply(e);if(t)return this.board=t,!0}},{key:"dimension",get:function(){return h.a.dimension}},{key:"turn_offset",get:function(){var e=Number(this.current_turn);return e<0&&(e+=this.turn_offset_max+1),this.turn_clamp(e)}},{key:"previous_location",get:function(){return this.data_source.location_by_offset(this.turn_offset-1)}},{key:"current_location",get:function(){return this.data_source.location_by_offset(this.turn_offset)}},{key:"current_comments",get:function(){if(this.data_source.comments_pack)return this.data_source.comments_pack[this.turn_offset]}},{key:"turn_offset_min",get:function(){return this.data_source.turn_offset_min}},{key:"turn_offset_max",get:function(){return this.data_source.turn_offset_max}},{key:"current_turn_label",get:function(){return this.turn_offset===this.turn_offset_max?"まで".concat(this.display_turn,"手で").concat(this.previous_location.name,"の勝ち"):"".concat(this.display_turn,"手")}},{key:"display_turn",get:function(){return this.turn_base+this.turn_offset}},{key:"turn_base",get:function(){return this.data_source.turn_base}},{key:"to_simple_sfen",get:function(){return this.sfen_serializer.to_s}},{key:"to_sfen_without_turn",get:function(){return this.sfen_serializer.to_s_without_turn}},{key:"to_position_sfen",get:function(){return"position sfen ".concat(this.to_simple_sfen)}},{key:"sfen_serializer",get:function(){return new k.a(this)}},{key:"hold_piece_all_counts_hash",get:function(){var e=this,t={};return O.a.values.forEach((function(n){l.a.forIn(e.hold_pieces[n.key],(function(e,n){t[n]=(t[n]||0)+e}))})),t}}]),e}()},86:function(e,t,n){"use strict";(function(e,o){n.d(t,"a",(function(){return v}));n(28),n(29),n(11),n(456);var r=n(121),c=n(122),_=n(457),l=n(458),f=n(455),h=n(459),d=n.n(h),m=n(69);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(l.a)(this,n)}}var v=function(e){Object(_.a)(n,e);var t=y(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"locations",get:function(){return this.location_keys.map((function(e){return m.a.fetch(e)}))}}],[{key:"define",get:function(){return[{key:"none",name:"none",location_keys:[]},{key:"both",name:"☗☖",location_keys:["black","white"]},{key:"black",name:"☗",location_keys:["black"]},{key:"white",name:"☖",location_keys:["white"]}]}}]),n}(d.a);e.argv[1]===o&&console.log(v.fetch("both").locations)}).call(this,n(123),"/index.js")}}]);