{"version":3,"sources":["webpack:///./src/parser_base.js","webpack:///./src/side_info.js","webpack:///./src/components/ErrorNotify.vue?fcec","webpack:///./src/components/ErrorNotify.vue","webpack:///src/components/ShogiPlayer.vue","webpack:///./src/components/play_mode_module.js","webpack:///src/components/SettingModal.vue","webpack:///./src/components/sound_module.js","webpack:///./src/preset_info.js","webpack:///src/components/CommentArea.vue","webpack:///./src/components/polling_module.js","webpack:///./src/theme_info.js","webpack:///./src/components/PieceStand.vue?8cae","webpack:///./src/assets/flip_sound.wav","webpack:///./src/soldier.js","webpack:///./src/store/index.js","webpack:///./src/place.js","webpack:///./src/mediator.js","webpack:///./src/components/CommentArea.vue?f2ec","webpack:///./src/assets/piece_sound.wav","webpack:///./src/piece.js","webpack:///./src/bg_variant_info.js","webpack:///./src/piece_variant_info.js","webpack:///./src/sfen_serializer.js","webpack:///./src/components/navi_module.js","webpack:///./src/size_info.js","webpack:///./src/components/PieceStand.vue","webpack:///./src/sound.js","webpack:///./src/components/preset_module.js","webpack:///./src/components/ShogiPlayer.vue?b62d","webpack:///./src/board.js","webpack:///./src/location.js","webpack:///./src/components/CommentArea.vue","webpack:///./src/components/SettingModal.vue?f404","webpack:///./src/components/ShogiPlayer.vue","webpack:///./src/kif_parser.js","webpack:///./src/run_mode_info.js","webpack:///src/components/PieceStand.vue","webpack:///./src/sfen_parser.js","webpack:///./src/components/edit_mode_module.js","webpack:///./src/components/SettingModal.vue"],"names":["__webpack_require__","ParserBase","_classCallCheck3","default","this","kifu_body","header","offset","index","komaochi_p","_location2","fetch","Math","abs","_lodash2","reduce","values","a","e","key","turn_min","move_infos","length","process","argv","SideInfo","location_keys","map","name","ErrorNotify","render","_h","$createElement","_c","_self","staticClass","_t","staticRenderFns","Component","normalizeComponent","__webpack_exports__","_vuex","Object","defineProperty","_vue2","prototype","value","store","_index2","_navi_module2","_edit_mode_module2","_play_mode_module2","_sound_module2","_preset_module2","_polling_module2","PieceStand","_PieceStand2","SettingModal","_SettingModal2","_ErrorNotify2","CommentArea","_CommentArea2","run_mode","debug_mode","theme","size","bg_variant","piece_variant","axios_call","polling_interval_update","start_turn","turn_edit_value","turn_max","before_sfen","to_sfen","current_run_mode","view_mode_real_turn_save","real_turn","old_val","_mediator2","position_sfen","run","kifu_source","turn","update_counter","_sfen_parser2","_kif_parser2","str","parse","data_source","_this","focus","xy","place","origin_place","list","v","computed","_extends3","current_theme","current_size","current_bg_variant","current_piece_variant","current_debug_mode","digit_show","mapState","props","human_side_key","type","String","data","moves","init_sfen","init_location_key","created","mounted","watch","methods","play_mode_setup_from","log","undefined","mediator","init_sfen_build","current_location","play_mode_mediator_seek_to","sfen_serializer","to_board_sfen","init_location","to_hold_pieces","data_source_by","play_mode_current_sfen","current_turn","moves_set","take","push","turn_next","sound_call","$emit","last","to_position_sfen","$refs","turn_slider","join","human_locations","_side_info2","locations","RunModeInfo","_run_mode_info2","ThemeInfo","_theme_info2","SizeInfo","_size_info2","BgVariantInfo","_bg_variant_info2","PieceVariantInfo","_piece_variant_info2","sound_effect","Boolean","volume","Number","piece_sound","sound_setup","object","play","sound_load","_piece_sound2","_flip_sound2","file","isNil","_sound2","options","PresetInfo","sfen","first_location_key","piece_box","_autolinker2","_axios","logger_debug","kifu_url","polling_interval","interval_id","kifu_body_from_url","clearInterval","setInterval","_this2","url","accessd_at","Date","now","toString","_axios2","method","params","responseType","timeout","headers","X-SHOGI-PLAYER-TIMESTAMP","then","response","error_message","inside_custom_kifu","catch","error","status","statusText","request","message","config","esExports","_vm","class","piece_stand_outer_class","domProps","innerHTML","_s","location_name","_v","piece_stand_class","on","click","$event","stopPropagation","preventDefault","$parent","piece_stand_click","location","contextmenu","hold_cancel","_l","ref","piece","count","piece_stand_piece_click","piece_back_class","piece_fore_class","_e","module","exports","p","Soldier","attributes","_assign2","promoted","promoted_name","attrs","promotable_p","flip","danger_zone_p","y","_board2","danger_zone_size","dimension","concat","css_class_list","__filename","_place2","_piece2","location_key","_vuex2","Store","state","current_flip","mutations","flip_toggle","current_debug_mode_set","payload","Place","x","isString","_parse_from_string2","_parse_from_string","_parse_from_string3","_slicedToArray3","_value","_ref","_x","_y","_freeze2","s","_s$split$map","replace","_replace_table","split","_s$split$map2","１","２","３","４","５","６","７","８","９","一","二","三","四","五","六","七","八","九","b","c","d","f","g","h","i","human_digits","Mediator","board","hold_pieces","last_hand","env","num","times","execute_one","m","drop_piece","soldier","_soldier4","hold_pieces_add","place_on","lookup","promoted_trigger","delete_at","plus","arguments","hold_pieces_count","counts_hash","set","delete","to_class_list","clamp","final_label","previous_location","_entries2","filter","_ref2","_ref3","_ref4","sortBy","_ref5","_ref6","code","piece_box_count","_ref7","_ref8","_ref9","_ref10","_ref11","_ref12","func","turn_clamp","location_by_offset","comments_pack","cached","to_s","_this3","to_s_without_turn","_sfen_serializer2","_","isEmpty","auto_link","Piece","toUpperCase","_get3","__proto__","_getPrototypeOf2","call","find","alias_name","includes","promoted_alias_name","SfenSerializer","parts","__base_parts","rows","space","toLowerCase","location_info","compact","slider_show","controller_show","key_event_capture","shift_key_mag","system_key_mag","window","addEventListener","keydown_hook","$store","dom","document","activeElement","controllers","first","previous","next","tagName","relative_move","navi_relative_move","event","flip_sign","shiftKey","ctrlKey","altKey","metaKey","current_turn_add","focus_to","move_to_first","current_turn_set","move_to_last","new_val","view_mode_mediator_update","el","board_flip_run","commit","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_218fd7d4_hasScoped_false_transformToRequire_video_src_poster_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_template_compiler_preprocessor_engine_pug_node_modules_vue_loader_lib_selector_type_template_index_0_PieceStand_vue__","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_PieceStand_vue___default","__audio_context__","AudioContext","webkitAudioContext","Sound","buffer","__resource_load","is_loaded","source","createBufferSource","connect","destination","gain_node","createGain","gain","start","req","XMLHttpRequest","onreadystatechange","readyState","decodeAudioData","open","send","preset_key","current_preset_key","mediator_setup_by_preset","preset_info","_preset_info2","forEach","piece_box_add","preset_info_values","init_preset_sfen","class_names","slot","model","callback","$$v","expression","icon","record","all_flip","init_location_toggle","turn_edit","turn_edit_run","current_turn_label","directives","rawName","modifiers","number","blur","$forceUpdate","input","target","composing","_n","setting_modal_p","active","has-modal-card","update:active","sp_data","$data","update:run_mode","update:kifu_body","update_kifu_source","realized_hold_pieces_of","board_piece_back_class","board_click","board_click_right","board_piece_fore_class","cell_view","piece_box_class","piece_box_other_click","piece_box_realize","holding_p","piece_box_have_p","piece_box_piece_click","piece_box_piece_back_class","piece_box_piece_inner_class","textContent","min","max","current_comments","place_from","have_piece","Board","_surface","new_soldier","_soldier2","Location","komaochi_name","hirate_name","cycle_lookup","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_3a87a5fb_hasScoped_false_transformToRequire_video_src_poster_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_CommentArea_vue__","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_CommentArea_vue___default","staticStyle","width","aria-label","close","label","native-value","$set","readonly","kifu_source2","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_2195c0e7_hasScoped_false_transformToRequire_video_src_poster_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_template_compiler_preprocessor_engine_pug_node_modules_vue_loader_lib_selector_type_template_index_0_ShogiPlayer_vue__","__vue_styles__","ssrContext","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_ShogiPlayer_vue___default","KifParser","before_point","line","md","_xregexp2","exec","__kif_format_move_regexp","_minimalisticAssert2","kif_lookup","sfen_parser","_move_infos","_comments_pack","kif_parser","SfenParser","regex","test","__location_by_upper_or_lower_case","_hold_pieces","piece_char","location_base","_this4","ary","have_piece_location","me_running_p","me_last_event","cursor_elem_in_board_container","state_reset","if_view_mode_break","cpu_location_p","put_on_my_piece_p","isEqual","meta_p","piece_transform","pice_hold_and_put_for_bug","soldier_hold","origin_soldier2_create","piece_decriment","Error","origin_soldier1","_soldier3","mouse_stick","$dialog","confirm","confirmText","cancelText","onConfirm","promotable_piece_moved","onCancel","piece_stand_click_shared","hold_pieces_move_to_my_hold_pieces","board_soldir_to_hold_pieces","virtual_piece_create","origin_soldier2","hold_piece_source_cut","virtual_piece_destroy","mousemove_hook","requestAnimationFrame","cursor_elem_set_pos","click_hook","which","cursor_elem","clientX","clientY","style","left","top","_piece_fore$classList","createElement","classList","add","piece_back","piece_fore","apply","_toConsumableArray3","text","createTextNode","appendChild","board_container_ref","$el","removeChild","removeEventListener","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_4c6243ba_hasScoped_false_transformToRequire_video_src_poster_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_template_compiler_preprocessor_engine_pug_node_modules_vue_loader_lib_selector_type_template_index_0_SettingModal_vue__","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_SettingModal_vue___default"],"mappings":"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","file":"static/js/shogi_player.d54f850c46129d94bac8.js","sourcesContent":["import _ from \"lodash\"\nimport Location from \"./location\"\n\nexport default class ParserBase {\n  constructor() {\n    this.kifu_body = null\n    this.header = {}\n  }\n\n  parse() {\n  }\n\n  get board() {\n    console.warn(\"not implemented\")\n  }\n\n  get hold_pieces() {\n    return _.reduce(Location.values, (a, e) => {\n      a[e.key] = {}\n      return a\n    }, {})\n  }\n\n  get turn_min() {\n    return 0\n  }\n\n  get turn_max() {\n    return this.turn_min + this.move_infos.length\n  }\n\n  location_by_offset(offset) {\n    // 次のようにすると w - 2 から始まるときに後手番なのに先手番になってしまう\n    // const index = this.turn_min + offset + (this.komaochi_p ? 1 : 0)\n\n    const index = (this.komaochi_p ? 1 : 0) + offset\n    // \"position startpos\" の場合 index が -1 になり (-1 % 2) が -1 になり Location.fetch(-1) でエラーになる\n    // なので Math.abs\n    return Location.fetch(Math.abs(index) % 2)\n  }\n\n  get move_infos() {\n    console.warn(\"not implemented\")\n  }\n\n  get comments_pack() {\n    return null\n  }\n}\n\nif (process.argv[1] === __filename) {\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/parser_base.js","import MemoryRecord from \"js-memory-record\"\nimport Location from \"./location\"\n\nexport default class SideInfo extends MemoryRecord {\n  static get define() {\n    return [\n      /* eslint-disable */\n      { key: \"both\",   name: \"☗☖\", location_keys: [\"black\", \"white\"], },\n      { key: \"black\",  name: \"☗\",   location_keys: [\"black\"],          },\n      { key: \"white\",  name: \"☖\",   location_keys: [\"white\"],          },\n      { key: \"none\",   name: \"なし\", location_keys: [],                 },\n      /* eslint-enable */\n    ]\n  }\n\n  get locations() {\n    return this.location_keys.map((e) => Location.fetch(e))\n  }\n}\n\nif (process.argv[1] === __filename) {\n  console.log(SideInfo.fetch(\"both\").locations)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/side_info.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"columns\"},[_c('div',{staticClass:\"column\"},[_c('article',{staticClass:\"message is-danger has-text-left\"},[_c('div',{staticClass:\"message-header\"},[_vm._t(\"header\")],2),_c('div',{staticClass:\"message-body\"},[_vm._t(\"default\")],2)])])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-23aaa820\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/ErrorNotify.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nvar __vue_script__ = null\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-23aaa820\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../node_modules/vue-loader/lib/selector?type=template&index=0!./ErrorNotify.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/ErrorNotify.vue\n// module id = null\n// module chunks = ","<template lang=\"pug\">\n.shogi-player(:class=\"class_names\")\n  div(v-if=\"error_message\")\n    ErrorNotify\n      p(slot=\"header\") ERROR\n      p {{error_message}}\n\n  template(v-if=\"!mediator\")\n    i.fas.fa-spinner.fa-pulse\n\n  div.edit_mode_controller(v-if=\"current_run_mode === 'edit_mode'\")\n    .edit_mode_controller_wrap\n        b-dropdown(v-model=\"current_preset_key\")\n          //  button.button にすると prevent を指定する場所がないため button で外側の form が反応してしまう\n          .button(slot=\"trigger\")\n            span 初期配置\n            b-icon(icon=\"menu-down\")\n          b-dropdown-item(v-for=\"record in preset_info_values\" :value=\"record.key\" :key=\"record.key\")\n            | {{record.name}}\n        | &nbsp;\n        button.button.yumincho(@click.stop.prevent=\"all_flip\") 先後反転\n        | &nbsp;\n        button.button.yumincho(@click.stop.prevent=\"init_location_toggle\") 手番{{init_location.name}}\n\n  template(v-if=\"mediator\")\n    .turn_edit_container\n      div(v-if=\"current_run_mode === 'view_mode' || current_run_mode === 'play_mode'\" class=\"turn_area\")\n        template(v-if=\"!turn_edit\")\n          span.turn_edit_text(@click.stop.prevent=\"turn_edit_run\")\n            template(v-if=\"current_run_mode === 'view_mode'\")\n              | {{mediator.current_turn_label(this.final_label)}}\n            template(v-if=\"current_run_mode === 'play_mode'\")\n              | {{real_turn}}手目\n        template(v-if=\"turn_edit\")\n          input.turn_edit_input(type=\"number\" v-model.number=\"turn_edit_value\" @blur=\"turn_edit = false\" ref=\"turn_edit_input\")\n\n      span.is-pulled-right.modal_trigger_dots(@click.stop.prevent=\"setting_modal_p = true\")\n        b-icon(icon=\"dots-vertical\" size=\"is-small\")\n\n      b-modal(:active.sync=\"setting_modal_p\" has-modal-card)\n        SettingModal(\n          :run_mode.sync=\"current_run_mode\"\n          :kifu_source=\"kifu_source\"\n          @update:kifu_body=\"update_kifu_source\"\n          :play_mode_current_sfen=\"play_mode_current_sfen\"\n          :sp_data=\"$data\"\n        )\n\n    //- 独自のフォントサイズを適用するのは基本このなかだけとする\n    .board_container.font_size_base(ref=\"board_container_ref\")\n      .flippable(:class=\"{flip: current_flip}\")\n        PieceStand.flex_item(:location_key=\"'white'\" :hold_pieces=\"mediator.realized_hold_pieces_of('white')\")\n        .flex_item.board_wrap\n          template(v-if=\"overlay_navi\")\n            .overlay_navi.previous(@click.stop.prevent=\"navi_relative_move(-1, $event)\")\n            .overlay_navi.next(@click.stop.prevent=\"navi_relative_move(+1, $event)\")\n            .overlay_navi.flip_trigger_cell(@click.stop.prevent=\"board_flip_run\")\n          .board_outer\n            table.board_inner\n              tr(v-for=\"y in mediator.dimension\")\n                td(v-for=\"x in mediator.dimension\")\n                  .piece_back(:class=\"board_piece_back_class([x - 1, y - 1])\" @click.stop.prevent=\"board_click([x - 1, y - 1], $event)\" @click.stop.prevent.right=\"board_click_right([x - 1, y - 1], $event)\")\n                    .piece_fore(:class=\"mediator.board_piece_fore_class([x - 1, y - 1])\")\n                      | {{mediator.cell_view([x - 1, y - 1])}}\n        .flex_item\n          ul.piece_box(:class=\"piece_box_class\" v-if=\"current_run_mode === 'edit_mode'\" @click.stop.prevent=\"piece_box_other_click\" @click.right.prevent=\"hold_cancel\")\n            li(v-for=\"[piece, count] in mediator.piece_box_realize()\" @click.stop.prevent=\"piece_box_piece_click(piece, $event)\" :class=\"{holding_p: piece_box_have_p(piece)}\")\n              .piece_back(:class=\"piece_box_piece_back_class(piece)\")\n                .piece_fore(:class=\"piece_box_piece_inner_class(piece)\" v-text=\"piece.name\")\n              .piece_count(v-if=\"count >= 1\" :class=\"`piece_count${count}`\")\n                | {{count}}\n          //- 先手の駒台が上にくっつてしまうので防ぐため空のdivを入れる\n          div(v-if=\"current_run_mode !== 'edit_mode'\")\n          PieceStand(:location_key=\"'black'\" :hold_pieces=\"mediator.realized_hold_pieces_of('black')\")\n      //- cursor_elem はこの部分に入るので 1em のサイズを .font_size_base で指定したものを基準にできる\n\n    div(v-if=\"current_run_mode === 'view_mode' || current_run_mode === 'play_mode'\")\n      .controller_group.buttons.has-addons.is-centered.is-paddingless(v-if=\"controller_show\")\n        button.button.first(    ref=\"first\"    @click.stop.prevent=\"move_to_first\"):             b-icon(icon=\"menu-left\")\n        button.button.previous( ref=\"previous\" @click.stop.prevent=\"relative_move(-1, $event)\"): b-icon(icon=\"chevron-left\"  size=\"is-small\")\n        button.button.next(     ref=\"next\"     @click.stop.prevent=\"relative_move(+1, $event)\"): b-icon(icon=\"chevron-right\" size=\"is-small\")\n        button.button.last(     ref=\"last\"     @click.stop.prevent=\"move_to_last\"):              b-icon(icon=\"menu-right\")\n        button.button.flip(                    @click.stop.prevent=\"board_flip_run\"):            b-icon(icon=\"rotate-3d\"     size=\"is-small\")\n      div(v-if=\"slider_show\")\n        input.turn_slider(type=\"range\" :value=\"real_turn\" @input=\"current_turn_set($event.target.value)\" :min=\"turn_min\" :max=\"turn_max\" ref=\"turn_slider\")\n\n    //- http://kyokumen.jp/positions/lnsgkgsnl/1r5b1/ppppppppp/9/9/2P6/PP1PPPPPP/1B5R1/LNSGKGSNL%20w%20-\n    .sfen_area.is-size-7.has-text-grey(v-if=\"sfen_show\")\n      slot(name=\"sfen_part\" :sfen=\"mediator.to_sfen\" :mediator=\"mediator\")\n        | {{mediator.to_sfen}}\n\n    CommentArea(:comments_pack=\"mediator.data_source.comments_pack\" :current_comments=\"mediator.current_comments\")\n\n  div.debug_table(v-if=\"current_debug_mode\")\n    table.table.is-bordered.is-striped.is-narrow.is-hoverable.is-fullwidth\n      tbody\n        tr: <th>現在のモード(current_run_mode)</th><td>{{current_run_mode}}</td>\n        tr: <th>update_counter</th><td>{{update_counter}}</td>\n        tr: <th>移動元座標(place_from)</th><td>{{place_from}}</td>\n        tr: <th>駒台・駒箱から移動中の駒(have_piece)</th><td>{{have_piece}}</td>\n        template(v-if=\"mediator\")\n          tr: <th>駒箱</th><td>{{mediator.piece_box_realize()}}</td>\n          tr: <th>持駒</th><td>{{mediator.hold_pieces}}</td>\n          tr: <th>次の手番</th><td>{{mediator.current_location.key}}</td>\n          tr: <th>現局面のSFEN</th><td>{{mediator.to_sfen}}</td>\n          tr: <th>正規化手番</th><td>{{real_turn}}</td>\n        tr: <th>開始局面番号(start_turn)</th><td>{{start_turn}}</td>\n        tr: <th>初期配置(current_preset_key)</th><td>{{current_preset_key}}</td>\n        tr: <th>play_modeでの指し手(moves)</th><td>{{moves}}</td>\n        tr: <th>play_modeの開始局面(init_sfen)</th><td>{{init_sfen}}</td>\n        tr: <th>編集モード時の手番(init_location_key)</th><td>{{init_location_key}}</td>\n        tr: <th>play_modeでのSFEN(play_mode_current_sfen)</th><td>{{play_mode_current_sfen}}</td>\n        tr: <th>key_event_capture</th><td>{{key_event_capture}}</td>\n        tr: <th>interval_id</th><td>{{interval_id}}</td>\n</template>\n\n<script>\nimport _ from \"lodash\"\nimport Vue from 'vue'\n\nimport { mapState } from 'vuex'\n\n// Store\nimport store from \"../store/index.js\"\n\n// My Library\nimport Mediator from \"../mediator\"\nimport Place from \"../place\"\nimport SfenParser from \"../sfen_parser\"\nimport KifParser from \"../kif_parser\"\n\n// components\nimport PieceStand from \"./PieceStand\"\nimport SettingModal from \"./SettingModal\"\nimport ErrorNotify from \"./ErrorNotify\"\nimport CommentArea from \"./CommentArea\"\n\n// mixins modules\nimport navi_module from \"./navi_module.js\"\nimport edit_mode_module from \"./edit_mode_module.js\"\nimport play_mode_module from \"./play_mode_module.js\"\nimport sound_module from \"./sound_module.js\"\nimport preset_module from \"./preset_module.js\"\nimport polling_module from \"./polling_module.js\"\n\n// To use lodash's _ in the vue template\nObject.defineProperty(Vue.prototype, '_', {value: _})\n\n/* eslint-disable no-new */\nexport default {\n  name: 'ShogiPlayer',\n\n  store: store,\n\n  mixins: [\n    // ここで直接 require(\"./xxx.js\"), とは書けないので注意\n    navi_module,\n    edit_mode_module,\n    play_mode_module,\n    sound_module,\n    preset_module,\n    polling_module,\n  ],\n\n  /* eslint-disable */\n  props: {\n    run_mode:       { type: String,  default: \"view_mode\", },\n    kifu_body:      { type: String,  default: null,        },\n    start_turn:     { type: Number,  default: -1,          },\n    sfen_show:      { type: Boolean, default: false,       },\n    overlay_navi:   { type: Boolean, default: true,        },\n    url_embed_turn: { type: Boolean, default: false,       },\n    theme:          { type: String,  default: \"real\",      },\n    size:           { type: String,  default: \"default\",   },\n    bg_variant:     { type: String,  default: \"a\"          },\n    piece_variant:  { type: String,  default: \"a\"          },\n    debug_mode:     { type: Boolean, default: false,       }, // process.env.NODE_ENV !== 'production'\n    digit_show:     { type: Boolean, default: false,       },\n    final_label:    { type: String,  default: null,        },\n  },\n  /* eslint-enable */\n\n  components: {\n    PieceStand,\n    SettingModal,\n    ErrorNotify,\n    CommentArea,\n  },\n\n  data() {\n    return {\n      current_run_mode: this.run_mode,\n      turn_edit_value: null,    // numberフィールドで current_turn を直接操作すると空にしたとき補正値 0 に変換されて使いづらいため別にする。あと -1 のときの挙動もわかりやすい。\n      mediator: null,           // 局面管理\n      turn_edit: false,         // N手目編集中\n      error_message: null,\n      update_counter: 0,\n      setting_modal_p: false,\n      inside_custom_kifu: null, // 設定ダイアログで変更されたときに入る\n      env: process.env.NODE_ENV,\n      view_mode_real_turn_save: null, // viewモードを抜けるとき現在の手数を記憶しておく\n    }\n  },\n\n  created() {\n    this.inside_custom_kifu = null\n\n    /* eslint-disable */\n    // TODO: Vuex の方で外からの引数(this.debug_mode)を参照できないのでこんなことになっている\n    this.$store.state.current_debug_mode = this.debug_mode\n    this.$store.state.current_theme      = this.theme\n    this.$store.state.current_size       = this.size\n    this.$store.state.current_bg_variant  = this.bg_variant\n    this.$store.state.current_piece_variant = this.piece_variant\n    /* eslint-enable */\n\n    if (this.current_run_mode === \"view_mode\") {\n      if (this.kifu_url) {\n        this.axios_call()\n        this.polling_interval_update()\n      } else {\n        this.mediator_setup(this.start_turn)\n      }\n    }\n\n    if (this.current_run_mode === \"play_mode\") {\n      this.mediator_setup(this.start_turn)\n      this.play_mode_setup_from(\"view_mode\")\n    }\n\n    if (this.current_run_mode === \"edit_mode\") {\n      if (this.preset_key) {\n        this.mediator_setup_by_preset(this.preset_key) // 駒箱に「玉」を乗せたいため\n      } else {\n        this.mediator_setup(this.start_turn)\n      }\n    }\n  },\n\n  watch: {\n    turn_edit_value() {\n      this.current_turn_set(this.turn_edit_value)\n    },\n\n    start_turn() {\n      this.current_turn_set(this.start_turn)\n    },\n\n    kifu_source() {\n      // const before_turn_max = this.turn_max\n      const before_sfen = this.mediator ? this.mediator.to_sfen : \"\"\n      this.log(`before turn_max: ${this.turn_max}`)\n      this.log(`before sfen: ${before_sfen}`)\n      this.mediator_setup(this.start_turn)\n      this.log(`after turn_max: ${this.turn_max}`)\n      this.log(`after sfen: ${this.mediator.to_sfen}`)\n      const sfen_change_p = (before_sfen !== this.mediator.to_sfen)\n      if (this.current_run_mode === \"view_mode\") {\n        if (sfen_change_p) {\n          this.sound_call(\"piece_sound\")\n        }\n      }\n      if (this.current_run_mode === \"play_mode\") {\n        this.play_mode_setup_from(\"view_mode\")\n        // 棋譜を反映された側は\n        // 1. 相手が指したのか → 駒音だす\n        // 2. 自分の指し手が正しい指し手だと判断された棋譜が返って反映されたのか → 駒音なし\n        // この区別が付かない。なのでここで成らさない方がよい\n        // this.sound_call(\"piece_sound\")\n        // ……と思ったが 1 は turn_max が変化したかどうかで判断できる。いや sfen を見ればわかる？ → そこまでする必要ない\n        // if (before_turn_max !== this.turn_max) {\n        if (sfen_change_p) {\n          this.sound_call(\"piece_sound\")\n        }\n      }\n    },\n\n    // ダイアログから変更されたとき\n    current_run_mode(new_val, old_val) {\n      this.$emit(\"update:run_mode\", this.current_run_mode)\n\n      if (this.current_run_mode === \"view_mode\") {\n        this.log(\"current_run_mode: view_mode\")\n        // alert(`復元:${this.view_mode_real_turn_save}`)\n        this.view_mode_mediator_update(this.view_mode_real_turn_save)\n        this.view_mode_real_turn_save = null\n      } else {\n        // view_mode ではなくなったときの最初だけ保存しておく(mediatorをまるごと保存しておく手もあるかも)\n        if (this.view_mode_real_turn_save === null) {\n          this.view_mode_real_turn_save = this.real_turn\n          // alert(`保存:${this.view_mode_real_turn_save}`)\n        }\n      }\n\n      if (this.current_run_mode === \"play_mode\") {\n        this.play_mode_setup_from(old_val)\n      }\n\n      if (this.current_run_mode === \"edit_mode\") {\n        this.log(\"current_run_mode: edit_mode\")\n        const position_sfen = this.mediator.to_position_sfen // mediator を作り直す前に現状の局面を吐き出しておく\n\n        this.mediator = new Mediator()\n        this.mediator.data_source = this.data_source_by(position_sfen)\n        this.mediator.current_turn = 0\n        this.mediator.run()\n\n        this.init_location_key = this.mediator.current_location.key\n      }\n    },\n\n    // これはひどい。わけがわからない。\n    // 外側に通知したいときは Vuex (../store/index.js) のなかでやってもだめ\n    // 呼ばれているコンポーネントで書かないといけない\n    /* eslint-disable */\n    current_debug_mode(v) { this.$emit(\"update:debug_mode\", v)              }, // 内から外への通知\n    debug_mode(v)         { this.$store.commit(\"current_debug_mode_set\", v) }, // 外から内への反映\n    run_mode(v)           { this.current_run_mode = v                       }, // 外側から run_mode を変更されたとき\n\n    current_theme(v)      { this.$emit(\"update:theme\", v)                   }, // 中 -> 外\n    theme(v)              { this.$store.state.current_theme = v             }, // 外 -> 中\n\n    current_size(v)       { this.$emit(\"update:size\", v)                    }, // 中 -> 外\n    size(v)               { this.$store.state.current_size = v              }, // 外 -> 中\n\n    current_bg_variant(v)  { this.$emit(\"update:bg_variant\", v)               }, // 中 -> 外\n    bg_variant(v)          { this.$store.state.current_bg_variant = v         }, // 外 -> 中\n\n    current_piece_variant(v)  { this.$emit(\"update:piece_variant\", v)               }, // 中 -> 外\n    piece_variant(v)          { this.$store.state.current_piece_variant = v         }, // 外 -> 中\n    /* eslint-enable */\n  },\n\n  methods: {\n    mediator_setup(turn) {\n      this.mediator = new Mediator()\n      this.mediator.data_source = this.data_source_by(this.kifu_source)\n      this.mediator.current_turn = turn\n      this.mediator.run()\n    },\n\n    view_mode_mediator_update(turn) {\n      this.mediator_setup(turn)\n      if (this.url_embed_turn) {\n        document.location.hash = this.real_turn\n      }\n      // this.sound_call(\"piece_sound\")\n      this.update_counter++\n    },\n\n    data_source_by(str) {\n      let data_source = null\n      if (/position/.test(str)) {\n        data_source = new SfenParser()\n      } else {\n        data_source = new KifParser()\n      }\n      data_source.kifu_body = str\n      data_source.parse()\n      return data_source\n    },\n\n    turn_edit_run() {\n      this.turn_edit = true\n      this.turn_edit_value = this.real_turn\n      this.$nextTick(() => this.$refs.turn_edit_input.focus())\n    },\n\n    log(v) {\n      if (this.current_debug_mode) {\n        console.log(v)\n      }\n    },\n\n    board_piece_back_class(xy) {\n      const place = Place.fetch(xy)\n      const soldier = this.mediator.board.lookup(place)\n      let list = []\n\n      list.push(place.to_css_class) // place_99\n\n      if (this.holding_p) {\n        list.push(\"hoverable_p\")\n      }\n\n      if (!this.holding_p) {\n        if (this.mediator.last_hand) {\n          const origin_place = this.mediator.last_hand.origin_place\n          if (origin_place) {\n            if (_.isEqual(origin_place, place)) {\n              list.push(\"origin_place\")\n            }\n          }\n          if (_.isEqual(this.mediator.last_hand.place, place)) {\n            list.push(\"current\")\n          }\n        }\n      }\n\n      if (_.isEqual(this.place_from, place)) {\n        list.push(\"holding_p\")\n      } else if (soldier) {\n        if (this.current_run_mode === \"edit_mode\" || (!this.cpu_location_p && this.mediator.current_location === soldier.location)) {\n          if (!this.holding_p) {\n            list.push(\"selectable_p\")\n          }\n        }\n      }\n\n      // if (soldier) {\n      //   list = _.concat(list, soldier.to_class_list)\n      // }\n\n      return list\n    },\n\n    update_kifu_source(v) {\n      this.inside_custom_kifu = v\n      this.$emit(\"update:kifu_body\", v) // 子で emit されたイベントを親(自分)で拾い、同じ内容で親に向けて発火。何この複雑さ。\n    }\n  },\n\n  computed: {\n    class_names() {\n      return [\n        `theme-${this.current_theme}`,\n        `size-${this.current_size}`,\n        `bg_variant-${this.current_bg_variant}`,\n        `piece_variant-${this.current_piece_variant}`,\n        `run_mode-${this.current_run_mode}`,\n        {debug_mode: this.current_debug_mode},\n        {digit_show: this.digit_show},\n      ]\n    },\n\n    kifu_source() {\n      // 設定で棋譜を更新したのが入った inside_custom_kifu が最優先。つまりもう更新はできなくなる。いいのか？\n      return this.inside_custom_kifu || this.kifu_body_from_url || this.kifu_body || this.init_preset_sfen || \"position startpos\"\n    },\n\n    // 本当は delegate したいシリーズ\n    /* eslint-disable */\n    real_turn() { return this.mediator.real_turn },\n    turn_min()  { return this.mediator.turn_min  },\n    turn_max()  { return this.mediator.turn_max  },\n    /* eslint-enable */\n\n    // mapState({\n    // // アロー関数は、コードをとても簡潔にできます！\n    // count: state => state.count,\n    // // 文字列を渡すことは、`state => state.count` と同じです\n    // countAlias: 'count',\n    // // `this` からローカルステートを参照するときは、通常の関数を使わなければいけません\n    // countPlusLocalState (state) {\n    //   return state.count + this.localCount\n    // }\n    ...mapState({\n    }),\n    ...mapState([\n      \"current_debug_mode\",\n      \"current_theme\",\n      \"current_size\",\n      \"current_bg_variant\",\n      \"current_piece_variant\",\n    ]),\n  },\n}\n</script>\n\n<style lang=\"sass\">\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/ShogiPlayer.vue","import _ from \"lodash\"\n\nimport Mediator from \"../mediator\"\nimport Location from \"../location\"\nimport SideInfo from \"../side_info\"\n\nexport default {\n  /* eslint-disable */\n  props: {\n    human_side_key: { type: String, default: \"both\", }, // 含まれる側だけ操作できるようにする\n  },\n  /* eslint-enable */\n\n  data() {\n    return {\n      moves: [],                  // play_mode 時の棋譜\n      init_sfen: null,            // play_mode に入ったときの最初の状態\n      init_location_key: \"black\", // play_mode に入ったときの最初の手番\n    }\n  },\n\n  created() {\n  },\n\n  mounted() {\n  },\n\n  watch: {\n  },\n\n  methods: {\n    play_mode_setup_from(old_val) {\n      this.log(\"play_mode_setup_from\")\n\n      if (this.mediator.data_source.init_sfen !== undefined) {\n        // 棋譜の最初からの指し手をすべて保持\n        // view_mode -> play_mode\n        if (old_val === \"view_mode\") {\n          this.init_sfen = this.mediator.data_source.init_sfen\n          this.moves = this.mediator.data_source.moves\n        }\n        // edit_mode -> play_mode\n        if (old_val === \"edit_mode\") {\n          this.init_sfen_build()\n        }\n      } else {\n        // 現時点の状態から始める (KIFの場合)\n        if (old_val === \"view_mode\") {\n          this.init_location_key = this.mediator.current_location.key\n        }\n        this.init_sfen_build()\n      }\n\n      this.play_mode_mediator_seek_to(this.real_turn)\n    },\n\n    // 現在の状態を基点として play_mode に入る\n    init_sfen_build() {\n      const sfen_serializer = this.mediator.sfen_serializer\n      this.init_sfen = \"position sfen \" + sfen_serializer.to_board_sfen + \" \" + this.init_location.key[0] + \" \" + sfen_serializer.to_hold_pieces + \" \" + \"1\"\n      this.moves = []\n    },\n\n    play_mode_mediator_seek_to(turn) {\n      this.mediator = new Mediator()\n      this.mediator.data_source = this.data_source_by(this.play_mode_current_sfen)\n      this.mediator.current_turn = turn\n      this.mediator.run()\n    },\n\n    moves_set(value) {\n      this.moves = _.take(this.moves, this.real_turn) // 「待った」して指す場合を考慮してカレント以降の指し手を削除する\n      this.moves.push(value)\n    },\n\n    turn_next() {\n      if (this.current_run_mode === \"play_mode\") {\n        this.mediator = new Mediator()\n        this.mediator.data_source = this.data_source_by(this.play_mode_current_sfen)\n        this.mediator.current_turn = -1\n        this.mediator.run()\n        this.sound_call(\"piece_sound\")\n\n        this.$emit(\"update:play_mode_long_sfen\", this.play_mode_current_sfen)\n        this.$emit(\"update:play_mode_move\", _.last(this.moves))\n        this.$emit(\"update:play_mode_short_sfen\", this.mediator.to_position_sfen)\n\n        // 操作モードで詰将棋を動かしていて間違えて1手すぐに戻したいとき「←」キーですぐに戻せるように(スライダーがあれば)フォーカスする\n        if (this.$refs.turn_slider) {\n          this.$refs.turn_slider.focus()\n        }\n      }\n    },\n  },\n\n  computed: {\n    play_mode_current_sfen() {\n      if (this.init_sfen) {\n        return this.init_sfen + \" moves \" + this.moves.join(\" \")\n      } else {\n        return null\n      }\n    },\n\n    init_location() {\n      return Location.fetch(this.init_location_key)\n    },\n\n    human_locations() {\n      return SideInfo.fetch(this.human_side_key).locations\n    },\n  },\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/play_mode_module.js","<template lang=\"pug\">\n//- style=\"width: auto\"\n.modal-card.has-text-left(style=\"width:auto\")\n  header.modal-card-head\n    p.modal-card-title 設定\n    button.delete(aria-label=\"close\" @click.stop.prevent=\"$parent.close()\")\n\n  section.modal-card-body\n    b-field(label=\"モード\")\n      .block\n        template(v-for=\"e in RunModeInfo.values\")\n          b-radio(v-model=\"current_run_mode\" :native-value=\"e.key\") {{e.name}}\n\n    b-field(label=\"反転\")\n      b-switch(v-model=\"flip\")\n\n    b-field(label=\"デバッグモード\")\n      b-switch(v-model=\"current_debug_mode\")\n\n    b-field(label=\"テーマ\")\n      .block\n        template(v-for=\"e in ThemeInfo.values\")\n          b-radio(v-model=\"$store.state.current_theme\" :native-value=\"e.key\") {{e.name}}\n\n    template(v-if=\"$store.state.current_theme === 'real'\")\n      b-field(label=\"背景の種類\")\n        .block\n          template(v-for=\"e in BgVariantInfo.values\")\n            b-radio(v-model=\"$store.state.current_bg_variant\" :native-value=\"e.key\" size=\"is-small\") {{e.name}}\n\n      b-field(label=\"駒の種類\")\n        .block\n          template(v-for=\"e in PieceVariantInfo.values\")\n            b-radio(v-model=\"$store.state.current_piece_variant\" :native-value=\"e.key\" size=\"is-small\") {{e.name}}\n\n    b-field(label=\"サイズ\")\n      .block\n        template(v-for=\"e in SizeInfo.values\")\n          b-radio(v-model=\"$store.state.current_size\" :native-value=\"e.key\" size=\"is-small\") {{e.name}}\n\n    template(v-if=\"sp_data.mediator\")\n      b-field(label=\"現局面(Readonly)\")\n        b-input(:value=\"sp_data.mediator.to_position_sfen\" type=\"input\" size=\"is-small\" readonly)\n\n    b-field(label=\"再生モードの棋譜(編集可)\")\n      b-input(v-model=\"kifu_source2\" type=\"textarea\" size=\"is-small\")\n\n    b-field(label=\"操作モードの棋譜(Readonly)\")\n      b-input.is-small(:value=\"play_mode_current_sfen\" type=\"textarea\" size=\"is-small\" readonly)\n  footer.modal-card-foot\n    button.button.is-primary(@click.stop.prevent=\"$parent.close()\") 閉じる\n</template>\n\n<script>\n// ここではあえていろんな方法を試している\n//\n// run_mode: コンポーネントへの数珠繋ぎ方式\n// flip:     Vuex で管理している変数をコンポーネント側でラップする方式\n//\n\n// import Vue from \"vue\"\nimport RunModeInfo from \"../run_mode_info\"\nimport ThemeInfo from \"../theme_info\"\nimport SizeInfo from \"../size_info\"\nimport BgVariantInfo from \"../bg_variant_info\"\nimport PieceVariantInfo from \"../piece_variant_info\"\n\n// ↓このように定義した場合はアプリ側で再定義しないといけなくなる\n// Object.defineProperty(Vue.prototype, 'RunModeInfo', {value: RunModeInfo})\n// Object.defineProperty(Vue.prototype, 'ThemeInfo', {value: ThemeInfo})\n// Object.defineProperty(Vue.prototype, 'SizeInfo', {value: SizeInfo})\n// Object.defineProperty(Vue.prototype, 'BgVariantInfo', {value: BgVariantInfo})\n\nexport default {\n  props: {\n    run_mode: { required: true },\n    kifu_source: { required: false },\n    play_mode_current_sfen: { required: true }, // TODO: 親をそのまま参照したいんだけど $data を渡しても play_mode_current_sfen は computed だから参照できない\n    sp_data: { required: true },                // TODO: $data ではなく親を受けとりたい\n  },\n\n  data() {\n    return {\n      RunModeInfo,\n      ThemeInfo,\n      SizeInfo,\n      BgVariantInfo,\n      PieceVariantInfo,\n\n      current_run_mode: this.run_mode,\n      kifu_source2: this.kifu_source,\n    }\n  },\n\n  watch: {\n    current_run_mode(value) {\n      this.$emit(\"update:run_mode\", value)\n    },\n    kifu_source2(value) {\n      this.$emit(\"update:kifu_body\", value)\n    },\n  },\n\n  methods: {\n  },\n\n  computed: {\n    // http://chibinowa.net/note/vuejs/vue-11.html\n    flip: {\n      get() { return this.$store.state.current_flip },\n      set(v) { this.$store.state.current_flip = v },\n    },\n    // ...mapState([\n    //   \"current_debug_mode\",      // これだと get() しか作られない\n    // ]),\n    current_debug_mode: {\n      get() { return this.$store.state.current_debug_mode },\n      set(v) {\n        this.$store.commit(\"current_debug_mode_set\", v) // どんだけ冗長なことやらすんだ。面倒くさいぞこれ\n        // というか別に直接更新してもよい\n        // this.$store.state.current_debug_mode = v\n      },\n    },\n  },\n}\n</script>\n\n\n\n// WEBPACK FOOTER //\n// src/components/SettingModal.vue","import _ from \"lodash\"\n\nimport Sound from '../sound'\n\nimport piece_sound_wav from \"../assets/piece_sound.wav\"\nimport flip_sound_wav from \"../assets/flip_sound.wav\"\n\nexport default {\n  /* eslint-disable */\n  props: {\n    sound_effect: { type: Boolean, default: false, },\n    volume:       { type: Number,  default: 0.5,   },\n  },\n  /* eslint-enable */\n\n  data() {\n    return {\n      piece_sound: null,\n    }\n  },\n\n  created() {\n    this.sound_setup()\n  },\n\n  watch: {\n    sound_effect() {\n      this.sound_setup()\n    },\n\n    volume() {\n      this.sound_setup()\n    },\n  },\n\n  methods: {\n    sound_call(key) {\n      if (this.sound_effect) {\n        const object = this[key]\n        if (object) {\n          object.play()\n          this.log(`sound_call(\"${key}\")`)\n        }\n      }\n    },\n\n    sound_setup() {\n      this.sound_load(\"piece_sound\", piece_sound_wav)\n      this.sound_load(\"flip_sound\", flip_sound_wav)\n    },\n\n    sound_load(key, file) {\n      if (this.sound_effect) {\n        const object = this[key]\n\n        if (_.isNil(object)) {\n          this[key] = new Sound(file)\n        }\n        this[key].options[\"volume\"] = this.volume\n      }\n    },\n  },\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/sound_module.js","import MemoryRecord from \"js-memory-record\"\n// import Location from \"../location\"\n\nexport default class PresetInfo extends MemoryRecord {\n  static get define() {\n    return [\n      /* eslint-disable */\n      { key: \"全部駒箱\",                sfen: \"position sfen 9/9/9/9/9/9/9/9/9 b - 1\",                                                       first_location_key: \"black\", piece_box: [[\"B\", 2], [\"R\", 2], [\"L\", 4], [\"N\", 4], [\"S\", 4], [\"G\", 4], [\"P\", 18], [\"K\", 2]]},\n      { key: \"詰将棋\",                  sfen: \"position sfen 4k4/9/9/9/9/9/9/9/9 b 2r2b4g4s4n4l18p 1\",                                       first_location_key: \"black\", piece_box: [[\"K\", 1]]},\n      { key: \"詰将棋 - 美濃\",           sfen: \"position sfen ln1g5/1ks6/1ppp5/p8/9/9/9/9/9 b BGSNL2rb2g2s2n2l14p 1\",                         first_location_key: \"black\", piece_box: [[\"K\", 1]]},\n      { key: \"詰将棋 - 矢倉\",           sfen: \"position sfen 7nl/6gk1/5gspp/5pp2/9/9/9/9/9 b BGSNL2rbg2s2n2l14p 1\",                          first_location_key: \"black\", piece_box: [[\"K\", 1]]},\n      { key: \"戦型 右四間 vs 四間飛車\", sfen: \"position sfen ln1g1g1nl/1ks2r3/1pppp1bpp/p3spp2/9/P1P1SP1PP/1P1PP1P2/1BK1GR3/LNSG3NL b - 25\", first_location_key: \"black\", piece_box: []},\n      { key: \"平手\",                    sfen: \"position sfen lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b - 1\",               first_location_key: \"black\", piece_box: []},\n      { key: \"香落ち\",                  sfen: \"position sfen lnsgkgsn1/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1\",               first_location_key: \"white\", piece_box: [[\"L\", 1]]},\n      { key: \"右香落ち\",                sfen: \"position sfen 1nsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1\",               first_location_key: \"white\", piece_box: [[\"L\", 1]]},\n      { key: \"角落ち\",                  sfen: \"position sfen lnsgkgsnl/1r7/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1\",                 first_location_key: \"white\", piece_box: [[\"B\", 1]]},\n      { key: \"飛車落ち\",                sfen: \"position sfen lnsgkgsnl/7b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1\",                 first_location_key: \"white\", piece_box: [[\"R\", 1]]},\n      { key: \"飛香落ち\",                sfen: \"position sfen lnsgkgsn1/7b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1\",                 first_location_key: \"white\", piece_box: [[\"R\", 1], [\"L\", 1]]},\n      { key: \"二枚落ち\",                sfen: \"position sfen lnsgkgsnl/9/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1\",                   first_location_key: \"white\", piece_box: [[\"B\", 1], [\"R\", 1]]},\n      { key: \"三枚落ち\",                sfen: \"position sfen lnsgkgsn1/9/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1\",                   first_location_key: \"white\", piece_box: [[\"B\", 1], [\"R\", 1], [\"L\", 1]]},\n      { key: \"四枚落ち\",                sfen: \"position sfen 1nsgkgsn1/9/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1\",                   first_location_key: \"white\", piece_box: [[\"B\", 1], [\"R\", 1], [\"L\", 2]]},\n      { key: \"六枚落ち\",                sfen: \"position sfen 2sgkgs2/9/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1\",                     first_location_key: \"white\", piece_box: [[\"B\", 1], [\"R\", 1], [\"L\", 2], [\"N\", 2]]},\n      { key: \"八枚落ち\",                sfen: \"position sfen 3gkg3/9/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1\",                       first_location_key: \"white\", piece_box: [[\"B\", 1], [\"R\", 1], [\"L\", 2], [\"N\", 2], [\"S\", 2]]},\n      { key: \"十枚落ち\",                sfen: \"position sfen 4k4/9/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1\",                         first_location_key: \"white\", piece_box: [[\"B\", 1], [\"R\", 1], [\"L\", 2], [\"N\", 2], [\"S\", 2], [\"G\", 2]]},\n      { key: \"十九枚落ち\",              sfen: \"position sfen 4k4/9/9/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1\",                                 first_location_key: \"white\", piece_box: [[\"B\", 1], [\"R\", 1], [\"L\", 2], [\"N\", 2], [\"S\", 2], [\"G\", 2], [\"P\", 9]]},\n      { key: \"二十枚落ち\",              sfen: \"position sfen 9/9/9/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1\",                                   first_location_key: \"white\", piece_box: [[\"B\", 1], [\"R\", 1], [\"L\", 2], [\"N\", 2], [\"S\", 2], [\"G\", 2], [\"P\", 9], [\"K\", 1]]},\n      /* eslint-enable */\n    ]\n  }\n}\n\nif (process.argv[1] === __filename) {\n  console.log(PresetInfo.fetch(\"平手\"))\n  console.log(PresetInfo.fetch(\"香落ち\").first_location_key)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/preset_info.js","<template>\n<div class=\"comment_area\" v-if=\"comments_pack\">\n  <div v-if=\"current_comments\">\n    <div class=\"columns\">\n      <div class=\"column\"><!-- is-three-fifths is-offset-one-fifth -->\n        <article class=\"message is-info has-text-left\">\n          <div class=\"message-body\">\n            <div class=\"content\">\n              <template v-for=\"str in current_comments\">\n                <template v-if=\"_.isEmpty(str)\">\n                  <br>\n                </template>\n                <template v-else>\n                  <div v-html=\"auto_link(str)\"></div>\n                </template>\n              </template>\n            </div>\n          </div>\n        </article>\n      </div>\n    </div>\n  </div>\n</div>\n</template>\n\n<script>\nimport Vue from 'vue'\nimport _ from \"lodash\"\nimport Autolinker from 'autolinker'\n\n// To use lodash's _ in the vue template\nObject.defineProperty(Vue.prototype, '_', {value: _})\n\nexport default {\n  props: {\n    comments_pack: { required: true },\n    current_comments: { required: true },\n  },\n\n  created() {\n    this.autolinker = new Autolinker()\n  },\n\n  methods: {\n    auto_link(str) {\n      return this.autolinker.link(str)\n    },\n  },\n}\n</script>\n\n\n\n// WEBPACK FOOTER //\n// src/components/CommentArea.vue","import axios from \"axios\"\nconst logger_debug = require('debug')('debug')\n\nexport default {\n  /* eslint-disable */\n  props: {\n    kifu_url:           { type: String,  default: null, },\n    polling_interval:   { type: Number,  default: 0,    },\n  },\n  /* eslint-enable */\n\n  data() {\n    return {\n      interval_id: null,\n      kifu_body_from_url: null,\n    }\n  },\n\n  created() {\n  },\n\n  mounted() {\n  },\n\n  watch: {\n    kifu_url() {\n      this.axios_call()\n    },\n    polling_interval() {\n      this.polling_interval_update()\n    },\n  },\n\n  methods: {\n    polling_interval_update() {\n      if (this.polling_interval >= 1) {\n        if (this.interval_id) {\n          this.log(`clearInterval(${this.interval_id})`)\n          clearInterval(this.interval_id)\n          this.interval_id = null\n        }\n        this.interval_id = setInterval(() => { this.axios_call() }, this.polling_interval * 1000)\n        this.log(`setInterval() => ${this.interval_id}`)\n      }\n    },\n\n    axios_call() {\n      const url = this.kifu_url\n      // const url = \"http://localhost:3000/wr/hanairobiyori-ispt-20171104_220810.kif\"\n      // const url = \"http://tk2-221-20341.vs.sakura.ne.jp/shogi/wr/ureshino_friend-doglong-20180122_213544.kif\"\n      const accessd_at = Date.now().toString()\n      axios({\n        url: url,\n        method: \"get\",\n        params: {\"accessd_at\": accessd_at},\n        responseType: \"text\",\n        timeout: 1000 * 3,\n        headers: {\"X-SHOGI-PLAYER-TIMESTAMP\": accessd_at},\n      }).then((response) => {\n        this.error_message = null\n        this.inside_custom_kifu = null\n        this.kifu_body_from_url = response.data\n        // this.mediator_setup(this.start_turn)\n      }).catch((error) => {\n        if (error.response) {\n          logger_debug(\"error.response.data: %o\", error.response.data)\n          logger_debug(\"error.response.status: %o\", error.response.status)\n          logger_debug(\"error.response.statusText: %o\", error.response.statusText)\n          logger_debug(\"error.response.headers: %o\", error.response.headers)\n        } else if (error.request) {\n          logger_debug(\"error.request: %o\", error.request)\n        } else {\n          logger_debug('error.message: %o', error.message)\n        }\n        logger_debug('error.config: %o', error.config)\n\n        this.kifu_body_from_url = null\n        this.error_message = error.message\n      })\n    },\n  },\n\n  computed: {\n  },\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/polling_module.js","import MemoryRecord from \"js-memory-record\"\n\nexport default class ThemeInfo extends MemoryRecord {\n  static get define() {\n    return [\n      /* eslint-disable */\n      { key: \"none\",   name: \"なし\",   },\n      { key: \"simple\", name: \"紙面風\", },\n      { key: \"real\",   name: \"画像駒\", },\n      /* eslint-enable */\n    ]\n  }\n}\n\nif (process.argv[1] === __filename) {\n  console.log(ThemeInfo.fetch(\"real\").key)\n  console.log(ThemeInfo.fetch(\"real\").name)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/theme_info.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"piece_stand_outer\",class:_vm.piece_stand_outer_class},[_c('div',{staticClass:\"location_mark_wrap\"},[_c('div',{staticClass:\"location_mark\",domProps:{\"innerHTML\":_vm._s(_vm.location_name)}}),_c('div',{staticClass:\"piece_count piece_count1\"},[_vm._v(\"99\")])]),_c('ul',{staticClass:\"piece_stand\",class:_vm.piece_stand_class,on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.$parent.piece_stand_click(_vm.location, $event)},\"contextmenu\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.$parent.hold_cancel($event)}}},_vm._l((_vm.hold_pieces),function(ref){\nvar piece = ref[0];\nvar count = ref[1];\nreturn _c('li',{on:{\"click\":function($event){$event.stopPropagation();return _vm.$parent.piece_stand_piece_click(_vm.location, piece, $event)}}},[_c('div',{staticClass:\"piece_back\",class:_vm.piece_back_class(piece)},[_c('div',{staticClass:\"piece_fore\",class:_vm.piece_fore_class(piece)},[_vm._v(_vm._s(piece.name))])]),(count >= 1)?_c('div',{staticClass:\"piece_count\",class:(\"piece_count\" + count)},[_vm._v(_vm._s(count))]):_vm._e()])}),0)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-218fd7d4\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/PieceStand.vue\n// module id = BQ6O\n// module chunks = 1 2","module.exports = __webpack_public_path__ + \"static/media/flip_sound.2c50e2c.wav\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/flip_sound.wav\n// module id = G1k4\n// module chunks = 1 2","import _ from 'lodash'\nimport Board from './board'\nimport Place from './place'\nimport Piece from './piece'\n\nexport default class Soldier {\n  constructor(attributes) {\n    this.attributes = Object.assign({}, attributes)\n  }\n\n  get piece() {\n    return this.attributes.piece\n  }\n\n  set place(place) {\n    this.attributes.place = place\n  }\n\n  get place() {\n    return this.attributes.place\n  }\n\n  get location() {\n    return this.attributes.location\n  }\n\n  get promoted() {\n    return !!this.attributes.promoted\n  }\n\n  set promoted(v) {\n    this.attributes.promoted = v\n  }\n\n  get name() {\n    if (this.promoted) {\n      return this.piece.promoted_name\n    }\n    return this.piece.name\n  }\n\n  get piece_transform() {\n    let attrs = null\n    if (this.piece.promotable_p) {\n      if (this.promoted) {\n        attrs = {location: this.location.flip, promoted: !this.promoted}\n      } else {\n        attrs = {promoted: !this.promoted}\n      }\n    } else {\n      attrs = {location: this.location.flip}\n    }\n    return new Soldier(Object.assign({}, this.attributes, attrs))\n  }\n\n  get promotable_p() {\n    if (this.piece.promotable_p && !this.promoted) { // 成れるのに成ってなくて\n      return this.danger_zone_p\n    }\n  }\n\n  get danger_zone_p() {\n    if (this.location.key === \"black\") {\n      return this.place.y < Board.danger_zone_size\n    } else {\n      return this.place.y >= (Board.dimension - Board.danger_zone_size)\n    }\n  }\n\n  get to_class_list() {\n    let list = []\n    list.push(`location_${this.location.key}`)\n    list.push(`promoted_${this.promoted}`)\n    list = _.concat(list, this.piece.css_class_list)\n    return list\n  }\n}\n\nif (process.argv[1] === __filename) {\n  const soldier = new Soldier({\n    place: new Place([1, 2]),\n    piece: Piece.fetch(\"P\"),\n    promoted: true,\n    location_key: \"white\",\n  })\n  console.log(soldier.name)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/soldier.js","import Vuex from \"vuex\"\n\n// ここで Vue.use(Vuex) すると利用する側と干渉するので注意\n\nconst store = () => new Vuex.Store({\n  state: {\n    current_flip: false,                // 反転したか？\n    current_debug_mode: false,\n    current_theme: null,\n    current_size: null,\n    current_bg_variant: null,\n    current_piece_variant: null,\n  },\n  mutations: {\n    // this.$store.commit(\"flip_toggle\") として呼び出す\n    flip_toggle(state) {\n      state.current_flip = !state.current_flip\n    },\n\n    // this.$store.commit(\"current_debug_mode_set\", true)\n    current_debug_mode_set(state, payload) {\n      state.current_debug_mode = payload\n      // ここで呼び出しても意味ない。効き目なし。\n      this.$emit(\"update:debug_mode\", payload)\n    },\n  },\n})\n\nexport default store\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/index.js","import _ from \"lodash\"\n\nimport Board from \"./board\"\n\nexport default class Place {\n  static fetch(v) {\n    if (v instanceof this) {\n      return v\n    }\n    return Object.freeze(new Place(v))\n  }\n\n  constructor(value) {\n    let x, y\n    if (_.isString(value)) {\n      [x, y] = this._parse_from_string(value)\n    } else {\n      [x, y] = value            // valus is array\n    }\n    [this._x, this._y] = [x, y]\n  }\n\n  get key() {\n    return [this._x, this._y].toString()\n  }\n\n  get x() {\n    return this._x\n  }\n\n  get y() {\n    return this._y\n  }\n\n  get flip() {\n    return Place.fetch([Board.dimension - 1 - this._x, Board.dimension - 1 - this._y])\n  }\n\n  _parse_from_string(s) {\n    s = s.replace(/([１-９一二三四五六七八九a-z])/g, (e) => this._replace_table[e])\n    const [x, y] = s.split(\"\").map((e) => Number(e))\n    return [Board.dimension - x, y - 1]\n  }\n\n  get _replace_table() {\n    /* eslint-disable object-property-newline, key-spacing */\n    return {\n      \"１\": 1, \"２\": 2, \"３\": 3, \"４\": 4, \"５\": 5, \"６\": 6, \"７\": 7, \"８\": 8, \"９\": 9,\n      \"一\": 1, \"二\": 2, \"三\": 3, \"四\": 4, \"五\": 5, \"六\": 6, \"七\": 7, \"八\": 8, \"九\": 9,\n      \"a\":  1, \"b\":  2, \"c\":  3, \"d\":  4, \"e\":  5, \"f\":  6, \"g\":  7, \"h\":  8, \"i\":  9,\n    }\n  }\n\n  get to_sfen() {\n    const y_table = [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\", \"i\"]\n    return [Board.dimension - this._x, y_table[this._y]].join(\"\")\n  }\n\n  get to_css_class() {\n    return `place_${this.human_digits}`\n  }\n\n  get human_digits() {\n    return [\n      Board.dimension - this._x,\n      this._y + 1,\n    ].join(\"\")\n  }\n}\n\nif (process.argv[1] === __filename) {\n  console.log(Place.fetch(\"6a\").key)\n  console.log(Place.fetch([1, 2]).key)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/place.js","import _ from \"lodash\"\nimport Vue from \"vue\"\n\nimport Board from \"./board\"\nimport Place from \"./place\"\nimport Piece from \"./piece\"\nimport Soldier from \"./soldier\"\nimport SfenParser from \"./sfen_parser\"\nimport SfenSerializer from \"./sfen_serializer\"\n\nexport default class Mediator {\n  constructor() {\n    const data_source = new SfenParser()\n    data_source.kifu_body = \"position startpos\"\n    data_source.parse()\n\n    this.data_source = data_source\n    this.current_turn = 0\n    this.board = null\n    this.hold_pieces = null\n    this.last_hand = null\n    this.piece_box = {}\n\n    this.env = process.env.NODE_ENV\n  }\n\n  run() {\n    this.board = this.data_source.board\n    this.hold_pieces = this.data_source.hold_pieces\n    this.last_hand = null\n\n    const move_infos = this.data_source.move_infos\n\n    const num = this.real_turn - this.turn_min\n    _(num).times((i) => { this.execute_one(move_infos[i]) })\n  }\n\n  execute_one(m) {\n    this.last_hand = m\n    if (m.drop_piece) {\n      const soldier = new Soldier({\n        piece: m.drop_piece,\n        place: m.place,\n        promoted: m.promoted,\n        location: m.location,\n      })\n      this.hold_pieces_add(m.location, soldier.piece, -1)\n      this.board.place_on(soldier)\n    } else {\n      {\n        const soldier = this.board.lookup(m.place)\n        if (soldier) {\n          this.hold_pieces_add(m.location, soldier.piece, 1)\n        }\n      }\n      const soldier = this.board.lookup(m.origin_place)\n      if (m.promoted_trigger) {\n        soldier.promoted = true\n      }\n      soldier.place = m.place\n      this.board.delete_at(m.origin_place)\n      this.board.place_on(soldier)\n    }\n  }\n\n  hold_pieces_count(location, piece) {\n    return this.hold_pieces[location.key][piece.key] || 0\n  }\n\n  hold_pieces_add(location, piece, plus = 1) {\n    const count = this.hold_pieces_count(location, piece) + plus\n    const counts_hash = this.hold_pieces[location.key]\n    if (count >= 1) {\n      Vue.set(counts_hash, piece.key, count)\n    } else {\n      Vue.delete(counts_hash, piece.key)\n    }\n  }\n\n  board_safe_delete_on(place) {\n    this.board.delete_at(place)\n  }\n\n  board_piece_fore_class(xy) {\n    const place = Place.fetch(xy)\n    const soldier = this.board.lookup(place)\n\n    if (soldier) {\n      return soldier.to_class_list\n    }\n\n    return []\n  }\n\n  cell_piece_class(xy) {\n    const place = Place.fetch(xy)\n    const soldier = this.board.lookup(place)\n    let list = []\n    if (soldier) {\n      list.push(`location_${soldier.location.key}`)\n    }\n    return list\n  }\n\n  cell_view(xy) {\n    const place = Place.fetch(xy)\n    const soldier = this.board.lookup(place)\n    let str = \"\"\n    if (soldier) {\n      str = soldier.name\n    }\n    return str\n  }\n\n  get dimension() {\n    return Board.dimension\n  }\n\n  // ruby style array index access\n  get real_turn() {\n    let index = Number(this.current_turn)\n    if (index < 0) {\n      index += this.turn_max + 1\n    }\n    return this.turn_clamp(index)\n  }\n\n  turn_clamp(index) {\n    return _.clamp(Number(index), this.turn_min, this.turn_max)\n  }\n\n  get previous_location() {\n    return this.data_source.location_by_offset(this.real_turn - 1)\n  }\n\n  get current_location() {\n    return this.data_source.location_by_offset(this.real_turn)\n  }\n\n  get current_comments() {\n    if (this.data_source.comments_pack) {\n      return this.data_source.comments_pack[this.real_turn]\n    }\n  }\n\n  get turn_min() {\n    return this.data_source.turn_min\n  }\n\n  get turn_max() {\n    return this.data_source.turn_max\n  }\n\n  current_turn_label(final_label) {\n    if (this.real_turn === this.turn_max) {\n      if (final_label) {\n        return `まで${this.real_turn}手で${final_label}`\n      } else {\n        return `まで${this.real_turn}手で${this.previous_location.name}の勝ち`\n      }\n    } else {\n      return `${this.real_turn}手目`\n    }\n  }\n\n  realized_hold_pieces_of(location_key) {\n    const list = Object.entries(this.hold_pieces[location_key])\n    return _(list)\n      .filter(([key, count]) => count >= 1)\n      .map(([key, count]) => [Piece.fetch(key), count])\n      .sortBy(([key, count]) => key.code)\n      .value()\n  }\n\n  // -------------------------------------------------------------------------------- serialize\n\n  // 重いのでキャッシュしておく\n  get to_sfen() {\n    return this.cached(\"to_sfen\", () => this.sfen_serializer.to_s)\n  }\n\n  get to_sfen_without_turn() {\n    return this.cached(\"to_sfen_without_turn\", () => this.sfen_serializer.to_s_without_turn)\n  }\n\n  get to_position_sfen() {\n    return `position sfen ${this.to_sfen}`\n  }\n\n  get sfen_serializer() {\n    return new SfenSerializer(this)\n  }\n\n  // -------------------------------------------------------------------------------- piece_box\n\n  piece_box_count(piece) {\n    return this.piece_box[piece.key] || 0\n  }\n\n  piece_box_add(piece, plus = 1) {\n    const count = this.piece_box_count(piece) + plus\n    if (count >= 1) {\n      Vue.set(this.piece_box, piece.key, count)\n    } else {\n      Vue.delete(this.piece_box, piece.key)\n    }\n  }\n\n  piece_box_realize() {\n    const list = Object.entries(this.piece_box) // {a: 1} => [['a', 1]]\n    return _(list)\n      .filter(([key, count]) => count >= 1)\n      .map(([key, count]) => [Piece.fetch(key), count])\n      .sortBy(([key, count]) => key.code)\n      .value()\n  }\n\n  // -------------------------------------------------------------------------------- private\n\n  cached(key, func) {\n    const name = `__cached_${key}`\n    if (typeof this[name] !== \"undefined\") {\n      // alert(`cached: ${key}`)\n      return this[name]\n    }\n    // alert(`run: ${key}`)\n    this[name] = func()\n    return this[name]\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/mediator.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.comments_pack)?_c('div',{staticClass:\"comment_area\"},[(_vm.current_comments)?_c('div',[_c('div',{staticClass:\"columns\"},[_c('div',{staticClass:\"column\"},[_c('article',{staticClass:\"message is-info has-text-left\"},[_c('div',{staticClass:\"message-body\"},[_c('div',{staticClass:\"content\"},[_vm._l((_vm.current_comments),function(str){return [(_vm._.isEmpty(str))?[_c('br')]:[_c('div',{domProps:{\"innerHTML\":_vm._s(_vm.auto_link(str))}})]]})],2)])])])])]):_vm._e()]):_vm._e()}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-3a87a5fb\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/CommentArea.vue\n// module id = N+at\n// module chunks = 1 2","module.exports = __webpack_public_path__ + \"static/media/piece_sound.8673c34.wav\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/piece_sound.wav\n// module id = N1+3\n// module chunks = 1 2","import MemoryRecord from \"js-memory-record\"\n\nexport default class Piece extends MemoryRecord {\n  static get define() {\n    return [\n      // 順序について\n      // http://yaneuraou.yaneu.com/2016/07/15/sfen%E6%96%87%E5%AD%97%E5%88%97%E3%81%AF%E6%9C%AC%E6%9D%A5%E3%81%AF%E4%B8%80%E6%84%8F%E3%81%AB%E5%AE%9A%E3%81%BE%E3%82%8B%E4%BB%B6/\n      // https://web.archive.org/web/20080131070731/http://www.glaurungchess.com/shogi/usi.html\n      { key: \"K\", name: \"玉\", alias_name: \"王\", promoted_name: null, promoted_alias_name: null, },\n      { key: \"R\", name: \"飛\", alias_name: null, promoted_name: \"龍\", promoted_alias_name: \"竜\", },\n      { key: \"B\", name: \"角\", alias_name: null, promoted_name: \"馬\", promoted_alias_name: null, },\n      { key: \"G\", name: \"金\", alias_name: null, promoted_name: null, promoted_alias_name: null, },\n      { key: \"S\", name: \"銀\", alias_name: null, promoted_name: \"全\", promoted_alias_name: null, },\n      { key: \"N\", name: \"桂\", alias_name: null, promoted_name: \"圭\", promoted_alias_name: null, },\n      { key: \"L\", name: \"香\", alias_name: null, promoted_name: \"杏\", promoted_alias_name: null, },\n      { key: \"P\", name: \"歩\", alias_name: null, promoted_name: \"と\", promoted_alias_name: null, },\n    ]\n  }\n\n  static lookup(key) {\n    if (typeof key === \"string\") {\n      key = key.toUpperCase()\n    }\n    return super.lookup(key)\n  }\n\n  static kif_lookup(key) {\n    return this.values.find((e) => [e.name, e.alias_name].includes(key))\n  }\n\n  static kif_promoted_lookup(key) {\n    return this.values.find((e) => [e.promoted_name, e.promoted_alias_name].includes(key))\n  }\n\n  get css_class_list() {\n    return [\"piece_name\", `piece_${this.key}`]\n  }\n\n  get promotable_p() {\n    return !!this.promoted_name\n  }\n}\n\nif (process.argv[1] === __filename) {\n  console.log(Piece.fetch(\"K\"))\n  console.log(Piece.fetch(\"K\"))\n  console.log(Piece.lookup(\"\"))\n  console.log(Piece.values)\n  console.log(Piece.values_map.get(\"K\"))\n  console.log(Piece.fetch(\"K\").key)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/piece.js","import MemoryRecord from \"js-memory-record\"\n\nexport default class BgVariantInfo extends MemoryRecord {\n  static get define() {\n    return [\n      /* eslint-disable */\n      { key: 'a', },\n      { key: 'b', },\n      { key: 'c', },\n      { key: 'd', },\n      { key: 'e', },\n      { key: 'f', },\n      { key: 'g', },\n      { key: 'h', },\n      { key: 'i', },\n      { key: 'j', },\n      { key: 'k', },\n      { key: 'l', },\n      { key: 'm', },\n      { key: 'n', },\n      { key: 'o', },\n      { key: 'p', },\n      { key: 'q', },\n      { key: 'r', },\n      { key: 's', },\n      { key: 't', },\n      { key: 'u', },\n      { key: 'v', },\n      { key: 'w', },\n      { key: 'x', },\n      { key: 'y', },\n      { key: 'z', },\n      /* eslint-enable */\n    ]\n  }\n}\n\nif (process.argv[1] === __filename) {\n  console.log(BgVariantInfo.fetch(\"a\").key)\n  console.log(BgVariantInfo.fetch(\"a\").name)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/bg_variant_info.js","import MemoryRecord from \"js-memory-record\"\n\nexport default class PieceVariantInfo extends MemoryRecord {\n  static get define() {\n    return [\n      /* eslint-disable */\n      { key: 'a', name: \"デフォルト\", },\n      { key: 'b', name: \"将棋図案駒\", },\n      /* eslint-enable */\n    ]\n  }\n}\n\nif (process.argv[1] === __filename) {\n  console.log(PieceVariantInfo.fetch(\"a\").key)\n  console.log(PieceVariantInfo.fetch(\"a\").name)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/piece_variant_info.js","import _ from \"lodash\"\n\nimport Piece from \"./piece\"\nimport Place from \"./place\"\nimport Mediator from \"./mediator\"\nimport Location from \"./location\"\nimport Board from \"./board\"\n\nexport default class SfenSerializer {\n  constructor(mediator) {\n    this.mediator = mediator\n  }\n\n  get to_s() {\n    const parts = this.__base_parts\n    parts.push(this.mediator.real_turn + 1)           // 1\n    return parts.join(\" \")\n  }\n\n  // 局面ペディア用(ターンを指定するとエラーになるため)\n  get to_s_without_turn() {\n    return this.__base_parts.join(\" \")\n  }\n\n  get to_board_sfen() {\n    const rows = []\n    _.times(Board.dimension, (y) => {\n      let str = \"\"\n      let space = 0\n      _.times(Board.dimension, (x) => {\n        const place = Place.fetch([x, y])\n        const soldier = this.mediator.board.lookup(place)\n        if (_.isNil(soldier)) {\n          space++\n        } else {\n          if (space >= 1) {\n            str += space\n            space = 0\n          }\n          if (soldier.promoted) {\n            str += \"+\"\n          }\n          let key = soldier.piece.key\n          if (soldier.location.key === \"white\") {\n            key = key.toLowerCase()\n          }\n          str += key\n        }\n      })\n      if (space >= 1) {\n        str += space\n      }\n      rows.push(str)\n    })\n    return rows.join(\"/\")\n  }\n\n  get to_hold_pieces() {\n    let str = Location.values.map((location_info) => {\n      const hold_pieces = this.mediator.hold_pieces[location_info.key]\n      const values = Piece.values.map((e) => {\n        let count = hold_pieces[e.key] || 0\n        let str = \"\"\n        if (count === 0) {\n          return null\n        }\n        if (count >= 2) {\n          str += count\n        }\n        let key = e.key\n        if (location_info.key === \"white\") {\n          key = key.toLowerCase()\n        } else {\n          key = key.toUpperCase()\n        }\n        str += key\n        return str\n      })\n      return _.compact(values).join(\"\")\n    }).join(\"\")\n\n    if (_.isEmpty(str)) {\n      str = \"-\"\n    }\n\n    return str\n  }\n\n  // private\n\n  get __base_parts() {\n    const parts = []\n    parts.push(this.to_board_sfen)                    // 9/9/9/9...\n    parts.push(this.mediator.current_location.key[0]) // \"b\"\n    parts.push(this.to_hold_pieces)                   // \"-\"\n    return parts\n  }\n}\n\nif (process.argv[1] === __filename) {\n  const mediator = new Mediator()\n  mediator.kifu_body = \"position sfen +lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b S2s 1 moves 7i6h S*2d\"\n  mediator.current_turn = 1\n  mediator.run()\n  const sfen_serializer = new SfenSerializer(mediator)\n  console.log(sfen_serializer.to_s)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/sfen_serializer.js","import _ from \"lodash\"\nimport { mapState } from 'vuex'\n\nexport default {\n  /* eslint-disable */\n  props: {\n    slider_show:       { type: Boolean, default: false, },\n    controller_show:   { type: Boolean, default: false, },\n    key_event_capture: { type: Boolean, default: false  },\n    shift_key_mag:     { type: Number,  default: 10,    },\n    system_key_mag:    { type: Number,  default: 50,    },\n    flip:              { type: Boolean, default: false  },\n  },\n  /* eslint-enable */\n\n  data() {\n    return {\n    }\n  },\n\n  mounted() {\n    window.addEventListener(\"keydown\", this.keydown_hook, false)\n  },\n\n  created() {\n    this.$store.state.current_flip = this.flip\n  },\n\n  watch: {\n    /* eslint-disable */\n    current_flip(v)     { this.$emit(\"update:flip\", v)       }, // 中 -> 外\n    flip(v)             { this.$store.state.current_flip = v }, // 外 -> 中\n    /* eslint-enable */\n  },\n\n  methods: {\n    keydown_hook(e) {\n      if (this.current_debug_mode && false) {\n        this.log(document.activeElement)\n        this.log(e.shiftKey, e.ctrlKey, e.altKey, e.metaKey)\n        this.log(\"e\", e)\n        this.log(\"key\", e.key)\n        this.log(\"code\", e.code)\n        this.log(\"repeat\", e.repeat)\n      }\n\n      if (!this.key_event_capture) {\n        return\n      }\n\n      const dom = document.activeElement\n      const controllers = [this.$refs.first, this.$refs.previous, this.$refs.next, this.$refs.last] // FIXME: 指定DOMの下にあるか？の方法がわかればもっと簡潔になる\n      if (!(dom === undefined || dom.tagName === \"BODY\" || _.includes(controllers, dom))) {\n        return\n      }\n\n      if (e.code === \"Backspace\" || e.code === \"ArrowUp\" || e.code === \"ArrowLeft\" || e.key === \"k\" || e.key === \"p\" || e.key === \"b\") {\n        this.relative_move(-1, e)\n        e.preventDefault()\n      }\n\n      if (e.code === \"Space\" || e.code === \"Enter\" || e.code === \"ArrowDown\" || e.code === \"ArrowRight\" || e.key === \"j\" || e.key === \"n\" || e.key === \"f\") {\n        this.relative_move(1, e)\n        e.preventDefault()\n      }\n\n      // let gap = null\n      // let force_value = null\n      //\n      // if (e.code === \"Space\" || e.code === \"Enter\" || e.code === \"ArrowDown\" || e.code === \"ArrowRight\" || e.key === \"j\" || e.key === \"n\" || e.key === \"f\") {\n      //   gap = 1\n      // }\n      // if (e.code === \"Backspace\" || e.code === \"ArrowUp\" || e.code === \"ArrowLeft\" || e.key === \"k\" || e.key === \"p\" || e.key === \"b\") {\n      //   gap = -1\n      // }\n      // if (e.key === \"PageUp\") {\n      //   gap = -10\n      // }\n      // if (e.key === \"PageDown\") {\n      //   gap = 10\n      // }\n      // if (e.shiftKey || e.ctrlKey || e.altKey || e.metaKey) {\n      //   if (gap) {\n      //     gap *= 10\n      //   }\n      // }\n      // if (e.key === \"[\" || e.key === \"Home\" || e.code === \"Escape\") {\n      //   force_value = this.turn_min\n      // }\n      // if (e.key === \"]\" || e.key === \"End\") {\n      //   force_value = this.turn_max\n      // }\n      //\n      // let v = this.current_turn\n      // if (gap !== null) {\n      //   v += gap\n      // }\n      // if (force_value !== null) {\n      //   v = force_value\n      // }\n      // if (v < this.turn_min) {\n      //   v = this.turn_min\n      // }\n      // if (this.turn_max < v) {\n      //   v = this.turn_max\n      // }\n      // this.current_turn = v\n      //\n      // if (gap !== null || force_value !== null) {\n      //   e.preventDefault()\n      // }\n    },\n\n    navi_relative_move(v, event) {\n      this.relative_move(v * this.flip_sign, event)\n    },\n\n    relative_move(v, event = null) {\n      if (event) {\n        if (event.shiftKey) {\n          if (this.shift_key_mag) {\n            v *= this.shift_key_mag\n          }\n        }\n        if (event.ctrlKey || event.altKey || event.metaKey) {\n          if (this.system_key_mag) {\n            v *= this.system_key_mag\n          }\n        }\n      }\n\n      this.current_turn_add(v)\n\n      if (!this.focus_to(\"turn_slider\")) {\n        if (v > 0) {\n          this.focus_to(\"next\")\n        } else {\n          this.focus_to(\"previous\")\n        }\n      }\n    },\n\n    move_to_first() {\n      this.current_turn_set(this.turn_min)\n      this.focus_to(\"turn_slider\") || this.focus_to(\"first\")\n    },\n\n    move_to_last() {\n      this.current_turn_set(this.turn_max)\n      this.focus_to(\"turn_slider\") || this.focus_to(\"last\")\n    },\n\n    current_turn_add(v) {\n      this.current_turn_set(this.mediator.real_turn + v)\n    },\n\n    current_turn_set(v) {\n      const new_val = this.mediator.turn_clamp(v)\n      const updated = this.real_turn !== new_val\n\n      if (updated) {\n        if (this.current_run_mode === \"view_mode\") {\n          this.view_mode_mediator_update(new_val)\n        }\n        if (this.current_run_mode === \"play_mode\") {\n          this.play_mode_mediator_seek_to(new_val)\n        }\n        this.sound_call(\"piece_sound\")\n        this.$emit(\"update:start_turn\", this.real_turn)\n      }\n    },\n\n    focus_to(key) {\n      const el = this.$refs[key]\n      if (el) {\n        el.focus()\n        return true\n      }\n      return false\n    },\n\n    board_flip_run() {\n      this.$store.commit(\"flip_toggle\")\n      this.sound_call(\"flip_sound\")\n      this.focus_to(\"turn_slider\")\n    },\n  },\n\n  //\n  // ...mapState([\n  //   \"current_flip\",\n  // ]),\n  //\n  // が、\n  //\n  // Failed to compile.\n  //\n  // ./node_modules/shogi-player/src/components/navi_module.js\n  // Module parse failed: Unexpected token (191:4)\n  // You may need an appropriate loader to handle this file type.\n  // |       return this.current_flip ? -1 : 1\n  // |     },\n  // |     ...mapState([\n  // |       \"current_flip\",\n  // |     ]),\n  //  @ ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./node_modules/shogi-player/src/components/ShogiPlayer.vue 49:19-46\n  //  @ ./node_modules/shogi-player/src/components/ShogiPlayer.vue\n  //  @ ./app/javascript/packs/application.js\n  //  @ multi (webpack)-dev-server/client?http://localhost:3035 ./app/javascript/packs/application.js\n  //\n  // となるため仕方なく Object.assign を使う\n  //\n  computed: Object.assign({}, {\n    flip_sign() {\n      return this.current_flip ? -1 : 1\n    },\n  }, mapState([\n    \"current_flip\",\n  ])),\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/navi_module.js","import MemoryRecord from \"js-memory-record\"\n\nexport default class SizeInfo extends MemoryRecord {\n  static get define() {\n    return [\n      /* eslint-disable */\n      { key: \"none\",      },\n      { key: \"xx-small\",  },\n      { key: \"x-small\",   },\n      { key: \"small\",     },\n      { key: \"default\",   },\n      { key: \"medium\",    },\n      { key: \"large\",     },\n      { key: \"x-large\",   },\n      { key: \"xx-large\",  },\n      { key: \"xxx-large\", },\n      /* eslint-enable */\n    ]\n  }\n}\n\nif (process.argv[1] === __filename) {\n  console.log(SizeInfo.fetch(\"x-small\").key)\n  console.log(SizeInfo.fetch(\"x-small\").name)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/size_info.js","var normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./PieceStand.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./PieceStand.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-218fd7d4\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../node_modules/vue-loader/lib/selector?type=template&index=0!./PieceStand.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/PieceStand.vue\n// module id = a83v\n// module chunks = 1 2","// const piece_sound = new Sound(\"../static/piece_sound.wav\", {volume: 0.5})\n// piece_sound.options[:volume] = 0.2\n// piece_sound.play()\n\nimport axios from \"axios\"\n\nvar __audio_context__\n\n// new Sound() のたびに new AudioContext() すると6回目ぐらいでエラーになるため根本的な解決にはなっていないが外で一回だけ呼ぶ\nif (typeof window !== \"undefined\" && process.env.NODE_ENV !== \"test\") {\n  window.AudioContext = window.AudioContext || window.webkitAudioContext\n  __audio_context__ = new AudioContext()\n}\n\nexport default class Sound {\n  constructor(url, options = {}) {\n    this.url = url\n    this.options = options\n    this.buffer = null\n\n    if (process.env.NODE_ENV === \"test\") {\n      return\n    }\n\n    this.__resource_load()\n  }\n\n  play() {\n    if (this.is_loaded) {\n      const source = __audio_context__.createBufferSource()\n      source.buffer = this.buffer\n      if (this.volume === null) {\n        // Sound -> Destination\n        source.connect(__audio_context__.destination)\n      } else {\n        // Sound -> GainNode -> Destination\n        const gain_node = __audio_context__.createGain()\n        source.connect(gain_node)\n        gain_node.connect(__audio_context__.destination)\n        gain_node.gain.value = this.volume\n      }\n      source.start(0)\n    }\n  }\n\n  get is_loaded() {\n    return this.buffer !== null\n  }\n\n  get volume() {\n    let volume = 1.0\n    if (this.options[\"volume\"] !== undefined) {\n      volume = this.options[\"volume\"]\n    }\n    return volume\n  }\n\n  __resource_load() {\n    // 動かない\n    if (false) {\n      axios(this.uri, {responseType: \"arraybuffer\"})\n        .then(data => this.context.decodeAudioData(data))\n        .then(buffer => { this.buffer = buffer })\n    }\n\n    // Safari でも動く\n    if (true) {\n      const req = new XMLHttpRequest()\n      req.responseType = \"arraybuffer\"\n      req.onreadystatechange = () => {\n        if (req.readyState === 4) {\n          if (req.status === 0 || req.status === 200) {\n            console.log(`${this.constructor.name}#__resource_load(\"${this.url}\")`)\n            __audio_context__.decodeAudioData(req.response, buffer => { this.buffer = buffer })\n          }\n        }\n      }\n      req.open(\"GET\", this.url, true)\n      req.send(\"\")\n    }\n\n    // 簡単だけどsafariでは動かない\n    if (false) {\n      fetch(this.url)\n        .then(response => response.arrayBuffer())\n        .then(bin => __audio_context__.decodeAudioData(bin, buffer => (this.buffer = buffer)))\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/sound.js","import Piece from \"../piece\"\nimport Mediator from \"../mediator\"\nimport PresetInfo from \"../preset_info\"\n\nexport default {\n  /* eslint-disable */\n  props: {\n    preset_key: { type: String,  default: null, },\n  },\n  /* eslint-enable */\n\n  data() {\n    return {\n      current_preset_key: this.preset_key, // 選択中の初期配置\n    }\n  },\n\n  created() {\n  },\n\n  mounted() {\n  },\n\n  watch: {\n    preset_key(v) { this.current_preset_key = v },              // 引数の変更を反映\n    current_preset_key(v) { this.mediator_setup_by_preset(v) }, // 設定での変更を反映\n  },\n\n  methods: {\n    mediator_setup_by_preset(value) {\n      if (value) {\n        const preset_info = PresetInfo.fetch(value)\n\n        this.mediator = new Mediator()\n        this.mediator.data_source = this.data_source_by(preset_info.sfen)\n        preset_info.piece_box.forEach(([e, c]) => { // preset_info には特別に駒箱の情報もある\n          this.mediator.piece_box_add(Piece.fetch(e), c)\n        })\n        this.mediator.run()\n\n        // 駒落ちのときは△の手番から始まるので edit_mode での手番に反映する\n        this.init_location_key = this.mediator.current_location.key\n      }\n    },\n  },\n\n  computed: {\n    // テンプレートの中で PresetInfo を簡単に参照できないVueの制約のため\n    preset_info_values() {\n      return PresetInfo.values\n    },\n\n    // 初期配置指定がある場合、その sfen を返す\n    init_preset_sfen() {\n      if (this.preset_key) {\n        return PresetInfo.fetch(this.preset_key).sfen\n      }\n    },\n  },\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/preset_module.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"shogi-player\",class:_vm.class_names},[(_vm.error_message)?_c('div',[_c('ErrorNotify',[_c('p',{attrs:{\"slot\":\"header\"},slot:\"header\"},[_vm._v(\"ERROR\")]),_c('p',[_vm._v(_vm._s(_vm.error_message))])])],1):_vm._e(),(!_vm.mediator)?[_c('i',{staticClass:\"fas fa-spinner fa-pulse\"})]:_vm._e(),(_vm.current_run_mode === 'edit_mode')?_c('div',{staticClass:\"edit_mode_controller\"},[_c('div',{staticClass:\"edit_mode_controller_wrap\"},[_c('b-dropdown',{model:{value:(_vm.current_preset_key),callback:function ($$v) {_vm.current_preset_key=$$v},expression:\"current_preset_key\"}},[_c('div',{staticClass:\"button\",attrs:{\"slot\":\"trigger\"},slot:\"trigger\"},[_c('span',[_vm._v(\"初期配置\")]),_c('b-icon',{attrs:{\"icon\":\"menu-down\"}})],1),_vm._l((_vm.preset_info_values),function(record){return _c('b-dropdown-item',{key:record.key,attrs:{\"value\":record.key}},[_vm._v(_vm._s(record.name))])})],2),_vm._v(\" \"),_c('button',{staticClass:\"button yumincho\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.all_flip($event)}}},[_vm._v(\"先後反転\")]),_vm._v(\" \"),_c('button',{staticClass:\"button yumincho\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.init_location_toggle($event)}}},[_vm._v(\"手番\"+_vm._s(_vm.init_location.name))])],1)]):_vm._e(),(_vm.mediator)?[_c('div',{staticClass:\"turn_edit_container\"},[(_vm.current_run_mode === 'view_mode' || _vm.current_run_mode === 'play_mode')?_c('div',{staticClass:\"turn_area\"},[(!_vm.turn_edit)?[_c('span',{staticClass:\"turn_edit_text\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.turn_edit_run($event)}}},[(_vm.current_run_mode === 'view_mode')?[_vm._v(_vm._s(_vm.mediator.current_turn_label(this.final_label)))]:_vm._e(),(_vm.current_run_mode === 'play_mode')?[_vm._v(_vm._s(_vm.real_turn)+\"手目\")]:_vm._e()],2)]:_vm._e(),(_vm.turn_edit)?[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.turn_edit_value),expression:\"turn_edit_value\",modifiers:{\"number\":true}}],ref:\"turn_edit_input\",staticClass:\"turn_edit_input\",attrs:{\"type\":\"number\"},domProps:{\"value\":(_vm.turn_edit_value)},on:{\"blur\":[function($event){_vm.turn_edit = false},function($event){return _vm.$forceUpdate()}],\"input\":function($event){if($event.target.composing){ return; }_vm.turn_edit_value=_vm._n($event.target.value)}}})]:_vm._e()],2):_vm._e(),_c('span',{staticClass:\"is-pulled-right modal_trigger_dots\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();_vm.setting_modal_p = true}}},[_c('b-icon',{attrs:{\"icon\":\"dots-vertical\",\"size\":\"is-small\"}})],1),_c('b-modal',{attrs:{\"active\":_vm.setting_modal_p,\"has-modal-card\":\"has-modal-card\"},on:{\"update:active\":function($event){_vm.setting_modal_p=$event}}},[_c('SettingModal',{attrs:{\"run_mode\":_vm.current_run_mode,\"kifu_source\":_vm.kifu_source,\"play_mode_current_sfen\":_vm.play_mode_current_sfen,\"sp_data\":_vm.$data},on:{\"update:run_mode\":function($event){_vm.current_run_mode=$event},\"update:kifu_body\":_vm.update_kifu_source}})],1)],1),_c('div',{ref:\"board_container_ref\",staticClass:\"board_container font_size_base\"},[_c('div',{staticClass:\"flippable\",class:{flip: _vm.current_flip}},[_c('PieceStand',{staticClass:\"flex_item\",attrs:{\"location_key\":'white',\"hold_pieces\":_vm.mediator.realized_hold_pieces_of('white')}}),_c('div',{staticClass:\"flex_item board_wrap\"},[(_vm.overlay_navi)?[_c('div',{staticClass:\"overlay_navi previous\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.navi_relative_move(-1, $event)}}}),_c('div',{staticClass:\"overlay_navi next\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.navi_relative_move(+1, $event)}}}),_c('div',{staticClass:\"overlay_navi flip_trigger_cell\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.board_flip_run($event)}}})]:_vm._e(),_c('div',{staticClass:\"board_outer\"},[_c('table',{staticClass:\"board_inner\"},_vm._l((_vm.mediator.dimension),function(y){return _c('tr',_vm._l((_vm.mediator.dimension),function(x){return _c('td',[_c('div',{staticClass:\"piece_back\",class:_vm.board_piece_back_class([x - 1, y - 1]),on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.board_click([x - 1, y - 1], $event)},\"contextmenu\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.board_click_right([x - 1, y - 1], $event)}}},[_c('div',{staticClass:\"piece_fore\",class:_vm.mediator.board_piece_fore_class([x - 1, y - 1])},[_vm._v(_vm._s(_vm.mediator.cell_view([x - 1, y - 1])))])])])}),0)}),0)])],2),_c('div',{staticClass:\"flex_item\"},[(_vm.current_run_mode === 'edit_mode')?_c('ul',{staticClass:\"piece_box\",class:_vm.piece_box_class,on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.piece_box_other_click($event)},\"contextmenu\":function($event){$event.preventDefault();return _vm.hold_cancel($event)}}},_vm._l((_vm.mediator.piece_box_realize()),function(ref){\nvar piece = ref[0];\nvar count = ref[1];\nreturn _c('li',{class:{holding_p: _vm.piece_box_have_p(piece)},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.piece_box_piece_click(piece, $event)}}},[_c('div',{staticClass:\"piece_back\",class:_vm.piece_box_piece_back_class(piece)},[_c('div',{staticClass:\"piece_fore\",class:_vm.piece_box_piece_inner_class(piece),domProps:{\"textContent\":_vm._s(piece.name)}})]),(count >= 1)?_c('div',{staticClass:\"piece_count\",class:(\"piece_count\" + count)},[_vm._v(_vm._s(count))]):_vm._e()])}),0):_vm._e(),(_vm.current_run_mode !== 'edit_mode')?_c('div'):_vm._e(),_c('PieceStand',{attrs:{\"location_key\":'black',\"hold_pieces\":_vm.mediator.realized_hold_pieces_of('black')}})],1)],1)]),(_vm.current_run_mode === 'view_mode' || _vm.current_run_mode === 'play_mode')?_c('div',[(_vm.controller_show)?_c('div',{staticClass:\"controller_group buttons has-addons is-centered is-paddingless\"},[_c('button',{ref:\"first\",staticClass:\"button first\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.move_to_first($event)}}},[_c('b-icon',{attrs:{\"icon\":\"menu-left\"}})],1),_c('button',{ref:\"previous\",staticClass:\"button previous\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.relative_move(-1, $event)}}},[_c('b-icon',{attrs:{\"icon\":\"chevron-left\",\"size\":\"is-small\"}})],1),_c('button',{ref:\"next\",staticClass:\"button next\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.relative_move(+1, $event)}}},[_c('b-icon',{attrs:{\"icon\":\"chevron-right\",\"size\":\"is-small\"}})],1),_c('button',{ref:\"last\",staticClass:\"button last\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.move_to_last($event)}}},[_c('b-icon',{attrs:{\"icon\":\"menu-right\"}})],1),_c('button',{staticClass:\"button flip\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.board_flip_run($event)}}},[_c('b-icon',{attrs:{\"icon\":\"rotate-3d\",\"size\":\"is-small\"}})],1)]):_vm._e(),(_vm.slider_show)?_c('div',[_c('input',{ref:\"turn_slider\",staticClass:\"turn_slider\",attrs:{\"type\":\"range\",\"min\":_vm.turn_min,\"max\":_vm.turn_max},domProps:{\"value\":_vm.real_turn},on:{\"input\":function($event){return _vm.current_turn_set($event.target.value)}}})]):_vm._e()]):_vm._e(),(_vm.sfen_show)?_c('div',{staticClass:\"sfen_area is-size-7 has-text-grey\"},[_vm._t(\"sfen_part\",[_vm._v(_vm._s(_vm.mediator.to_sfen))],{\"sfen\":_vm.mediator.to_sfen,\"mediator\":_vm.mediator})],2):_vm._e(),_c('CommentArea',{attrs:{\"comments_pack\":_vm.mediator.data_source.comments_pack,\"current_comments\":_vm.mediator.current_comments}})]:_vm._e(),(_vm.current_debug_mode)?_c('div',{staticClass:\"debug_table\"},[_c('table',{staticClass:\"table is-bordered is-striped is-narrow is-hoverable is-fullwidth\"},[_c('tbody',[_c('tr',[_c('th',[_vm._v(\"現在のモード(current_run_mode)\")]),_c('td',[_vm._v(_vm._s(_vm.current_run_mode))])]),_c('tr',[_c('th',[_vm._v(\"update_counter\")]),_c('td',[_vm._v(_vm._s(_vm.update_counter))])]),_c('tr',[_c('th',[_vm._v(\"移動元座標(place_from)\")]),_c('td',[_vm._v(_vm._s(_vm.place_from))])]),_c('tr',[_c('th',[_vm._v(\"駒台・駒箱から移動中の駒(have_piece)\")]),_c('td',[_vm._v(_vm._s(_vm.have_piece))])]),(_vm.mediator)?[_c('tr',[_c('th',[_vm._v(\"駒箱\")]),_c('td',[_vm._v(_vm._s(_vm.mediator.piece_box_realize()))])]),_c('tr',[_c('th',[_vm._v(\"持駒\")]),_c('td',[_vm._v(_vm._s(_vm.mediator.hold_pieces))])]),_c('tr',[_c('th',[_vm._v(\"次の手番\")]),_c('td',[_vm._v(_vm._s(_vm.mediator.current_location.key))])]),_c('tr',[_c('th',[_vm._v(\"現局面のSFEN\")]),_c('td',[_vm._v(_vm._s(_vm.mediator.to_sfen))])]),_c('tr',[_c('th',[_vm._v(\"正規化手番\")]),_c('td',[_vm._v(_vm._s(_vm.real_turn))])])]:_vm._e(),_c('tr',[_c('th',[_vm._v(\"開始局面番号(start_turn)\")]),_c('td',[_vm._v(_vm._s(_vm.start_turn))])]),_c('tr',[_c('th',[_vm._v(\"初期配置(current_preset_key)\")]),_c('td',[_vm._v(_vm._s(_vm.current_preset_key))])]),_c('tr',[_c('th',[_vm._v(\"play_modeでの指し手(moves)\")]),_c('td',[_vm._v(_vm._s(_vm.moves))])]),_c('tr',[_c('th',[_vm._v(\"play_modeの開始局面(init_sfen)\")]),_c('td',[_vm._v(_vm._s(_vm.init_sfen))])]),_c('tr',[_c('th',[_vm._v(\"編集モード時の手番(init_location_key)\")]),_c('td',[_vm._v(_vm._s(_vm.init_location_key))])]),_c('tr',[_c('th',[_vm._v(\"play_modeでのSFEN(play_mode_current_sfen)\")]),_c('td',[_vm._v(_vm._s(_vm.play_mode_current_sfen))])]),_c('tr',[_c('th',[_vm._v(\"key_event_capture\")]),_c('td',[_vm._v(_vm._s(_vm.key_event_capture))])]),_c('tr',[_c('th',[_vm._v(\"interval_id\")]),_c('td',[_vm._v(_vm._s(_vm.interval_id))])])],2)])]):_vm._e()],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-2195c0e7\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/ShogiPlayer.vue\n// module id = h0BZ\n// module chunks = 1 2","import _ from 'lodash'\nimport Vue from 'vue'\nimport Soldier from \"./soldier\"\n\nexport default class Board {\n  static get dimension() {\n    return 9\n  }\n\n  static get danger_zone_size() {\n    return 3\n  }\n\n  constructor() {\n    this._surface = {}\n  }\n\n  place_on(soldier) {\n    Vue.set(this._surface, soldier.place.key, soldier)\n  }\n\n  lookup(place) {\n    return this._surface[place.key]\n  }\n\n  delete_at(place) {\n    delete this._surface[place.key]\n  }\n\n  get flip() {\n    const value = new Board()\n    _.forEach(this._surface, (soldier, place) => {\n      const new_soldier = new Soldier(Object.assign({}, soldier.attributes, {\n        location: soldier.location.flip,\n        place: soldier.place.flip,\n      }))\n      value.place_on(new_soldier)\n    })\n    return value\n  }\n}\n\nif (process.argv[1] === __filename) {\n  console.log(Board.dimension)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/board.js","import MemoryRecord from \"js-memory-record\"\n\nexport default class Location extends MemoryRecord {\n  static get define() {\n    return [\n      { key: \"black\", name: '☗', hirate_name: \"先手\", komaochi_name: \"下手\" },\n      { key: \"white\", name: '☖', hirate_name: \"後手\", komaochi_name: \"上手\" },\n    ]\n  }\n\n  static cycle_lookup(key) {\n    if (typeof key === \"number\") {\n      // -1 % 2 が -1 になってしまうのでごまかす\n      key = (Location.values.length + key) % Location.values.length\n    }\n    return Location.lookup(key)\n  }\n\n  get flip() {\n    return Location.cycle_lookup(this.code + 1)\n  }\n\n  any_name(komaochi_p) {\n    return komaochi_p ? this.komaochi_name : this.hirate_name\n  }\n}\n\nif (process.argv[1] === __filename) {\n  console.log(Location.cycle_lookup(-1))\n\n  console.log(Location.fetch(\"black\"))\n\n  Location.values.map((e) => {\n    console.log(e)\n  })\n\n  console.log(Location.fetch(\"black\").flip)\n  console.log(Location.fetch(\"white\").flip)\n  console.log(Location.fetch(\"white\").any_name(false))\n  console.log(Location.fetch(\"white\").any_name(true))\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/location.js","var normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./CommentArea.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./CommentArea.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-3a87a5fb\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./CommentArea.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/CommentArea.vue\n// module id = lujB\n// module chunks = 1 2","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"modal-card has-text-left\",staticStyle:{\"width\":\"auto\"}},[_c('header',{staticClass:\"modal-card-head\"},[_c('p',{staticClass:\"modal-card-title\"},[_vm._v(\"設定\")]),_c('button',{staticClass:\"delete\",attrs:{\"aria-label\":\"close\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.$parent.close()}}})]),_c('section',{staticClass:\"modal-card-body\"},[_c('b-field',{attrs:{\"label\":\"モード\"}},[_c('div',{staticClass:\"block\"},[_vm._l((_vm.RunModeInfo.values),function(e){return [_c('b-radio',{attrs:{\"native-value\":e.key},model:{value:(_vm.current_run_mode),callback:function ($$v) {_vm.current_run_mode=$$v},expression:\"current_run_mode\"}},[_vm._v(_vm._s(e.name))])]})],2)]),_c('b-field',{attrs:{\"label\":\"反転\"}},[_c('b-switch',{model:{value:(_vm.flip),callback:function ($$v) {_vm.flip=$$v},expression:\"flip\"}})],1),_c('b-field',{attrs:{\"label\":\"デバッグモード\"}},[_c('b-switch',{model:{value:(_vm.current_debug_mode),callback:function ($$v) {_vm.current_debug_mode=$$v},expression:\"current_debug_mode\"}})],1),_c('b-field',{attrs:{\"label\":\"テーマ\"}},[_c('div',{staticClass:\"block\"},[_vm._l((_vm.ThemeInfo.values),function(e){return [_c('b-radio',{attrs:{\"native-value\":e.key},model:{value:(_vm.$store.state.current_theme),callback:function ($$v) {_vm.$set(_vm.$store.state, \"current_theme\", $$v)},expression:\"$store.state.current_theme\"}},[_vm._v(_vm._s(e.name))])]})],2)]),(_vm.$store.state.current_theme === 'real')?[_c('b-field',{attrs:{\"label\":\"背景の種類\"}},[_c('div',{staticClass:\"block\"},[_vm._l((_vm.BgVariantInfo.values),function(e){return [_c('b-radio',{attrs:{\"native-value\":e.key,\"size\":\"is-small\"},model:{value:(_vm.$store.state.current_bg_variant),callback:function ($$v) {_vm.$set(_vm.$store.state, \"current_bg_variant\", $$v)},expression:\"$store.state.current_bg_variant\"}},[_vm._v(_vm._s(e.name))])]})],2)]),_c('b-field',{attrs:{\"label\":\"駒の種類\"}},[_c('div',{staticClass:\"block\"},[_vm._l((_vm.PieceVariantInfo.values),function(e){return [_c('b-radio',{attrs:{\"native-value\":e.key,\"size\":\"is-small\"},model:{value:(_vm.$store.state.current_piece_variant),callback:function ($$v) {_vm.$set(_vm.$store.state, \"current_piece_variant\", $$v)},expression:\"$store.state.current_piece_variant\"}},[_vm._v(_vm._s(e.name))])]})],2)])]:_vm._e(),_c('b-field',{attrs:{\"label\":\"サイズ\"}},[_c('div',{staticClass:\"block\"},[_vm._l((_vm.SizeInfo.values),function(e){return [_c('b-radio',{attrs:{\"native-value\":e.key,\"size\":\"is-small\"},model:{value:(_vm.$store.state.current_size),callback:function ($$v) {_vm.$set(_vm.$store.state, \"current_size\", $$v)},expression:\"$store.state.current_size\"}},[_vm._v(_vm._s(e.name))])]})],2)]),(_vm.sp_data.mediator)?[_c('b-field',{attrs:{\"label\":\"現局面(Readonly)\"}},[_c('b-input',{attrs:{\"value\":_vm.sp_data.mediator.to_position_sfen,\"type\":\"input\",\"size\":\"is-small\",\"readonly\":\"readonly\"}})],1)]:_vm._e(),_c('b-field',{attrs:{\"label\":\"再生モードの棋譜(編集可)\"}},[_c('b-input',{attrs:{\"type\":\"textarea\",\"size\":\"is-small\"},model:{value:(_vm.kifu_source2),callback:function ($$v) {_vm.kifu_source2=$$v},expression:\"kifu_source2\"}})],1),_c('b-field',{attrs:{\"label\":\"操作モードの棋譜(Readonly)\"}},[_c('b-input',{staticClass:\"is-small\",attrs:{\"value\":_vm.play_mode_current_sfen,\"type\":\"textarea\",\"size\":\"is-small\",\"readonly\":\"readonly\"}})],1)],2),_c('footer',{staticClass:\"modal-card-foot\"},[_c('button',{staticClass:\"button is-primary\",on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.$parent.close()}}},[_vm._v(\"閉じる\")])])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4c6243ba\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/SettingModal.vue\n// module id = ncHd\n// module chunks = 1 2","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2195c0e7\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"indentedSyntax\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./ShogiPlayer.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./ShogiPlayer.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./ShogiPlayer.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2195c0e7\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../node_modules/vue-loader/lib/selector?type=template&index=0!./ShogiPlayer.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/ShogiPlayer.vue\n// module id = oS6v\n// module chunks = 1 2","import XRegExp from \"xregexp\"\nimport assert from \"minimalistic-assert\"\n\nimport ParserBase from \"./parser_base\"\nimport Piece from \"./piece\"\nimport Place from \"./place\"\nimport Location from \"./location\"\nimport SfenParser from \"./sfen_parser\"\n\nexport default class KifParser extends ParserBase {\n  get board() {\n    const sfen_parser = new SfenParser()\n    sfen_parser.kifu_body = \"position startpos\" // TODO: sfen形式の値のテーブルを持って駒落ちに対応する\n    sfen_parser.parse()\n    return sfen_parser.board\n  }\n\n  get location_base() {\n    let key = null\n    const value = this.header[\"手合割\"] || \"平手\"\n    if (value === \"平手\") {\n      key = \"black\"\n    } else {\n      key = \"white\"\n    }\n    return Location.fetch(key)\n  }\n\n  parse() {\n    this.move_infos = []\n    this.comments_pack = {}\n    let before_point = null\n\n    this.kifu_body.split(/\\n/).forEach((line) => {\n      const md = XRegExp.exec(line, this.__kif_format_move_regexp)\n      if (md) {\n        const attrs = {}\n        attrs[\"location\"] = this.location_by_offset(Number(md[\"number\"]) - 1)\n        if (md[\"origin_place\"]) {\n          attrs[\"origin_place\"] = Place.fetch(md[\"origin_place\"])\n        }\n        assert(md[\"to\"] || md[\"same\"])\n        if (md[\"to\"]) {\n          attrs[\"place\"] = Place.fetch(md[\"to\"])\n          before_point = attrs[\"place\"]\n        } else {\n          assert(md[\"same\"])\n          assert(before_point)\n          attrs[\"place\"] = before_point\n        }\n        if (md[\"motion\"] === \"成\") {\n          attrs[\"promoted_trigger\"] = true\n        }\n        if (md[\"motion\"] === \"打\") {\n          attrs[\"drop_piece\"] = Piece.kif_lookup(md[\"piece\"])\n        }\n        this.move_infos.push(attrs)\n      } else {\n        const md = XRegExp.exec(line, XRegExp(\"^\\\\*(?<comment>.*)\"))\n        if (md) {\n          const index = this.move_infos.length\n          this.comments_pack[index] = this.comments_pack[index] || []\n          this.comments_pack[index].push(md[\"comment\"])\n        }\n      }\n    })\n  }\n\n  set move_infos(v) {\n    this._move_infos = v\n  }\n\n  get move_infos() {\n    return this._move_infos || []\n  }\n\n  set comments_pack(v) {\n    this._comments_pack = v\n  }\n\n  get comments_pack() {\n    return this._comments_pack || []\n  }\n\n  get __kif_format_move_regexp() {\n    return XRegExp(`\n        ^\\\\s*(?<number>\\\\d+)\\\\s+\n        (?<to>[１-９1-9一二三四五六七八九]{2})?\n        (?<same>同)?\\\\s*\n        (?<piece>成[銀桂香]|[王玉金銀全桂圭香杏角馬飛龍竜歩と])\n        (?<suffix>[左右直]?[寄引上]?)\n        (?<motion>不?成|打|合|生)?\n        (\\\\((?<origin_place>\\\\d{2})\\\\))? # KIFフォーマットの移動元用\n      `, 'xm')\n  }\n}\n\nif (process.argv[1] === __filename) {\n  const kif_parser = new KifParser()\n//   kif_parser.kifu_body = `\n// # ----  Kifu for Windows V6.26 棋譜ファイル  ----\n// key：value\n// 手数----指手---------消費時間--\n// *コメント0a\n// *コメント0b\n//    1 ７六歩(77)   ( 0:00/00:00:00)\n// *コメント1a\n// *コメント1b\n//    2 ３四歩(33)   ( 0:00/00:00:00)\n//    3 投了         ( 0:00/00:00:00)\n// `\n\n  kif_parser.kifu_body = `\n   1 ２六歩(27)   ( 0:16/00:00:16)\n   2 ３四歩(33)   ( 0:22/00:00:22)\n   3 ７六歩(77)   ( 0:06/00:00:22)\n   4 ８四歩(83)   ( 0:13/00:00:35)\n   5 ２五歩(26)   ( 0:09/00:00:31)\n   6 ８五歩(84)   ( 0:16/00:00:51)\n   7 ７八金(69)   ( 0:04/00:00:35)\n   8 ３二金(41)   ( 0:09/00:01:00)\n   9 ２四歩(25)   ( 0:04/00:00:39)\n  10 同 歩(23)    ( 0:10/00:01:10)\n`\n  kif_parser.parse()\n  // console.log(kif_parser.board)\n  // console.log(kif_parser.location_base)\n  // console.log(kif_parser.hold_pieces)\n  console.log(kif_parser.move_infos)\n  console.log(kif_parser.comments_pack)\n  console.log(kif_parser.init_sfen === undefined)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/kif_parser.js","import MemoryRecord from \"js-memory-record\"\n\nexport default class RunModeInfo extends MemoryRecord {\n  static get define() {\n    return [\n      /* eslint-disable */\n      { key: \"view_mode\", name: \"再生\", },\n      { key: \"play_mode\", name: \"操作\", },\n      { key: \"edit_mode\", name: \"編集\", },\n      /* eslint-enable */\n    ]\n  }\n}\n\nif (process.argv[1] === __filename) {\n  console.log(RunModeInfo.fetch(\"simple\").key)\n  console.log(RunModeInfo.fetch(\"simple\").name)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/run_mode_info.js","<template lang=\"pug\">\n.piece_stand_outer(:class=\"piece_stand_outer_class\")\n  .location_mark_wrap\n    .location_mark(v-html=\"location_name\")\n    .piece_count.piece_count1\n      //- 2桁にして幅を常に予約しておく\n      | 99\n\n  ul.piece_stand(:class=\"piece_stand_class\" @click.stop.prevent=\"$parent.piece_stand_click(location, $event)\" @click.right.stop.prevent=\"$parent.hold_cancel\")\n    li(v-for=\"[piece, count] in hold_pieces\" @click.stop=\"$parent.piece_stand_piece_click(location, piece, $event)\")\n      .piece_back(:class=\"piece_back_class(piece)\")\n        .piece_fore(:class=\"piece_fore_class(piece)\")\n          | {{piece.name}}\n      .piece_count(v-if=\"count >= 1\" :class=\"`piece_count${count}`\")\n        | {{count}}\n</template>\n\n<script>\nimport Location from \"../location\"\nimport _ from \"lodash\"\n\nexport default {\n  props: {\n    location_key: { required: true },\n    hold_pieces: { required: true },\n  },\n\n  methods: {\n    hold_piece_holding_p(piece) {\n      return this.$parent.have_piece_location === this.location && this.$parent.have_piece === piece\n    },\n\n    piece_back_class(piece) {\n      let list = []\n\n      // if (this.holding_p) {\n      //   list.push(\"hoverable_p\")\n      // }\n\n      if (this.hold_piece_holding_p(piece)) {\n        list.push(\"holding_p\")\n      } else if (this.$parent.current_run_mode === \"edit_mode\" || (!this.$parent.cpu_location_p && this.$parent.mediator.current_location === this.location)) {\n        if (!this.holding_p) {\n          list.push(\"selectable_p\")\n        }\n      }\n\n      // list = _.concat(list, piece.css_class_list)\n      // list.push(`location_${this.location.key}`)\n      // list.push(\"promoted_false\")\n\n      return list\n    },\n\n    piece_fore_class(piece) {\n      let list = []\n      list = _.concat(list, piece.css_class_list)\n      list.push(`location_${this.location.key}`)\n      list.push(\"promoted_false\")\n      return list\n    },\n  },\n\n  computed: {\n    holding_p() {\n      return this.$parent.holding_p\n    },\n\n    location() {\n      return Location.fetch(this.location_key)\n    },\n\n    piece_stand_outer_class() {\n      const list = []\n\n      list.push(`location_${this.location.key}`)\n      list.push(this.$parent.env)\n      if (this.$parent.mediator.current_location === this.location) {\n        list.push(\"turn_active\")\n      }\n      return list\n    },\n\n    location_name() {\n      // if (this.location.key === \"white\") {\n      //   return '<span style=\"color:white\">☗</span>'\n      // } else {\n      return this.location.name\n      // }\n    },\n\n    piece_stand_class() {\n      const list = []\n\n      if (this.holding_p) {\n        list.push(\"hoverable_p\")\n      }\n\n      return list\n    },\n  },\n}\n</script>\n\n\n\n// WEBPACK FOOTER //\n// src/components/PieceStand.vue","import XRegExp from \"xregexp\"\nimport Vue from \"vue\"\nimport _ from \"lodash\"\n\nimport Board from \"./board\"\nimport ParserBase from \"./parser_base\"\nimport Piece from \"./piece\"\nimport Place from \"./place\"\nimport Soldier from \"./soldier\"\nimport Location from \"./location\"\n\nexport default class SfenParser extends ParserBase {\n  parse() {\n    this.kifu_body = this.kifu_body.replace(/startpos/, \"sfen lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b - 1\")\n    const regex = XRegExp(\"sfen\\\\s+(?<sfen>\\\\S+)\\\\s+(?<b_or_w>\\\\S+)\\\\s+(?<hold_pieces>\\\\S+)\\\\s+(?<turn_counter_next>\\\\d+)(\\\\s+moves\\\\s+(?<moves>.*))?\")\n    this.attributes = XRegExp.exec(this.kifu_body, regex)\n    if (process.env.NODE_ENV === \"deveopment\") {\n      console.log(this.attributes)\n    }\n  }\n\n  get board() {\n    const board = new Board()\n    this.attributes[\"sfen\"].split(\"/\").forEach((e, y) => {\n      let x = 0\n      XRegExp.forEach(e, XRegExp(\"(?<promoted>\\\\+?)(?<piece>\\\\S)\"), (m, i) => {\n        if (/\\d+/.test(m.piece)) {\n          x += Number(m.piece)\n        } else {\n          const soldier = new Soldier({\n            place: new Place([x, y]),\n            piece: Piece.fetch(m.piece),\n            promoted: (m.promoted === \"+\"),\n            location: this.__location_by_upper_or_lower_case(m.piece),\n          })\n          board.place_on(soldier)\n          x++\n        }\n      })\n    })\n    return board\n  }\n\n  get location_base() {\n    let key = null\n    if (this.attributes[\"b_or_w\"] === \"b\") {\n      key = \"black\"\n    } else {\n      key = \"white\"\n    }\n    return Location.fetch(key)\n  }\n\n  get hold_pieces() {\n    const _hold_pieces = super.hold_pieces\n    if (this.attributes[\"hold_pieces\"] !== \"-\") {\n      XRegExp.forEach(this.attributes[\"hold_pieces\"], XRegExp(\"(?<count>\\\\d+)?(?<piece_char>\\\\S)\"), (md, i) => {\n        const piece = Piece.fetch(md.piece_char)\n        let count = Number(md.count || 1)\n        const location = this.__location_by_upper_or_lower_case(md.piece_char)\n        count += _hold_pieces[location.key][piece.key] || 0\n        Vue.set(_hold_pieces[location.key], piece.key, count)\n      })\n    }\n    return _hold_pieces\n  }\n\n  get turn_min() {\n    return Number(this.attributes[\"turn_counter_next\"]) - 1\n  }\n\n  get komaochi_p() {\n    return (this.turn_min % 2) === 0 && this.location_base.key === \"white\"\n  }\n\n  get move_infos() {\n    // this.moves.map((e, i) => { としたかったが break できないため lodash の forEach に変更。lodash のは false で break できる\n    const ary = []\n    _.forEach(this.moves, (e, i) => {\n      const attrs = {}\n      // if (true) {\n      //   attrs[\"scene_index\"] = this.turn_min + i\n      //   attrs[\"scene_offset\"] = i\n      // }\n      attrs[\"location\"] = this.location_by_offset(i)\n      const md = XRegExp.exec(e, XRegExp(\"(?<origin_x>\\\\S)(?<origin_y>\\\\S)(?<pos_x>\\\\S)(?<pos_y>\\\\S)(?<promoted>\\\\+?)?\"))\n      if (!md) {\n        return false            // break\n      }\n      attrs[\"promoted_trigger\"] = (md.promoted === \"+\")\n      if (md[\"origin_y\"] === \"*\") {\n        attrs[\"drop_piece\"] = Piece.fetch(md[\"origin_x\"])\n      } else {\n        attrs[\"origin_place\"] = Place.fetch(`${md[\"origin_x\"]}${md[\"origin_y\"]}`)\n      }\n      attrs[\"place\"] = Place.fetch(`${md[\"pos_x\"]}${md[\"pos_y\"]}`)\n      ary.push(attrs)\n    })\n    return ary\n  }\n\n  get moves() {\n    let moves = this.attributes[\"moves\"]\n    if (_.isNil(moves) || moves === \"\") {\n      return []\n    }\n    return moves.split(/\\s+/)\n  }\n\n  // 最初の局面\n  get init_sfen() {\n    const parts = []\n    parts.push(\"position\")\n    parts.push(\"sfen\")\n    parts.push(this.attributes[\"sfen\"])\n    parts.push(this.attributes[\"b_or_w\"])\n    parts.push(this.attributes[\"hold_pieces\"])\n    parts.push(this.attributes[\"turn_counter_next\"])\n    return parts.join(\" \")\n  }\n\n  __location_by_upper_or_lower_case(v) {\n    let key = null\n    if (/[A-Z]/.test(v)) {\n      key = \"black\"\n    } else {\n      key = \"white\"\n    }\n    return Location.fetch(key)\n  }\n}\n\nif (process.argv[1] === __filename) {\n  const sfen_parser = new SfenParser()\n  sfen_parser.kifu_body = \"position sfen +lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b S2s 1 moves 7i6h S*2d\"\n  sfen_parser.parse()\n  console.log(sfen_parser.board)\n  console.log(sfen_parser.location_base.key)\n  console.log(sfen_parser.hold_pieces)\n  console.log(sfen_parser.move_infos)\n  console.log(sfen_parser.moves)\n  console.log(sfen_parser.init_sfen)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/sfen_parser.js","import _ from \"lodash\"\n\nimport Place from \"../place\"\nimport Soldier from \"../soldier\"\nimport Location from \"../location\"\n\nexport default {\n  /* eslint-disable */\n  props: {\n  },\n  /* eslint-enable */\n\n  data() {\n    return {\n      // |------------------------+------------+------------+---------------------|\n      // | どこの駒を持ち上げた？ | place_from | have_piece | have_piece_location |\n      // |------------------------+------------+------------+---------------------|\n      // | 盤上                   | ○         |            | ○                  |\n      // | 駒台                   |            | ○         | ○                  |\n      // | 駒箱                   |            | ○         |                     |\n      // |------------------------+------------+------------+---------------------|\n      place_from: null,           // 盤上ら動かそうとしているときの元位置\n      have_piece: null,           // 駒台 or 駒箱から持った駒\n      have_piece_location: null,  // 駒台から持ったときだけ先後が入っている。駒箱から取り出しているときは null\n\n      // プレフィクスに_をつけるとVueに監視されない\n      me_running_p: false,        // mousemove イベント緩和用\n      me_last_event: null,        // mousemove イベント\n\n      cursor_elem_in_board_container: true,\n    }\n  },\n\n  watch: {\n    current_run_mode() {\n      this.state_reset() // モードが切り替わったときに持ち上げた駒を元に戻す(こうしないとカーソルから駒が離れない)\n    }\n  },\n\n  methods: {\n    // 盤をクリック\n    board_click(xy, e) {\n      this.log(\"board_click\")\n      this.log(`shiftKey: ${e.shiftKey}`)\n\n      if (this.if_view_mode_break) {\n        return\n      }\n\n      const place = Place.fetch(xy)\n      const soldier = this.mediator.board.lookup(place)\n\n      // -------------------------------------------------------------------------------- Validation\n\n      if (this.cpu_location_p) {\n        this.log(\"片方の手番だけを操作できるようにする human_side_key の指定があってCPU側なので無効とする\")\n        return\n      }\n\n      // 自分の手番で相手の駒を持ち上げようとしたので無効とする\n      if (this.current_run_mode === \"play_mode\" && !this.holding_p && soldier && soldier.location !== this.mediator.current_location) {\n        this.log(\"自分の手番で相手の駒を持ち上げようとしたので無効とする\")\n        return\n      }\n\n      // 持たずに何もないところをクリックしたので無効とする\n      if (!this.holding_p && !soldier) {\n        this.log(\"持たずに何もないところをクリックしたので無効とする\")\n        return\n      }\n\n      // 自分の駒の上に駒を重ねようとしたので状況キャンセル\n      if (this.current_run_mode === \"play_mode\" && this.put_on_my_piece_p(soldier)) {\n        this.log(\"自分の駒の上に駒を重ねようとしたので状況キャンセル\")\n        this.state_reset()\n        return\n      }\n\n      // 盤上の駒を持って同じ位置に戻したので状況キャンセル\n      if (_.isEqual(this.place_from, place)) {\n        this.log(\"盤上の駒を持って同じ位置に戻したので状況キャンセル\")\n        this.state_reset()\n        return\n      }\n\n      // --------------------------------------------------------------------------------\n\n      if (this.current_run_mode === \"edit_mode\") {\n        this.log(`holding_p: ${this.holding_p}`)\n        if (!this.holding_p && soldier && this.meta_p(e)) {\n          this.log(\"盤上の駒を裏返す\")\n          this.mediator.board.place_on(soldier.piece_transform)\n          this.pice_hold_and_put_for_bug(place, e) // 不具合対策\n          return\n        }\n      }\n\n      // 盤上の駒を持ちあげる\n      if (!this.holding_p) {\n        this.log(\"盤上の駒を持ちあげる\")\n        this.soldier_hold(place, e)\n        return\n      }\n\n      // 盤上から移動\n      if (this.place_from) {\n        this.log(\"盤上から移動\")\n        if (soldier) {\n          this.mediator.hold_pieces_add(this.origin_soldier1.location, soldier.piece) // 相手の駒があれば取る\n          // this.$forceUpdate()\n        }\n\n        const new_soldier = new Soldier({\n          piece: this.origin_soldier1.piece,\n          place: place,\n          promoted: this.origin_soldier1.promoted,\n          location: this.origin_soldier1.location,\n        })\n\n        if (this.current_run_mode === \"play_mode\" && (new_soldier.promotable_p || this.origin_soldier1.promotable_p)) { // 入って成る or 出て成る\n          this.mouse_stick = false // ダイアログ選択時時は動かしている駒を止める\n\n          // 元が成ってないとき\n          this.$dialog.confirm({\n            message: '成りますか？',\n            confirmText: '成る',\n            cancelText: '成らない',\n            onConfirm: () => { this.promotable_piece_moved(new_soldier, true)  },\n            onCancel:  () => { this.promotable_piece_moved(new_soldier, false) },\n          })\n        } else {\n          if (this.current_run_mode === \"play_mode\") {\n            this.moves_set(this.origin_soldier1.place.to_sfen + place.to_sfen) // 7g7f\n          }\n          this.mediator.board.place_on(new_soldier) // 置く\n          this.mediator.board.delete_at(this.place_from)\n          this.state_reset()\n          this.turn_next()\n        }\n\n        return\n      }\n\n      // 持駒を置く\n      if (this.have_piece) {\n        const soldier = this.origin_soldier2_create(place)\n        this.piece_decriment()\n        this.mediator.board.place_on(soldier) // 置く\n        this.moves_set(soldier.piece.key + \"*\" + place.to_sfen) // P*7g\n        this.state_reset()\n        this.turn_next()\n        return\n      }\n\n      throw new Error(\"must not happen\")\n    },\n\n    // 成れる状態の駒をどうするか\n    promotable_piece_moved(new_soldier, promoted) {\n      new_soldier.promoted = promoted\n\n      this.moves_set(this.origin_soldier1.place.to_sfen + new_soldier.place.to_sfen + (new_soldier.promoted ? \"+\" : \"\")) // 7g7f+\n      this.mediator.board.place_on(new_soldier) // 置く\n      this.mediator.board.delete_at(this.place_from)\n      this.state_reset()\n      this.turn_next()\n    },\n\n    board_click_right(xy, e) {\n      this.log(\"盤を右クリック\")\n\n      if (this.if_view_mode_break) {\n        return\n      }\n\n      const place = Place.fetch(xy)\n      const soldier = this.mediator.board.lookup(place)\n\n      if (this.hold_cancel(e)) {\n        return\n      }\n\n      if (this.current_run_mode === \"edit_mode\") {\n        if (!this.holding_p && soldier) {\n          this.log(\"盤上の駒を裏返す\")\n          this.mediator.board.place_on(soldier.piece_transform)\n          this.pice_hold_and_put_for_bug(place, e) // 不具合対策\n        }\n      }\n    },\n\n    // 駒台 or 駒台の駒をクリックしたときの共通処理\n    piece_stand_click_shared(location, e) {\n      if (this.have_piece_location === location && this.have_piece) {\n        this.log(\"自分の駒台から駒を持ち上げているならキャンセル\")\n        this.state_reset()\n        return true\n      }\n\n      // 相手の駒台から自分の駒台、まあは駒箱から自分の駒台へ移動\n      if (this.current_run_mode === \"edit_mode\") {\n        // if (this.have_piece_location !== location && this.have_piece) {\n        if (this.have_piece) {\n          // 相手の持駒を自分の駒台に移動\n          this.hold_pieces_move_to_my_hold_pieces(e, location)\n          return true\n        }\n      }\n\n      if (this.current_run_mode === \"play_mode\") {\n        if (this.origin_soldier1) {\n          this.log(\"play_mode では盤上の駒を駒台に置くことはできない\")\n          return true\n        }\n      }\n\n      // 盤上の駒を駒台に置く\n      if (this.origin_soldier1) {\n        this.log(\"盤上の駒を駒台に置く\")\n        this.board_soldir_to_hold_pieces(location)\n        return true\n      }\n\n      return false\n    },\n\n    // 駒台クリック\n    piece_stand_click(location, e) {\n      this.piece_stand_click_shared(location, e)\n    },\n\n    // 駒台の駒をクリック\n    piece_stand_piece_click(location, piece, e) {\n      this.log(\"駒台の駒をクリック\")\n\n      if (this.piece_stand_click_shared(location, e)) {\n        return\n      }\n\n      // クリックしたけど持駒がない\n      if (this.mediator.hold_pieces_count(location, piece) <= 0) {\n        this.log(\"クリックしたけど持駒がない\")\n        return\n      }\n\n      // 相手の持駒を持とうとしたときは無効\n      if (this.current_run_mode === \"play_mode\" && location !== this.mediator.current_location) {\n        this.log(\"相手の持駒を持とうとしたときは無効\")\n        return\n      }\n\n      if (this.cpu_location_p) {\n        this.log(\"片方の手番だけを操作できるようにする human_side_key の指定があってCPU側なので無効とする\")\n        return\n      }\n\n      this.log(\"駒台の駒を持つ\")\n      this.have_piece = piece\n      this.have_piece_location = location\n      this.virtual_piece_create(e, this.origin_soldier2)\n    },\n\n    // 駒箱の駒を持ち上げている？\n    piece_box_have_p(piece) {\n      return _.isNil(this.have_piece_location) && this.have_piece === piece\n    },\n\n    // FIXME: 駒を持っているときは「駒箱の駒」に対して一切反応しないようにしたい。そうすると駒箱だけの判定で済む\n    piece_box_other_click(e) {\n      this.log(\"piece_box_other_click:駒箱クリック\")\n\n      if (_.isNil(this.have_piece_location) && this.have_piece) {\n        this.log(\"持っているならキャンセル\")\n        this.state_reset()\n        return true\n      }\n\n      if (this.have_piece_location && this.have_piece) {\n        this.log(\"駒台から駒箱に移動\")\n        const count = this.hold_piece_source_cut(e)               // 相手の持駒を減らして減らした分だけ\n        this.mediator.piece_box_add(this.have_piece, count) // 駒箱に加算する\n        this.state_reset()\n        return true\n      }\n\n      if (this.origin_soldier1) {\n        this.log(\"盤上の駒を駒箱に移動\")\n        this.mediator.piece_box_add(this.origin_soldier1.piece)\n        this.mediator.board.delete_at(this.origin_soldier1.place)\n        this.state_reset()\n        return true\n      }\n\n      return false\n    },\n\n    // 駒箱の駒をクリック\n    piece_box_piece_click(piece, e) {\n      // 駒をクリックしたとき駒箱をクリックするのと同じ処理を実行\n      if (this.piece_box_other_click(e)) {\n        return\n      }\n\n      this.log(\"piece_box_piece_click:駒台の駒を持つ\")\n      this.have_piece = piece\n      this.have_piece_location = null\n      this.virtual_piece_create(e, this.origin_soldier2)\n    },\n\n    // FIXME: click_hook のところだけで行いたい\n    hold_cancel(e) {\n      if (this.holding_p) {\n        this.log(\"持ち上げた駒を元に戻す\")\n        this.state_reset()\n        return true\n      }\n      return false\n    },\n\n    // 盤上の駒を駒台に置く\n    board_soldir_to_hold_pieces(location) {\n      this.mediator.hold_pieces_add(location, this.origin_soldier1.piece) // 駒台にプラス\n      this.mediator.board.delete_at(this.origin_soldier1.place)\n      this.state_reset()\n    },\n\n    hold_pieces_move_to_my_hold_pieces(e, location) {\n      this.log(\"相手の持駒を自分の駒台に移動\")\n      const count = this.hold_piece_source_cut(e)                           // 相手の持駒を減らして減らした分だけ\n      this.mediator.hold_pieces_add(location, this.have_piece, count) // 自分に加算する\n      this.state_reset()\n    },\n\n    // 持ち上げている駒を元の場所から減らす\n    hold_piece_source_cut(e) {\n      let count = 1\n\n      if (this.have_piece_location) {\n        this.log(\"相手の駒箱から移動\")\n        if (this.meta_p(e)) {\n          this.log(\"シフトが押されていたので全部移動\")\n          count = this.mediator.hold_pieces_count(this.have_piece_location, this.have_piece)\n        }\n        this.mediator.hold_pieces_add(this.have_piece_location, this.have_piece, -count)\n      } else {\n        this.log(\"駒箱から移動\")\n        if (this.meta_p(e)) {\n          this.log(\"シフトが押されていたので全部移動\")\n          count = this.mediator.piece_box_count(this.have_piece)\n        }\n        this.mediator.piece_box_add(this.have_piece, -count)\n      }\n\n      return count\n    },\n\n    // 駒を1つ減らす\n    piece_decriment() {\n      if (this.have_piece_location) {\n        this.mediator.hold_pieces_add(this.have_piece_location, this.have_piece, -1)\n      } else {\n        this.mediator.piece_box_add(this.have_piece, -1)\n      }\n    },\n\n    // 自分の駒の上に重ねた？\n    put_on_my_piece_p(soldier) {\n      return this.holding_p && soldier && soldier.location === this.mediator.current_location\n    },\n\n    // 盤面の駒を持ち上げる\n    soldier_hold(place, e) {\n      this.place_from = place\n      this.virtual_piece_create(e, this.origin_soldier1)\n    },\n\n    // 駒を持ってない状態にする\n    state_reset() {\n      this.log(\"state_reset\")\n      this.place_from = null // 持ってない状態にする\n      this.have_piece = null\n      this.have_piece_location = null\n      this.virtual_piece_destroy()\n    },\n\n    // 駒を持つ → そのまま置く\n    // これは Vue がリアクティブにならない対策として入れているのでできれば外したい\n    pice_hold_and_put_for_bug(place, e) {\n      this.soldier_hold(place, e)\n      this.state_reset()\n    },\n\n    // -------------------------------------------------------------------------------- piece_box\n\n    // 駒箱の駒\n    piece_box_piece_back_class(piece) {\n      let list = []\n      if (this.piece_box_have_p(piece)) {\n        list.push(\"holding_p\")\n      } else if (this.current_run_mode === \"edit_mode\") {\n        if (!this.holding_p) {\n          list.push(\"selectable_p\")\n        }\n      }\n\n      // list = _.concat(list, piece.css_class_list)\n      // list.push(\"location_black\")\n      // list.push(\"promoted_false\")\n\n      return list\n    },\n\n    // 駒箱の駒のテクスチャ\n    piece_box_piece_inner_class(piece) {\n      let list = []\n      list = _.concat(list, piece.css_class_list)\n      list.push(\"location_black\")\n      list.push(\"promoted_false\")\n      return list\n    },\n\n    // --------------------------------------------------------------------------------\n\n    all_flip() {\n      // 盤面反転\n      this.mediator.board = this.mediator.board.flip\n\n      // 持駒反転\n      this.mediator.hold_pieces = _.reduce(Location.values, (a, e) => {\n        a[e.key] = this.mediator.hold_pieces[e.flip.key]\n        return a\n      }, {})\n    },\n\n    init_location_toggle() {\n      this.init_location_key = this.init_location.flip.key\n    },\n\n    // 駒箱や駒台から持ち上げている駒\n    origin_soldier2_create(place) {\n      return new Soldier({\n        piece: this.have_piece,\n        place: place,\n        promoted: false,\n        location: this.have_piece_location || Location.fetch(\"black\"),\n      })\n    },\n\n    mousemove_hook(e) {\n      this.me_last_event = e\n\n      // 連続で呼ばれるイベント処理を緩和する方法\n      // https://qiita.com/noplan1989/items/9333faad731f5ecaaccd\n      // ※試してみているけどあまり効果がない\n      if (true) {\n        // 呼び出されるまで何もしない\n        if (!this.me_running_p) {\n          this.me_running_p = true\n\n          // 描画する前のタイミングで呼び出してもらう\n          window.requestAnimationFrame(() => {\n            this.cursor_elem_set_pos()\n\n            this.me_running_p = false\n          })\n        }\n      } else {\n        this.cursor_elem_set_pos()\n      }\n    },\n\n    // 右クリックならキャンセル(動いてないっぽい)\n    click_hook(e) {\n      if (e.which !== 1) {\n        this.state_reset()\n      }\n    },\n\n    cursor_elem_set_pos() {\n      if (this.cursor_elem && this.me_last_event && this.mouse_stick) {\n        // TODO: これが遅いのか？ もっと速く設定できる方法があれば変更したい\n        let x = this.me_last_event.clientX\n        let y = this.me_last_event.clientY\n\n        if (this.cursor_elem_in_board_container) {\n          // const rect = this.$refs.board_container_ref.getBoundingClientRect()\n          // x -= rect.left\n          // y -= rect.top\n        }\n\n        this.cursor_elem.style.left = `${x}px`\n        this.cursor_elem.style.top  = `${y}px`\n      }\n    },\n\n    // マウス位置に表示する駒の生成\n    //\n    //   .piece_back.cursor_elem\n    //     .piece_fore.virtual_piece_flip\n    //\n    virtual_piece_create(event, soldier) {\n      this.virtual_piece_destroy()\n\n      this.cursor_elem = document.createElement(\"div\")\n      this.cursor_elem.classList.add(\"cursor_elem\")\n\n      const piece_back = document.createElement(\"div\")\n      piece_back.classList.add(\"piece_back\")\n\n      const piece_fore = document.createElement(\"div\")\n      piece_fore.classList.add(\"piece_fore\", ...soldier.to_class_list)\n\n      const text = document.createTextNode(soldier.name)\n      piece_fore.appendChild(text)\n\n      // const list = _.concat(class_list, [\"piece_back\"])\n      // piece_fore.classList.add(...list)\n\n      if (this.current_flip) {\n        // this.cursor_elem.classList.add(\"virtual_piece_flip\") // 盤面を反転している場合は駒も反転する\n        piece_back.classList.add(\"virtual_piece_flip\") // 盤面を反転している場合は駒も反転する\n      }\n\n      piece_back.appendChild(piece_fore)\n      this.cursor_elem.appendChild(piece_back)\n\n      if (this.cursor_elem_in_board_container) {\n        this.$refs.board_container_ref.appendChild(this.cursor_elem)\n      } else {\n        this.$el.appendChild(this.cursor_elem)\n      }\n\n      this.mouse_stick = true   // マウスに追随する\n\n      this.me_last_event = event\n      this.log(this.me_last_event)\n      this.cursor_elem_set_pos()\n\n      window.addEventListener(\"mousemove\", this.mousemove_hook, false)\n      window.addEventListener(\"click\", this.click_hook, false)\n    },\n\n    virtual_piece_destroy() {\n      if (this.cursor_elem) {\n        if (this.cursor_elem_in_board_container) {\n          this.$refs.board_container_ref.removeChild(this.cursor_elem)\n        } else {\n          this.$el.removeChild(this.cursor_elem)\n        }\n\n        this.cursor_elem = null\n        this.mouse_stick = false\n\n        window.removeEventListener(\"mousemove\", this.mousemove_hook)\n        window.removeEventListener(\"click\", this.click_hook)\n      }\n    },\n\n    meta_p(e) {\n      return e.shiftKey | e.ctrlKey | e.altKey | e.metaKey\n    },\n  },\n\n  computed: {\n    // 移動元の駒(盤上から)\n    origin_soldier1() {\n      if (this.place_from) {\n        return this.mediator.board.lookup(this.place_from)\n      }\n    },\n\n    // 移動元の駒(駒台 or 駒箱から)\n    origin_soldier2() {\n      if (this.have_piece) {\n        const place = Place.fetch([0, 0])\n        return this.origin_soldier2_create(place)\n      }\n    },\n\n    // 駒を持ち上げている状態？\n    holding_p() {\n      return !_.isNil(this.place_from) || !_.isNil(this.have_piece)\n    },\n\n    // 片方の手番だけを操作できるようにする human_side_key の指定があってCPUの手番？\n    cpu_location_p() {\n      if (this.current_run_mode === \"play_mode\") {\n        return !_.includes(this.human_locations, this.mediator.current_location)\n      }\n    },\n\n    if_view_mode_break() {\n      // return this.current_run_mode === \"view_mode\"\n    },\n\n    piece_box_class() {\n      const list = []\n\n      if (this.holding_p) {\n        list.push(\"hoverable_p\")\n      }\n\n      return list\n    },\n  },\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/edit_mode_module.js","var normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./SettingModal.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./SettingModal.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4c6243ba\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../node_modules/vue-loader/lib/selector?type=template&index=0!./SettingModal.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/SettingModal.vue\n// module id = zlNq\n// module chunks = 1 2"],"sourceRoot":""}