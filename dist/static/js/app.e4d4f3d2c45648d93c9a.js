webpackJsonp([1],{"+5mU":function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Point=void 0;var r=i(n("Zrlr")),o=i(n("wxAW")),u=n("iy8a"),a=function(){function e(t){(0,r.default)(this,e);var n=void 0,i=void 0;if("string"==typeof t){var o=t.split("");n=o[0],i=o[1],n=u.Board.boardSize()-Number(n),i=i.charCodeAt(0)-"a".charCodeAt(0)}else n=t[0],i=t[1];this.x=n,this.y=i}return(0,o.default)(e,[{key:"toString",value:function(){return[this.x,this.y].toString()}}]),e}();t.Point=a},"+Gxq":function(e,t,n){"use strict";var i=n("/Put"),r=n.n(i),o=function(e){n("4veK")},u=n("VU/8")(r.a,null,!1,o,null,null);t.default=u.exports},"/Put":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return e&&e.__esModule?e:{default:e}}(n("fnDg"));t.default=i.default},"1Qli":function(e,t){},"2/M4":function(e,t,n){"use strict";var i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"shogi_player"},[n("p",[e._v(e._s(e.current_turn)+"手目")]),e._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-lg-12"},[n("div",{staticClass:"board_container board_turn",class:{enable:e.board_turn}},[n("div",{staticClass:"flex_item hold_pieces white",class:e.env},[n("ul",[n("li",[e._v("☖")]),e._v(" "),e._l(e.mediator.hold_pieces.white,function(t,i){return n("li",[t>=1?[n("span",{staticClass:"piece_name"},[e._v(e._s(e._f("piece_name")(i)))]),e._v(" "),t>=2?[n("span",{staticClass:"piece_count"},[e._v(e._s(t))])]:e._e()]:e._e()],2)})],2)]),e._v(" "),n("div",{staticClass:"flex_item board"},[n("table",e._l(e.mediator.board_size,function(t){return n("tr",[e._l(e.mediator.board_size,function(i){return[n("td",{class:e.mediator.cell_class(i-1,t-1)},[e._v("\n                  "+e._s(e.mediator.cell_view(i-1,t-1))+"\n                ")])]})],2)}))]),e._v(" "),n("div",{staticClass:"flex_item hold_pieces black",class:e.env},[n("ul",[n("li",[e._v("☗")]),e._v(" "),e._l(e.mediator.hold_pieces.black,function(t,i){return n("li",[t>=1?[n("span",{staticClass:"piece_name"},[e._v(e._s(e._f("piece_name")(i)))]),e._v(" "),t>=2?[n("span",{staticClass:"piece_count"},[e._v(e._s(t))])]:e._e()]:e._e()],2)})],2)])]),e._v(" "),n("p"),n("div",{staticClass:"controller"},[n("div",{staticClass:"btn-group"},[n("button",{staticClass:"btn btn-default first",on:{click:function(t){e.current_turn=e.mediator.sfen.turn_counter_base()}}},[e._v("｜＜")]),e._v(" "),n("button",{staticClass:"btn btn-default previous",on:{click:function(t){e.current_turn-=1}}},[e._v("＜")]),e._v(" "),n("button",{staticClass:"btn btn-default next",on:{click:function(t){e.current_turn+=1}}},[e._v("＞")]),e._v(" "),n("button",{staticClass:"btn btn-default last",on:{click:function(t){e.current_turn=e.mediator.sfen.turn_counter_max()}}},[e._v("＞｜")])]),e._v(" "),n("div",{staticClass:"btn-group"},[n("button",{staticClass:"btn btn-default board_turn",on:{click:function(t){e.board_turn=!e.board_turn}}},[e._v("反転")])])]),e._v(" "),n("p"),e._v(" "),n("p",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.current_turn,expression:"current_turn",modifiers:{number:!0}}],attrs:{type:"range",min:e.mediator.sfen.turn_counter_base(),max:e.mediator.sfen.turn_counter_max()},domProps:{value:e.current_turn},on:{__r:function(t){e.current_turn=e._n(t.target.value)},blur:function(t){e.$forceUpdate()}}})])])]),e._v(" "),"production"!==e.env?[e._v("\n    "+e._s(e.mediator.hold_pieces)+"\n  ")]:e._e()],2)},staticRenderFns:[]};t.a=i},"4veK":function(e,t){},"9M+g":function(e,t){},"HUt/":function(e,t,n){"use strict";var i=n("fcFS"),r=n.n(i),o=function(e){n("n9mN")},u=n("VU/8")(r.a,null,!1,o,null,null);t.default=u.exports},JCpY:function(e,t,n){"use strict";var i=n("aPSQ"),r=n.n(i),o=function(e){n("xBwK")},u=n("VU/8")(r.a,null,!1,o,null,null);t.default=u.exports},JDVb:function(e,t,n){"use strict";var i=n("kJiG"),r=n.n(i),o=function(e){n("Y9O/")},u=n("VU/8")(r.a,null,!1,o,null,null);t.default=u.exports},JV8Q:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("Ocp9"),r=n.n(i);for(var o in i)"default"!==o&&function(e){n.d(t,e,function(){return i[e]})}(o);var u=n("2/M4"),a=function(e){n("1Qli")},c=n("VU/8")(r.a,u.a,!1,a,"data-v-ea737e6a",null);t.default=c.exports},Jmt5:function(e,t){},M4xR:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Mediator=void 0;var r=i(n("Zrlr")),o=i(n("wxAW")),u=n("rdLu"),a=n("paLa"),c=n("iy8a"),s=(n("P4Jg"),i(n("7+uW"))),l=function(){function e(){(0,r.default)(this,e),this.board_size=c.Board.boardSize(),this.sfen=null,this.current_turn=null,this.current_field=null,this.hold_pieces=null,this.move_info=null,this.env="production",this.kifu_body="position startpos moves 2g2f 3c3d 2f2e 2b3c 7g7f 3a4b 3i4h 5c5d 5i6h 5d5e 3g3f 8b5b 4h3g 4b5c 3g4f 5c4d 4i5h 5a6b 6h7h 6b7b 6g6f 7b8b 5h6g 7a7b 8h7g 9c9d 7h8h 9d9e 9i9h 8c8d 8h9i 7b8c 7i8h 6a7b 6f6e 7c7d 6g6f 8a7c 7g8f 5b5a 2h7h 8d8e 8f5i 3c4b 6i7i 2a3c 7f7e 7d7e 6f7e 4b7e 7h7e P*7d 7e7f G*7e 7f7h 5e5f 5g5f 7e6e 5f5e P*5f 5i2f 1c1d P*6b 4a5b 6b6a+ 5a6a 5e5d 6e6f 7h6h 6f7f P*7g 7f7e 6h5h 7e6f 5h6h 6f6e B*3b 8e8f 8g8f 3d3e 3b2c+ 6c6d 3f3e 6a2a 2c3d 9a9b 2f4h 2a9a 2e2d 6e7e 3d5f P*8d 4h7e 7d7e 6h6d 5b6c 6d6h B*6e 6h6e 7c6e 5f6e R*5i N*6f 7b7c B*5b 6c6d 6e6d 7c6d P*6e B*4h 6e6d 4h6f+ G*7c"}return(0,o.default)(e,[{key:"run",value:function(){var e=this;this.sfen=new a.Sfen,this.sfen.kifu_body=this.kifu_body,this.sfen.parse(),this.current_field=this.sfen.field(),this.hold_pieces=this.sfen.hold_pieces(),this.move_info=null;var t=this.sfen.move_infos();this.current_turn=this.current_turn_clamp(this.current_turn);var n=this.current_turn-this.sfen.turn_counter_base();(0,u._)(n).times(function(n){var i=t[n];if(e.move_info=i,i.stroke_piece){var r={pos:i.pos,piece:i.stroke_piece,promoted:i.promoted,location:i.location},o=e.hold_pieces[i.location][r.piece.key]-1;s.default.set(e.hold_pieces[i.location],r.piece.key,o),s.default.set(e.current_field,r.pos,r)}else{var u=e.current_field[i.pos];if(u){void 0===e.hold_pieces[i.location]&&s.default.set(e.hold_pieces,i.location,{});var a=(e.hold_pieces[i.location][u.piece.key]||0)+1;s.default.set(e.hold_pieces[i.location],u.piece.key,a)}var c=e.current_field[i.origin_pos];i.promoted_trigger&&(c.promoted=!0),s.default.set(e.current_field,i.origin_pos,null),s.default.set(e.current_field,i.pos,c)}})}},{key:"cell_view",value:function(e,t){var n=this.current_field[[e,t]],i="";return n&&(i=n.promoted?n.piece.promoted_name:n.piece.name),i}},{key:"cell_class",value:function(e,t){var n=this.current_field[[e,t]],i=[];if(n&&i.push(n.location),this.move_info){var r=this.move_info.origin_pos;r&&r.x===e&&r.y===t&&i.push("origin_pos");var o=this.move_info.pos;o.x===e&&o.y===t&&i.push("current")}return i}},{key:"current_turn_clamp",value:function(e){return this.sfen&&(e<this.sfen.turn_counter_base()&&(e=this.sfen.turn_counter_base()),this.sfen.turn_counter_max()<e&&(e=this.sfen.turn_counter_max())),e}}]),e}();t.Mediator=l},M93x:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("xJD8"),r=n.n(i);for(var o in i)"default"!==o&&function(e){n.d(t,e,function(){return i[e]})}(o);var u=n("S1Qa"),a=function(e){n("dExw")},c=n("VU/8")(r.a,u.a,!1,a,null,null);t.default=c.exports},NHnr:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var r=i(n("7+uW")),o=i(n("M93x")),u=i(n("e6fC"));n("Jmt5"),n("9M+g"),r.default.config.productionTip=!1,r.default.use(u.default),new r.default({el:"#app",template:"<App/>",components:{App:o.default}})},Ocp9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("P4Jg"),r=n("M4xR");t.default={name:"HelloPlayer",props:["kifu_body"],data:function(){return{current_turn:0,mediator:null,board_turn:!1,env:"production"}},created:function(){this.current_turn=0,this.mediator_update()},watch:{current_turn:function(){this.mediator&&(this.current_turn=this.mediator.current_turn_clamp(this.current_turn)),this.mediator_update()},kifu_body:function(){this.current_turn=0,this.mediator_update()}},methods:{keyboard_operation:function(e){"production"!==this.env&&(console.log(e.shiftKey,e.ctrlKey,e.altKey,e.metaKey),console.log("e",e),console.log("key",e.key),console.log("code",e.code));var t=null,n=null;"Space"!==e.code&&"Enter"!==e.code&&"ArrowDown"!==e.code&&"ArrowRight"!==e.code&&"j"!==e.key&&"n"!==e.key&&"f"!==e.key||(t=1),"Backspace"!==e.code&&"ArrowUp"!==e.code&&"ArrowLeft"!==e.code&&"k"!=e.key&&"p"!=e.key&&"b"!=e.key||(t=-1),"PageUp"===e.key&&(t=-10),"PageDown"===e.key&&(t=10),(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey)&&t&&(t*=10),"["!==e.key&&"Home"!==e.key&&"Escape"!=e.code||(n=this.mediator.sfen.turn_counter_base()),"]"!==e.key&&"End"!==e.key||(n=this.mediator.sfen.turn_counter_max()),null!==t&&(this.current_turn+=t),null!==n&&(this.current_turn=n),null===t&&null===n||e.preventDefault()},mediator_update:function(){this.mediator=new r.Mediator,this.mediator.kifu_body=this.kifu_body||"position startpos",this.mediator.current_turn=this.current_turn,this.mediator.run()}},filters:{piece_name:function(e){return i.Piece.fetch(e).name}}}},P4Jg:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Piece=void 0;var r=i(n("Zrlr")),o=i(n("wxAW")),u=function(){function e(t){(0,r.default)(this,e),this.attributes=t}return(0,o.default)(e,null,[{key:"lookup",value:function(e){return e=e.toUpperCase(),this.table().find(function(t){return t.key===e})}},{key:"fetch",value:function(e){var t=this.lookup(e);if(!t)throw e+" not found";return t}},{key:"table",value:function(){return[{key:"K",name:"玉",promoted_name:null},{key:"R",name:"飛",promoted_name:"龍"},{key:"B",name:"角",promoted_name:"馬"},{key:"G",name:"金",promoted_name:null},{key:"S",name:"銀",promoted_name:"全"},{key:"N",name:"桂",promoted_name:"圭"},{key:"L",name:"香",promoted_name:"杏"},{key:"P",name:"歩",promoted_name:"と"}]}}]),e}();t.Piece=u},S1Qa:function(e,t,n){"use strict";var i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"container"},[n("HelloPlayer",{attrs:{kifu_body:e.kifu_body}}),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.kifu_body,expression:"kifu_body"}],staticClass:"form-control",domProps:{value:e.kifu_body},on:{input:function(t){t.target.composing||(e.kifu_body=t.target.value)}}})],1)])},staticRenderFns:[]};t.a=i},"Y9O/":function(e,t){},aPSQ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return e&&e.__esModule?e:{default:e}}(n("rKsW"));t.default=i.default},dExw:function(e,t){},dW2o:function(e,t){},fcFS:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return e&&e.__esModule?e:{default:e}}(n("qRo1"));t.default=i.default},iy8a:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Board=void 0;var r=i(n("Zrlr")),o=i(n("wxAW")),u=function(){function e(){(0,r.default)(this,e)}return(0,o.default)(e,null,[{key:"boardSize",value:function(){return 9}}]),e}();t.Board=u},kJiG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return e&&e.__esModule?e:{default:e}}(n("9NuQ"));t.default=i.default},n9mN:function(e,t){},paLa:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Sfen=void 0;var r=i(n("Zrlr")),o=i(n("wxAW")),u=n("P4Jg"),a=(n("iy8a"),n("+5mU")),c=n("pWoe"),s=function(){function e(){(0,r.default)(this,e),this.kifu_body=null,this.attributes=null}return(0,o.default)(e,[{key:"parse",value:function(){this.kifu_body=this.kifu_body.replace(/startpos/,"sfen lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b - 1");var e=c("sfen\\s+(?<sfen>\\S+)\\s+(?<b_or_w>\\S+)\\s+(?<hold_pieces>\\S+)\\s+(?<turn_counter_next>\\d+)(\\s+moves\\s+(?<moves>.*))?");this.attributes=c.exec(this.kifu_body,e)}},{key:"field",value:function(){var e=this,t={};return this.attributes.sfen.split("/").forEach(function(n,i){var r=0;c.forEach(n,c("(?<promoted>\\+?)(?<piece>\\S)"),function(n,o){if(/\d+/.test(n.piece))r+=Number(n.piece);else{var c={pos:new a.Point([r,i]),piece:u.Piece.fetch(n.piece),promoted:"+"===n.promoted,location:e.__location_by(n.piece)};t[c.pos]=c,r+=1}})}),t}},{key:"location",value:function(){return"b"===this.attributes.b_or_w?"black":"white"}},{key:"hold_pieces",value:function(){var e=this,t={};return"-"!==this.attributes.hold_pieces&&(console.log(this.attributes.hold_pieces),c.forEach(this.attributes.hold_pieces,c("(?<count>\\d+)?(?<piece>\\S)"),function(n,i){var r=u.Piece.fetch(n.piece),o=Number(n.count||1),a=e.__location_by(n.piece);void 0===t[a]&&(t[a]={}),t[a][r.key]=(t[a][r.key]||0)+o})),t}},{key:"turn_counter_next",value:function(){return Number(this.attributes.turn_counter_next)}},{key:"turn_counter_base",value:function(){return this.turn_counter_next()-1}},{key:"turn_counter_max",value:function(){return this.turn_counter_base()+this.move_infos().length}},{key:"komaochi_p",value:function(){return this.turn_counter_next()%2==1&&"white"==this.location()}},{key:"location_of",value:function(e){return(this.turn_counter_next()+e)%2==1?"black":"white"}},{key:"move_infos",value:function(){var e=this;return void 0===this.attributes.moves?[]:this.attributes.moves.split(/\s+/).map(function(t,n){var i={};i.scene_index=e.turn_counter_base()+n,i.scene_offsert=n,i.location=e.location_of(n);var r=c.exec(t,c("(?<origin_x>\\S)(?<origin_y>\\S)(?<pos_x>\\S)(?<pos_y>\\S)(?<promoted>\\+?)?"));return i.promoted_trigger="+"===r.promoted,"*"===r.origin_y?i.stroke_piece=u.Piece.fetch(r.origin_x):i.origin_pos=new a.Point(""+r.origin_x+r.origin_y),i.pos=new a.Point(""+r.pos_x+r.pos_y),i})}},{key:"__location_by",value:function(e){return/[A-Z]/.test(e)?"black":"white"}}]),e}();if(t.Sfen=s,n.c[n.s].filename){var l=new s;l.kifu_body="position sfen +lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b S2s 1 moves 7i6h S*2d",l.parse(),console.log(l.hold_pieces())}},r15W:function(e,t,n){"use strict";var i=n("xKc6"),r=n.n(i),o=function(e){n("dW2o")},u=n("VU/8")(r.a,null,!1,o,null,null);t.default=u.exports},xBwK:function(e,t){},xJD8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return e&&e.__esModule?e:{default:e}}(n("JV8Q"));t.default={name:"app",created:function(){this.kifu_body="position startpos moves 7g7f 8c8d 2g2f 4a3b 6i7h 8d8e 8h7g 3c3d 7i6h 2b7g+ 6h7g 3a2b 3i3h 7a6b 3g3f 2b3c 4g4f 6c6d 5i6h 6b6c 2i3g 5a4b 3h4g 7c7d 4i4h 8a7c 2h2i 8b8a 6g6f 6a6b 4g5f 9c9d 9g9f 1c1d 1g1f 6c5d 6h7i 5d6c 7i8h 6c5d 2f2e 5d6c 5f6g 6c5d 5g5f 4c4d 2i5i 4b3a 5f5e 5d4c 6g5f 3a2b 5i6i 2b3a 6i2i 3a2b 4f4e 4d4e 5f4e 8e8f 8g8f P*8e 8f8e 9d9e 9f9e 7d7e 7f7e 6d6e B*7f 6b5b 7g8f 6e6f 8i7g P*4d 4e5f 3d3e 3f3e 7c8e 7g8e P*3f 3g4e 4d4e P*6d N*7b 6d6c+ 5b6c 7f4c+ 3b4c S*5b B*7f 7h7g P*8g 7g8g B*6g 5f6g 7f8g+ 8h8g 6f6g+ B*8i 6g6f 5b4c+ G*7f 8g8h 7f8f 8h7i 8f7g P*6h S*6g 8i6g 6f6g 4c3c 2b3c S*3d 3c4d B*2b S*3c 3d3c 4d5e 3c3b 5e6d N*7f 7g7f 6h6g B*4f S*5g N*5e S*5f 8a8e 5g4f S*7h 7i7h 5e6g+ 5f6g 8e8g+ 7h7i 7f6g 2b5e+ 6d7e G*6e 7e8e N*7g 8e7f 6e7e 7f7e 5e6e 7e8d 6e8g S*6h 7i8i 6h7g+ R*8a N*8c P*8e 8d7c P*7d"},data:function(){return{kifu_body:null}},components:{HelloPlayer:i.default}}},xKc6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return e&&e.__esModule?e:{default:e}}(n("E9Zr"));t.default=i.default}},["NHnr"]);
//# sourceMappingURL=app.e4d4f3d2c45648d93c9a.js.map